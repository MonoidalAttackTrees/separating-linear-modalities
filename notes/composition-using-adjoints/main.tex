\documentclass{article}

\usepackage{amssymb,amsmath}
\usepackage{amsthm}
\usepackage{cmll}
\usepackage{txfonts}
\usepackage{graphicx}
\usepackage{stmaryrd}
\usepackage{todonotes}
\usepackage{mathpartir}
\usepackage{hyperref}
\usepackage{mdframed}
\usepackage[barr]{xy}
\usepackage{comment}
\usepackage{graphicx}
\usepackage[inline]{enumitem}

%% This renames Barr's \to to \mto.  This allows us to use \to for imp
%% and \mto for a inline morphism.
\let\mto\to
\let\to\relax
\newcommand{\to}{\rightarrow}
\newcommand{\ndto}[1]{\to_{#1}}
\newcommand{\ndwedge}[1]{\wedge_{#1}}
\newcommand{\rto}{\leftharpoonup}
\newcommand{\lto}{\rightharpoonup}

% Commands that are useful for writing about type theory and programming language design.
%% \newcommand{\case}[4]{\text{case}\ #1\ \text{of}\ #2\text{.}#3\text{,}#2\text{.}#4}
\newcommand{\interp}[1]{\llbracket #1 \rrbracket}
\newcommand{\normto}[0]{\rightsquigarrow^{!}}
\newcommand{\join}[0]{\downarrow}
\newcommand{\redto}[0]{\rightsquigarrow}
\newcommand{\nat}[0]{\mathbb{N}}
\newcommand{\fun}[2]{\lambda #1.#2}
\newcommand{\CRI}[0]{\text{CR-Norm}}
\newcommand{\CRII}[0]{\text{CR-Pres}}
\newcommand{\CRIII}[0]{\text{CR-Prog}}
\newcommand{\subexp}[0]{\sqsubseteq}
%% Must include \usepackage{mathrsfs} for this to work.

\date{}

\let\b\relax
\let\d\relax
\let\t\relax
\let\r\relax
\let\c\relax
\let\j\relax
\let\wn\relax
\let\H\relax

% Cat commands.
\newcommand{\powerset}[1]{\mathcal{P}(#1)}
\newcommand{\cat}[1]{\mathcal{#1}}
\newcommand{\func}[1]{\mathsf{#1}}
\newcommand{\iso}[0]{\mathsf{iso}}
\newcommand{\H}[0]{\func{H}}
\newcommand{\J}[0]{\func{J}}
\newcommand{\catop}[1]{\cat{#1}^{\mathsf{op}}}
\newcommand{\Hom}[3]{\mathsf{Hom}_{\cat{#1}}(#2,#3)}
\newcommand{\limp}[0]{\multimap}
\newcommand{\colimp}[0]{\multimapdotinv}
\newcommand{\dial}[1]{\mathsf{Dial_{#1}}(\mathsf{Sets^{op}})}
\newcommand{\dialSets}[1]{\mathsf{Dial_{#1}}(\mathsf{Sets})}
\newcommand{\dcSets}[1]{\mathsf{DC_{#1}}(\mathsf{Sets})}
\newcommand{\sets}[0]{\mathsf{Sets}}
\newcommand{\obj}[1]{\mathsf{Obj}(#1)}
\newcommand{\mor}[1]{\mathsf{Mor(#1)}}
\newcommand{\id}[0]{\mathsf{id}}
\newcommand{\lett}[0]{\mathsf{let}\,}
\newcommand{\inn}[0]{\,\mathsf{in}\,}
\newcommand{\cur}[1]{\mathsf{cur}(#1)}
\newcommand{\curi}[1]{\mathsf{cur}^{-1}(#1)}

\newcommand{\w}[1]{\mathsf{weak}_{#1}}
\newcommand{\c}[1]{\mathsf{contra}_{#1}}
\newcommand{\cL}[1]{\mathsf{contraL}_{#1}}
\newcommand{\cR}[1]{\mathsf{contraR}_{#1}}
\newcommand{\e}[1]{\mathsf{ex}_{#1}}

\newcommand{\m}[1]{\mathsf{m}_{#1}}
\newcommand{\n}[1]{\mathsf{n}_{#1}}
\newcommand{\b}[1]{\mathsf{b}_{#1}}
\newcommand{\d}[1]{\mathsf{d}_{#1}}
\newcommand{\h}[1]{\mathsf{h}_{#1}}
\newcommand{\p}[1]{\mathsf{p}_{#1}}
\newcommand{\q}[1]{\mathsf{q}_{#1}}
\newcommand{\t}[0]{\mathsf{t}}
\newcommand{\r}[1]{\mathsf{r}_{#1}}
\newcommand{\s}[1]{\mathsf{s}_{#1}}
\newcommand{\j}[1]{\mathsf{j}_{#1}}
\newcommand{\jinv}[1]{\mathsf{j}^{-1}_{#1}}
\newcommand{\wn}[0]{\mathop{?}}
\newcommand{\codiag}[1]{\bigtriangledown_{#1}}

\newenvironment{changemargin}[2]{%
  \begin{list}{}{%
    \setlength{\topsep}{0pt}%
    \setlength{\leftmargin}{#1}%
    \setlength{\rightmargin}{#2}%
    \setlength{\listparindent}{\parindent}%
    \setlength{\itemindent}{\parindent}%
    \setlength{\parsep}{\parskip}%
  }%
  \item[]}{\end{list}}

\newenvironment{diagram}{
  \begin{center}
    \begin{math}
      \bfig
}{
      \efig
    \end{math}
  \end{center}
}

\title{Composition of Structural Rules using Adjoints}
\author{Harley Eades III}

\begin{document}

\maketitle 

\section{The Algebras of Composed Comonads}
\label{sec:the_algebras_of_composed_comonads}
Suppose $(k,\varepsilon,\delta)$ is a comonad on a category $\cat{L}$.
Then it is well known that it can be decomposed into a the following
adjunction:
\begin{center}
  \begin{math}
    \bfig
    \Loop(900,0)\cat{L}(ur,ul)_k
    \morphism(0,0)|a|/{@{>}@/^1.5em/}/<900,0>[\cat{L}^k`\cat{L};U]
    \morphism(0,0)|b|/{@{<-}@/_1.5em/}/<900,0>[\cat{L}^k`\cat{L};F]
    \place(450,0)[\perp]
    \efig
  \end{math}
\end{center}
where $U : \cat{L}^k \mto \cat{L}$ is the forgetful functor, $F :
\cat{L} \mto \cat{L}^k$ is the free functor, and $k = UF : \cat{L}
\mto \cat{L}$.

Now suppose we have the following adjunctions:
\begin{center}
  \begin{math}
    \begin{array}{lll}
      \bfig
      \morphism(0,0)|a|/{@{>}@/^1.5em/}/<900,0>[\cat{L}_1`\cat{L}_2;F]
      \morphism(0,0)|b|/{@{<-}@/_1.5em/}/<900,0>[\cat{L}_1`\cat{L}_2;G]
      \place(450,0)[\perp]
      \efig
      & \quad &
      \bfig
      \morphism(0,0)|a|/{@{>}@/^1.5em/}/<900,0>[\cat{L}_2`\cat{L}_1;H]
      \morphism(0,0)|b|/{@{<-}@/_1.5em/}/<900,0>[\cat{L}_2`\cat{L}_1;J]
      \place(450,0)[\perp]
      \efig
    \end{array}
  \end{math}
\end{center}
Then they can be composed into the adjunction:
\begin{center}
  \begin{math}
      \bfig
      \morphism(0,0)|a|/{@{>}@/^1.5em/}/<900,0>[\cat{L}_1`\cat{L}_2;F]
      \morphism(0,0)|b|/{@{<-}@/_1.5em/}/<900,0>[\cat{L}_1`\cat{L}_2;G]
      \place(450,0)[\perp]

      \morphism(900,0)|a|/{@{>}@/^1.5em/}/<900,0>[\cat{L}_2`\cat{L}_1;H]
      \morphism(900,0)|b|/{@{<-}@/_1.5em/}/<900,0>[\cat{L}_2`\cat{L}_1;J]
      \place(1350,0)[\perp]
      \efig
  \end{math}
\end{center}
Keep in mind that this gives rise to a comonad $HFGJ : \cat{L}_1 \mto
\cat{L}_1$.

We are going to use these two facts to compose comonads using
adjunctions.  Suppose we have the comonads
$(k_1,\varepsilon^1,\delta^1)$ and $(k_2,\varepsilon^2,\delta^2)$ both
on a category $\cat{L}$ with a distributive law $\mathsf{dist} :
k_2k_1 \mto k_1k_2$. Thus, making $k_2k_1 : \cat{L} \mto \cat{L}$ a
comonad.  Then we can decompose $k_1$ into a an adjunction:
\begin{center}
  \begin{math}
    \bfig
    \Loop(900,0)\cat{L}(ur,ul)_{k_1}
    \Loop(900,0)\cat{L}(dl,dr)_{k_2}
    \morphism(0,0)|a|/{@{>}@/^1.5em/}/<900,0>[\cat{L}^{k_1}`\cat{L};U_1]
    \morphism(0,0)|b|/{@{<-}@/_1.5em/}/<900,0>[\cat{L}^{k_1}`\cat{L};F_1]
    \place(450,0)[\perp]
    \efig
  \end{math}
\end{center}
Here we know that $k_1 = U_1F_1 : \cat{L} \mto \cat{L}$, but we also
know something about $k_2$.  We can extend it to a comonad on
$\cat{L}^{k_1}$.

First, we define the functor $\widetilde{k}_2 : \cat{L}^{k_1} \mto
\cat{L}^{k_1}$ to send objects $(A,h_A)$ to $(k_2A,h'_A)$, where $h'_A
:= k_2A \mto^{k_2h_A} k_2k_1 A \mto^{\mathsf{dist}_A} k_1k_2 A$, and
to send morphisms $f : (A,h_A) \mto (B,h_B)$ to the morphism $k_2f :
(k_2A,h'_A) \mto (k_2B,h'_B)$.  We must show that $k_2f : k_2A \mto
k_2B$ is a coalgebra morphism, but the following diagram commutes:
\[
\bfig
\square|amma|<900,500>[
  k_2A`
  k_2B`
  k_2k_1A`
  k_2k_1B;
  k_2f`
  k_2h_A`
  k_2h_B`
  k_2k_1f]
\square(0,-500)|amma|<900,500>[
  k_2k_1A`
  k_2k_1B`
  k_1k_2A`
  k_1k_2B;
  k_2k_1f`
  \mathsf{dist}_A`
  \mathsf{dist}_B`
  k_1k_2f]
\efig
\]
The top diagram commutes because $f$ is a coalgebra morphism and the
bottom diagram commutes by naturality of $\mathsf{dist}$.  Since the
morphism part of $\widetilde{k}_2$ is defined using the functor $k_2$
we know $\widetilde{k}_2$ will respect composition and identities.

We now must show that $\widetilde{k}_2$ is a comonad.  The natural
transformation $\widetilde{\varepsilon^2} : \widetilde{k}_2 \mto
\mathsf{Id}$ has components $\widetilde{\varepsilon^2}_{(A,h_A)} =
\varepsilon^2_A : \widetilde{k}_2 (A,h_A) \mto (A,h_A)$. We must show
that $\varepsilon^2_A$ is a coalgebra morphism between
$\widetilde{k}_2 (A,h_A) = (k_2A,k_2h_A;\mathsf{dist}_A)$ and
$(A,h_A)$, but this follows from the following diagram:
\[
\bfig
\square|amma|/->`->`->`->/<900,500>[
  k_2A`
  A`
  k_2k_1A`
  k_1A;
  \varepsilon^2_A`
  k_2h_A`
  h_A`
  \varepsilon^2_{k_1A}]
\square(0,-500)|amma|/->`->`=`->/<900,500>[
  k_2k_1A`
  k_1A`
  k_1k_2A`
  k_1A;
  \varepsilon^2_{k_1A}`
  \mathsf{dist}_A``
  k_1\varepsilon^2_A]
\efig
\]
The top diagram commutes by naturality of $\varepsilon^2$ and the
bottom diagram commutes by the conditions of the distributive law.
Naturality for $\widetilde{\varepsilon^2}$ easily follows from the
fact that it is defined to be $\varepsilon_2$.

The natural transformation $\widetilde{\delta^2} : \widetilde{k_2} \mto \widetilde{k_2}\widetilde{k_2}$ has components
\[ \widetilde{\delta^2}_{(A,h_A)} = \delta^2_A : \widetilde{k_2}(A,h_A) \mto \widetilde{k_2}\widetilde{k_2}(A,h_A).\]
Just as above we must show that $\delta^2_A : k_2A \mto k^2_2 A$ is a coalgebra morphism between
$\widetilde{k_2}(A,h_A) = (k_2A,k_2h_A;\mathsf{dist}_A)$ and $\widetilde{k_2}\widetilde{k_2}(A,h_A) = (k^2_2A,k^2h_A;k_2\mathsf{dist}_A;\mathsf{dist}_{k_2A})$, but this follows from the following diagram:
\[
\bfig
\square|amma|<900,500>[
  k_2A`
  k^2_2A`
  k_2k_1A`
  k^2_2k_1A;
  \delta^2_A`
  k_2h_A`
  k^2_2h_A`
  \delta^2_{k_1A}]
\qtriangle(0,-500)|amm|/->``->/<900,500>[
  k_2k_1A`
  k^2_2k_1A`
  k_2k_1k_2A;
  \delta^2_{k_1A}``
  k_2\mathsf{dist}_A]
\dtriangle(0,-1000)|mma|/`->`->/<900,500>[
  k_2k_1k_2A`
  k_1k_2A`
  k_1k^2_2A;`
  \mathsf{dist}_{k_2A}`
  k_1\delta^2_A]

\morphism(0,0)|m|<0,-1000>[
  k_2k_1A`
  k_1k_2A;
  \mathsf{dist}_A]
\efig
\]
The top diagram commutes by naturality of $\delta^2$ and the bottom
diagram commutes by the conditions of the distributive law.

It is now easy to see that $\widetilde{\varepsilon^2}$ and
$\widetilde{\delta^2}$ make $\widetilde{k_2}$ a comonad on
$\cat{L}^{k_1}$, because the conditions of a comonad will be inherited
from the fact that $\varepsilon^2$ and $\delta^2$ define a comonad on
$\cat{L}$.

At this point we have arrived at the following situation:
\begin{center}
  \begin{math}
    \bfig
    \Loop(900,0)\cat{L}(ur,ul)_{k_1}
    \Loop(900,0)\cat{L}(dl,dr)_{k_2}
    \Loop(0,0)\cat{L}^{k_1}(dl,dr)_{\widetilde{k_2}}
    \morphism(0,0)|a|/{@{>}@/^1.5em/}/<900,0>[\cat{L}^{k_1}`\cat{L};U_1]
    \morphism(0,0)|b|/{@{<-}@/_1.5em/}/<900,0>[\cat{L}^{k_1}`\cat{L};F_1]
    \place(450,0)[\perp]
    \efig
  \end{math}
\end{center}
Since we have a comonad $\widetilde{k_2} : \cat{L}^{k_1} \mto
\cat{L}^{k_1}$ we can form the following adjunction:
\begin{center}
  \begin{math}
    \bfig
    \Loop(900,0)\cat{L}^{k_1}(dl,dr)_{\widetilde{k_2}}
    \morphism(0,0)|a|/{@{>}@/^1.5em/}/<900,0>[(\cat{L}^{k_1})^{k_2}`\cat{L}^{k_1};U_2]
    \morphism(0,0)|b|/{@{<-}@/_1.5em/}/<900,0>[(\cat{L}^{k_1})^{k_2}`\cat{L}^{k_1};F_2]
    \place(450,0)[\perp]
    \efig
  \end{math}
\end{center}
The functor $F_2(A,h_A) = (\widetilde{k_2}(A,h_A),
\widetilde{\delta^2}_{(A,h_A)})$ is the free functor, and $U_2(A,h_A) = A$ is
the forgetful functor.  Thus, we can think of $(\cat{L}^{k_1})^{k_2}$
as the world with all the structure of $\cat{L}$ extended with all of
the structure $k_1$ brings and all the structure $k_2$ brings.  That
is, $(\cat{L}^{k_1})^{k_2}$ is the algebras of $k_2k_1 : \cat{L} \mto
\cat{L}$.

We can see that the previous two adjunctions compose:
\begin{center}
  \begin{math}
    \bfig
    \Loop(900,0)\cat{L}^{k_1}(dl,dr)_{\widetilde{k_2}}
    \morphism(0,0)|a|/{@{>}@/^1.5em/}/<900,0>[(\cat{L}^{k_1})^{k_2}`\cat{L}^{k_1};U_2]
    \morphism(0,0)|b|/{@{<-}@/_1.5em/}/<900,0>[(\cat{L}^{k_1})^{k_2}`\cat{L}^{k_1};F_2]
    \place(450,0)[\perp]
    
    \Loop(1800,0)\cat{L}(ur,ul)_{k_1}
    \Loop(1800,0)\cat{L}(dl,dr)_{k_2}
    \Loop(900,0)\cat{L}^{k_1}(dl,dr)_{\widetilde{k_2}}
    \morphism(900,0)|a|/{@{>}@/^1.5em/}/<900,0>[\cat{L}^{k_1}`\cat{L};U_1]
    \morphism(900,0)|b|/{@{<-}@/_1.5em/}/<900,0>[\cat{L}^{k_1}`\cat{L};F_1]
    \place(1350,0)[\perp]    
    \efig
  \end{math}
\end{center}
Thus, we have a comonad $U_1U_2F_2F_1 : \cat{L} \mto \cat{L}$.
Chasing an object through this comonad yields the following:
\[
\begin{array}{lll}
  U_1U_2F_2F_1A
  & = & U_1U_2F_2(k_1A,\delta^1_A)\\
  & = & U_1U_2(\widetilde{k_2}((k_1A,\delta^1_A)), \widetilde{\delta^2}_{(k_1A,\delta^1_A)})\\
  & = & U_1U_2((k_2k_1A,k_2\delta^1_A;\mathsf{dist}_{k_1 A}), \widetilde{\delta^2}_{(k_1A,\delta^1_A)})\\
  & = & U_1(k_2k_1A,k_2\delta^1_A;\mathsf{dist}_{k_1 A})\\
  & = & k_2k_1A\\  
\end{array}
\]
Therefore, the above adjunction gives back the composition $k_2k_1 :
\cat{L} \mto \cat{L}$.

Notice that this result only works because we have a distributive law!
Otherwise we may not be able to define $\widetilde{k_2}$.  However,
this result reveals a means that will allow us to abandon distributive
laws in favor of adjunctions in the spirit of Benton's LNL models.
% section the_algebras_of_composed_comonads (end)


\section{Combining Structural Rules}
\label{sec:combining_structural_rules}
The above result tells us something important about combining
comonads, that we should be using adjunctions, because they compose.

In this section we show how to model the Lambek Calculus without
association or exchange with three comonads, one that adds back in
association, one that adds back in exchange, and one the composes the
two which will allow both to be used.
% section combining_structural_rules (end)


\nocite{*} \bibliographystyle{plainurl}
\bibliography{ref}

\end{document}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 

