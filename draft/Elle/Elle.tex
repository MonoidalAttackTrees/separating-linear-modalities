\documentclass[11pt]{article}
\usepackage{amsmath,amssymb}
\usepackage{supertabular}
\usepackage{cmll}
\usepackage{txfonts}
\usepackage{color}
\usepackage{tikz}
\usepackage{mathpartir}

\newcommand\encircle[1]{%
  \tikz[baseline=(X.base)] 
    \node (X) [draw, shape=circle, inner sep=-1.5pt] {\strut #1};}

\newcommand{\circop}[1]{\mathop{\encircle{#1}}}


\input{Elle-ott}

\begin{document}

\noindent
Deriving exchange in Elle comonadicly:

\begin{center}
  \tiny
  \begin{math}
    $$\mprset{flushleft}
    \inferrule* [right={\tiny impR}] {
      $$\mprset{flushleft}
    \inferrule* [right={\tiny tenL}] {
      $$\mprset{flushleft}
    \inferrule* [right={\tiny Fl}] {
      $$\mprset{flushleft}
      \inferrule* [right={\tiny Fl}] {
        $$\mprset{flushleft}
        \inferrule* [right={\tiny beta}] {
          $$\mprset{flushleft}
          \inferrule* [right={\tiny tenR}] {
            $$\mprset{flushleft}
            \inferrule* [right={\tiny Fr}] {
              $$\mprset{flushleft}
              \inferrule* [right={\tiny ax}] {
                \,
              }{[[y0 : Gf B |- y0 : Gf B]]}
            }{[[y0 : Gf B; . |- F y0 : F Gf B]]}
            \\
            $$\mprset{flushleft}
            \inferrule* [right={\tiny Fr}] {
              $$\mprset{flushleft}
              \inferrule* [right={\tiny ax}] {
                \,
              }{[[x0 : Gf A |- x0 : Gf A]]}
            }{[[x0 : Gf A; . |- F x0 : F Gf A]]}
          }{[[y0 : Gf B, x0 : Gf A ; . |- h(F y0) (x) F x0 : h(F Gf B) (x) F Gf A]]}
        }{[[x1 : Gf A, y1 : Gf B ; . |- ex y1 , x1 with y0 , x0 in (h(F y0) (x) F x0) : h(F Gf B) (x) F Gf A]]}
      }{[[x1 : Gf A ; y2 : F Gf B |- let y2 : F Gf B be F y1 in (ex y1 , x1 with y0 , x0 in (h(F y0) (x) F x0)) : h(F Gf B) (x) F Gf A]]}
    }{[[. ; x2 : F Gf A, y2 : F Gf B |- let x2 : F Gf A be F x1 in (let y2 : F Gf B be F y1 in (ex y1 , x1 with y0 , x0 in (h(F y0) (x) F x0))) : h(F Gf B) (x) F Gf A]]}
    }{[[. ; z : h(F Gf A) (x) F Gf B |- let z : h(F Gf A) (x) F Gf B be x2 (x) y2 in (let x2 : F Gf A be F x1 in (let y2 : F Gf B be F y1 in (ex y1 , x1 with y0 , x0 in (h(F y0) (x) F x0)))) : (h(F Gf B) (x) F Gf A)]]}
    }{[[. ; . |- \l z : h(F Gf A) (x) F Gf B . let z : h(F Gf A) (x) F Gf B be x2 (x) y2 in (let x2 : F Gf A be F x1 in (let y2 : F Gf B be F y1 in (ex y1 , x1 with y0 , x0 in (h(F y0) (x) F x0)))) : (h(F Gf A) (x) F Gf B) -> (h(F Gf B) (x) F Gf A)]]}
  \end{math}
\end{center}



Deriving right contraction in Elle comonadicly:
\begin{center}
  \tiny
  \begin{math}
    $$\mprset{flushleft}
    \inferrule* [right={\tiny impR}] {
      $$\mprset{flushleft}
      \inferrule* [right={\tiny tenL}] {
        $$\mprset{flushleft}
        \inferrule* [right={\tiny Fl}] {
          $$\mprset{flushleft}
          \inferrule* [right={\tiny Fl}] {
            $$\mprset{flushleft}
            \inferrule* [right={\tiny contrR}] {
              $$\mprset{flushleft}
              \inferrule* [right={\tiny tenR}] {
                $$\mprset{flushleft}
                \inferrule* [right={\tiny Fr}] {
                  $$\mprset{flushleft}
                  \inferrule* [right={\tiny ax}] {
                    \,
                  }{[[x1 : Gf A |- x1 : Gf A]]}
                }{[[x1 : Gf A; . |- F x1 : F Gf A]]}
                \\
                \inferrule* [right={\tiny tenR}] {
                  $$\mprset{flushleft}
                  \inferrule* [right={\tiny Fr}] {
                    $$\mprset{flushleft}
                    \inferrule* [right={\tiny ax}] {
                      \,
                    }{[[y0 : Gf B |- y0 : Gf B]]}
                  }{[[y0 : Gf B; . |- F y0 : F Gf B]]}
                  \\
                  $$\mprset{flushleft}
                  \inferrule* [right={\tiny Fr}] {
                    $$\mprset{flushleft}
                    \inferrule* [right={\tiny ax}] {
                      \,
                    }{[[x0 : Gf A |- x0 : Gf A]]}
                  }{[[x0 : Gf A; . |- F x0 : F Gf A]]}
                }{[[y0 : Gf B, x0 : Gf A ; . |- h(F y0) (x) F x0 : h(F Gf B) (x) F Gf A]]}
              }{[[x1 : Gf A, y0 : Gf B, x0 : Gf A ; . |- h(F x1) (x) (h(F y0) (x) F x0) : h(F Gf A) (x) (h(F Gf B) (x) F Gf A)]]}
            }{[[y0 : Gf B, x2 : Gf A ; . |- contrR x2 as x1, x0 in (h(F x1) (x) (h(F y0) (x) F x0)) : h(F Gf A) (x) (h(F Gf B) (x) F Gf A)]]}
          }{[[y0 : Gf B ; x3 : F Gf A |- let x3 : F Gf A be F x2 in (contrR x2 as x1, x0 in (h(F x1) (x) (h(F y0) (x) F x0))) : h(F Gf A) (x) (h(F Gf B) (x) F Gf A)]]}
        }{[[. ; y1 : F Gf B, x3 : F Gf A |- let y1 : F Gf B be F y0 in (let x3 : F Gf A be F x2 in (contrR x2 as x1, x0 in (h(F x1) (x) (h(F y0) (x) F x0)))) : h(F Gf A) (x) (h(F Gf B) (x) F Gf A)]]}
      }{[[. ; z : h(F Gf B) (x) F Gf A |- let z : h(F Gf B) (x) F Gf A be y1 (x) x3 in (let y1 : F Gf B be F y0 in (let x3 : F Gf A be F x2 in (contrR x2 as x1, x0 in (h(F x1) (x) (h(F y0) (x) F x0))))) : h(F Gf A) (x) (h(F Gf B) (x) F Gf A)]]}
    }{[[. ; . |- \l z : h(F Gf B) (x) F Gf A . let z : h(F Gf B) (x) F Gf A be y1 (x) x3 in (let y1 : F Gf B be F y0 in (let x3 : F Gf A be F x2 in (contrR x2 as x1, x0 in (h(F x1) (x) (h(F y0) (x) F x0))))) : (h(F Gf B) (x) F Gf A) -> (h(F Gf A) (x) (h(F Gf B) (x) F Gf A))]]}
  \end{math}
\end{center}



Deriving left contraction in Elle comonadicly:
\begin{center}
  \tiny
  \begin{math}
    $$\mprset{flushleft}
    \inferrule* [right={\tiny impR}] {
      $$\mprset{flushleft}
      \inferrule* [right={\tiny tenL}] {
        $$\mprset{flushleft}
        \inferrule* [right={\tiny Fl}] {
          $$\mprset{flushleft}
          \inferrule* [right={\tiny Fl}] {
            $$\mprset{flushleft}
            \inferrule* [right={\tiny contrR}] {
              $$\mprset{flushleft}
              \inferrule* [right={\tiny tenR}] {
                $$\mprset{flushleft}
                \inferrule* [right={\tiny tenR}] {
                  $$\mprset{flushleft}
                  \inferrule* [right={\tiny Fr}] {
                    $$\mprset{flushleft}
                    \inferrule* [right={\tiny ax}] {
                      \,
                    }{[[x0 : Gf A |- x0 : Gf A]]}
                  }{[[x0 : Gf A; . |- F x0 : F Gf A]]}
                  \\
                  $$\mprset{flushleft}
                  \inferrule* [right={\tiny Fr}] {
                    $$\mprset{flushleft}
                    \inferrule* [right={\tiny ax}] {
                      \,
                    }{[[y0 : Gf B |- y0 : Gf B]]}
                  }{[[y0 : Gf B; . |- F y0 : F Gf B]]}
                }{[[x0 : Gf A, y0 : Gf B ; . |- h(F x0) (x) F y0 : h(F Gf A) (x) F Gf B]]}
                \\
                \inferrule* [right={\tiny Fr}] {
                  $$\mprset{flushleft}
                  \inferrule* [right={\tiny ax}] {
                    \,
                  }{[[x1 : Gf A |- x1 : Gf A]]}
                }{[[x1 : Gf A; . |- F x1 : F Gf A]]}
              }{[[x0 : Gf A, y0 : Gf B, x1 : Gf A ; . |- (h(F x0) (x) F y0) (x) F x1 : (h(F Gf A) (x) F Gf B) (x) F Gf A]]}
            }{[[x2 : Gf A, y0 : Gf B ; . |- contrL x2 as x0, x1 in ((h(F x0) (x) F y0) (x) F x1) : (h(F Gf A) (x) F Gf B) (x) F Gf A]]}
          }{[[x2 : Gf A ; y1 : F Gf B |- let y1 : F Gf B be F y0 in (contrL x2 as x0, x1 in ((h(F x0) (x) F y0) (x) F x1)) : (h(F Gf A) (x) F Gf B) (x) F Gf A]]}
        }{[[. ; x3 : F Gf A, y1 : F Gf B |- let x3 : F Gf A be F x2 in (let y1 : F Gf B be F y0 in (contrL x2 as x0, x1 in ((h(F x0) (x) F y0) (x) F x1))) : (h(F Gf A) (x) F Gf B) (x) F Gf A]]}
      }{[[. ; z : h(F Gf A) (x) F Gf B |- let z : h(F Gf A) (x) F Gf B be x3 (x) y1 in (let x3 : F Gf A be F x2 in (let y1 : F Gf B be F y0 in (contrL x2 as x0, x1 in ((h(F x0) (x) F y0) (x) F x1)))) : (h(F Gf A) (x) F Gf B) (x) F Gf A]]}
    }{[[. ; . |- \l z : h(F Gf A) (x) F Gf B . let z : h(F Gf A) (x) F Gf B be x3 (x) y1 in (let x3 : F Gf A be F x3 in (let y1 : F Gf B be F y0 in (contrL x2 as x0, x1 in (h(F x0) (x) (h(F y0) (x) F x1))))) : (h(F Gf A) (x) F Gf B) -> ((h(F Gf A) (x) F Gf B) (x) F Gf A)]]}
  \end{math}
\end{center}



Deriving weakening in Elle comonadicly:
\begin{center}
  \tiny
  \begin{math}
    $$\mprset{flushleft}
    \inferrule* [right={\tiny impR}] {
      $$\mprset{flushleft}
      \inferrule* [right={\tiny Fl}] {
        $$\mprset{flushleft}
        \inferrule* [right={\tiny weak}] {
          $$\mprset{flushleft}
          \inferrule* [right={\tiny unitR}] {
            \,
          }{[[. |- triv : Unit]]}
        }{[[x0 : Gf A ; . |- weak x0 in triv : Unit]]}
      }{[[x1 : F Gf A ; . |- let x1 : F Gf A be F x0 in weak x0 in triv : Unit]]}
    }{[[. ; . |- \l x1 : F Gf A . let x1 : F Gf A be F x0 in weak x0 in triv : (F Gf A) -> (Unit)]]}
  \end{math}
\end{center}

\appendix

\section{Full Ott Spec}
\label{sec:full_ott_spec}
\footnotesize
\ottall
% section full_ott_spec (end)

\end{document}
