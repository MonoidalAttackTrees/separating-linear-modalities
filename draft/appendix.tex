\subsection{Symmetric Monoidal Categories}
\label{subsec:symmetric_monoidal_categories}

\begin{definition}
  \label{def:monoidal-category}
  A \textbf{monoidal category} is a category, $\cat{M}$,
  with the following data:
  \begin{itemize}
  \item An object $\top$ of $\cat{M}$,
  \item A bi-functor $\otimes : \cat{M} \times \cat{M} \mto \cat{M}$,
  \item The following natural isomorphisms:
    \[
    \begin{array}{lll}
      \lambda_A : \top \otimes A \mto A\\
      \rho_A : A \otimes \top \mto A\\      
      \alpha_{A,B,C} : (A \otimes B) \otimes C \mto A \otimes (B \otimes C)\\
    \end{array}
    \]
  \item Subject to the following coherence diagrams:
    \begin{mathpar}
      \bfig
      \vSquares|ammmmma|/->`->```->``<-/[
        ((A \otimes B) \otimes C) \otimes D`
        (A \otimes (B \otimes C)) \otimes D`
        (A \otimes B) \otimes (C \otimes D)``
        A \otimes (B \otimes (C \otimes D))`
        A \otimes ((B \otimes C) \otimes D);
        \alpha_{A,B,C} \otimes \id_D`
        \alpha_{A \otimes B,C,D}```
        \alpha_{A,B,C \otimes D}``
        \id_A \otimes \alpha_{B,C,D}]      
      
      \morphism(1185,1000)|m|<0,-1000>[
        (A \otimes (B \otimes C)) \otimes D`
        A \otimes ((B \otimes C) \otimes D);
        \alpha_{A,B \otimes C,D}]
      \efig
    \end{mathpar}
    \begin{mathpar}
      \bfig
      \Vtriangle[
        (A \otimes \top) \otimes B`
        A \otimes (\top \otimes B)`
        A \otimes B;
        \alpha_{A,\top,B}`
        \rho_{A}\otimes id_B`
        id_A\otimes\lambda_{B}]
      \efig
    \end{mathpar}
  \end{itemize}
\end{definition}

% Definition: symmetric monoidal category
\begin{definition}
  \label{def:sym-monoidal-category}
  A \textbf{symmetric monoidal category (SMC)} is a category, $\cat{M}$,
  with the following data:
  \begin{itemize}
  \item An object $\top$ of $\cat{M}$,
  \item A bi-functor $\otimes : \cat{M} \times \cat{M} \mto \cat{M}$,
  \item The following natural isomorphisms:
    \[
    \begin{array}{lll}
      \lambda_A : \top \otimes A \mto A\\
      \rho_A : A \otimes \top \mto A\\      
      \alpha_{A,B,C} : (A \otimes B) \otimes C \mto A \otimes (B \otimes C)\\
    \end{array}
    \]
  \item A symmetry natural isomorphism:
    \[
    \beta_{A,B} : A \otimes B \mto B \otimes A
    \]
  \item Subject to the following coherence diagrams:
    \begin{mathpar}
      \bfig
      \vSquares|ammmmma|/->`->```->``<-/[
        ((A \otimes B) \otimes C) \otimes D`
        (A \otimes (B \otimes C)) \otimes D`
        (A \otimes B) \otimes (C \otimes D)``
        A \otimes (B \otimes (C \otimes D))`
        A \otimes ((B \otimes C) \otimes D);
        \alpha_{A,B,C} \otimes \id_D`
        \alpha_{A \otimes B,C,D}```
        \alpha_{A,B,C \otimes D}``
        \id_A \otimes \alpha_{B,C,D}]      
      
      \morphism(1185,1000)|m|<0,-1000>[
        (A \otimes (B \otimes C)) \otimes D`
        A \otimes ((B \otimes C) \otimes D);
        \alpha_{A,B \otimes C,D}]
      \efig
      \and
      \bfig
      \hSquares|aammmaa|/->`->`->``->`->`->/[
        (A \otimes B) \otimes C`
        A \otimes (B \otimes C)`
        (B \otimes C) \otimes A`
        (B \otimes A) \otimes C`
        B \otimes (A \otimes C)`
        B \otimes (C \otimes A);
        \alpha_{A,B,C}`
        \beta_{A,B \otimes C}`
        \beta_{A,B} \otimes \id_C``
        \alpha_{B,C,A}`
        \alpha_{B,A,C}`
        \id_B \otimes \beta_{A,C}]
      \efig      
    \end{mathpar}
    \begin{mathpar}
      \bfig
      \Vtriangle[
        (A \otimes \top) \otimes B`
        A \otimes (\top \otimes B)`
        A \otimes B;
        \alpha_{A,\top,B}`
        \rho_{A}\otimes id_B`
        id_A\otimes\lambda_{B}]
      \efig
      \and
      \bfig
      \btriangle[
        A \otimes B`
        B \otimes A`
        A \otimes B;
        \beta_{A,B}`
        \id_{A \otimes B}`
        \beta_{B,A}]
      \efig
      \and
      \bfig
      \Vtriangle[
        \top \otimes A`
        A \otimes \top`
        A;
        \beta_{\top,A}`
        \lambda_A`
        \rho_A]
      \efig
    \end{mathpar}    
  \end{itemize}
\end{definition}

% Definition: monoidal biclosed category
\begin{definition}
  \label{def:monoidal-biclosed-category}
  A \textbf{monoidal biclosed category} is a monoidal category
  $(\cat{M},\top,\otimes)$, such that, for any object $B$ of $\cat{M}$,
  each of the functors $-\otimes B:\cat{M}\mto\cat{M}$ and
  $B\otimes -:\cat{M}\mto\cat{M}$ has a specified right adjoint. Hence,
  for any object $A$ and $C$ of $\cat{M}$, there are two objects
  $C\leftharpoonup B$ and $B\rightharpoonup C$ of $\cat{M}$ and two
  natural bijections:
  \begin{align*}
  \Hom{\cat{M}}{A\otimes B}{C} &\cong
    \Hom{\cat{M}}{A}{C\leftharpoonup B} \\
  \Hom{\cat{M}}{B \otimes A}{C} &\cong
    \Hom{\cat{M}}{A}{B \rightharpoonup C}
  \end{align*}
\end{definition}

% Definition: symmetric monoidal closed category
\begin{definition}
  \label{def:SMCC}
  A \textbf{symmetric monoidal closed category (SMCC)} is a symmetric
  monoidal category, $(\cat{M},\top,\otimes)$, such that, for any object
  $B$ of $\cat{M}$, the functor $- \otimes B : \cat{M} \mto \cat{M}$
  has a specified right adjoint.  Hence, for any objects $A$ and $C$
  of $\cat{M}$ there is an object $B \limp C$ of $\cat{M}$ and a
  natural bijection:
  \[
  \Hom{\cat{M}}{A \otimes B}{C} \cong \Hom{\cat{M}}{A}{B \limp C}
  \]
  We call the functor $\limp : \cat{M} \times \cat{M} \mto \cat{M}$
  the internal hom of $\cat{M}$.
\end{definition}

\begin{definition}
  \label{def:MCFUN}
  Suppose we are given two monoidal categories
  $(\cat{M}_1,\top_1,\otimes_1,\alpha_1,\lambda_1,\rho_1,\beta_1)$ and
  $(\cat{M}_2,\top_2,\otimes_2,\alpha_2,\lambda_2,\rho_2,\beta_2)$.  Then a
  \textbf{monoidal functor} is a functor $F : \cat{M}_1 \mto
  \cat{M}_2$, a map $m_{\top_1} : \top_2 \mto F\top_1$ and a natural transformation
  $m_{A,B} : FA \otimes_2 FB \mto F(A \otimes_1 B)$ subject to the
  following coherence conditions:
  \begin{mathpar}
    \bfig
    \vSquares|ammmmma|/->`->`->``->`->`->/[
      (FA \otimes_2 FB) \otimes_2 FC`
      FA \otimes_2 (FB \otimes_2 FC)`
      F(A \otimes_1 B) \otimes_2 FC`
      FA \otimes_2 F(B \otimes_1 C)`
      F((A \otimes_1 B) \otimes_1 C)`
      F(A \otimes_1 (B \otimes_1 C));
      {\alpha_2}_{FA,FB,FC}`
      m_{A,B} \otimes \id_{FC}`
      \id_{FA} \otimes m_{B,C}``
      m_{A \otimes_1 B,C}`
      m_{A,B \otimes_1 C}`
      F{\alpha_1}_{A,B,C}]
    \efig
    \end{mathpar}
  \begin{mathpar}
    \bfig
    \square|amma|/->`->`<-`->/<1000,500>[
      \top_2 \otimes_2 FA`
      FA`
      F\top_1 \otimes_2 FA`
      F(\top_1 \otimes_1 A);
      {\lambda_2}_{FA}`
      m_{\top_1} \otimes \id_{FA}`
      F{\lambda_1}_{A}`
      m_{\top_1,A}]
    \efig
    \and
    \bfig
    \square|amma|/->`->`<-`->/<1000,500>[
      FA \otimes_2 \top_2`
      FA`
      FA \otimes_2 F\top_1`
      F(A \otimes_1 \top_1);
      {\rho_2}_{FA}`
      \id_{FA} \otimes m_{\top_1}`
      F{\rho_1}_{A}`
      m_{A,\top_1}]
    \efig
    \end{mathpar}
  Need to notice that the composition of monoidal functors is also monoidal,
  subject to the above coherence conditions.

\end{definition}

\begin{definition}
  \label{def:SMCFUN}
  Suppose we are given two symmetric monoidal closed categories\\
  $(\cat{M}_1,\top_1,\otimes_1,\alpha_1,\lambda_1,\rho_1,\beta_1)$ and
  $(\cat{M}_2,\top_2,\otimes_2,\alpha_2,\lambda_2,\rho_2,\beta_2)$.  Then a
  \textbf{symmetric monoidal functor} is a functor $F : \cat{M}_1 \mto
  \cat{M}_2$, a map $m_{\top_1} : \top_2 \mto F\top_1$ and a natural
  transformation $m_{A,B} : FA \otimes_2 FB \mto F(A \otimes_1 B)$ subject
  to the following coherence conditions:
  \begin{mathpar}
    \bfig
    \vSquares|ammmmma|/->`->`->``->`->`->/[
      (FA \otimes_2 FB) \otimes_2 FC`
      FA \otimes_2 (FB \otimes_2 FC)`
      F(A \otimes_1 B) \otimes_2 FC`
      FA \otimes_2 F(B \otimes_1 C)`
      F((A \otimes_1 B) \otimes_1 C)`
      F(A \otimes_1 (B \otimes_1 C));
      {\alpha_2}_{FA,FB,FC}`
      m_{A,B} \otimes \id_{FC}`
      \id_{FA} \otimes m_{B,C}``
      m_{A \otimes_1 B,C}`
      m_{A,B \otimes_1 C}`
      F{\alpha_1}_{A,B,C}]
    \efig
    \end{mathpar}
%    \and
\begin{mathpar}
    \bfig
    \square/->`->`<-`->/<1000,500>[
      \top_2 \otimes_2 FA`
      FA`
      F\top_1 \otimes_2 FA`
      F(\top_1 \otimes_1 A);
      {\lambda_2}_{FA}`
      m_{\top_1} \otimes \id_{FA}`
      F{\lambda_1}_{A}`
      m_{\top_1,A}]
    \efig
    \and
    \bfig
    \square/->`->`<-`->/<1000,500>[
      FA \otimes_2 \top_2`
      FA`
      FA \otimes_2 F\top_1`
      F(A \otimes_1 \top_1);
      {\rho_2}_{FA}`
      \id_{FA} \otimes m_{\top_1}`
      F{\rho_1}_{A}`
      m_{A,\top_1}]
    \efig
     \end{mathpar}
     
      \begin{mathpar}
    \bfig
    \square/->`->`->`->/<1000,500>[
      FA \otimes_2 FB`
      FB \otimes_2 FA`
      F(A \otimes_1 B)`
      F(B \otimes_1 A);
      {\beta_2}_{FA,FB}`
      m_{A,B}`
      m_{B,A}`
      F{\beta_1}_{A,B}]
    \efig
  \end{mathpar}
\end{definition}

\begin{definition}
  \label{def:MCNAT}
  Suppose $(\cat{M}_1,\top_1,\otimes_1)$ and $(\cat{M}_2,\top_2,\otimes_2)$
  are monoidal categories, and $(F,m)$ and $(G,n)$ are monoidal functors
  between $\cat{M}_1$ and $\cat{M}_2$.  Then a \textbf{
    monoidal natural transformation} is a natural transformation,
  $f : F \mto G$, subject to the following coherence diagrams:
  \begin{mathpar}
    \bfig
    \square<1000,500>[
      FA \otimes_2 FB`
      F(A \otimes_1 B)`
      GA \otimes_2 GB`
      G(A \otimes_1 B);
      m_{A,B}`
      f_A \otimes_2 f_B`
      f_{A \otimes_1 B}`
      n_{A,B}]
    \efig
    \and
    \bfig
    \Vtriangle/->`<-`<-/[
      F\top_1`
      G\top_1`
      \top_2;
      f_{\top_1}`
      m_{\top_1}`
      n_{\top_1}]
    \efig
  \end{mathpar}  
\end{definition}

\begin{definition}
  \label{def:SMCNAT}
  Suppose $(\cat{M}_1,\top_1,\otimes_1)$ and $(\cat{M}_2,\top_2,\otimes_2)$
  are SMCs, and $(F,m)$ and $(G,n)$ are symmetric monoidal functors
  between $\cat{M}_1$ and $\cat{M}_2$.  Then a \textbf{symmetric
    monoidal natural transformation} is a natural transformation,
  $f : F \mto G$, subject to the following coherence diagrams:
  \begin{mathpar}
    \bfig
    \square<1000,500>[
      FA \otimes_2 FB`
      F(A \otimes_1 B)`
      GA \otimes_2 GB`
      G(A \otimes_1 B);
      m_{A,B}`
      f_A \otimes_2 f_B`
      f_{A \otimes_1 B}`
      n_{A,B}]
    \efig
    \and
    \bfig
    \Vtriangle/->`<-`<-/[
      F\top_1`
      G\top_1`
      \top_2;
      f_{\top_1}`
      m_{\top_1}`
      n_{\top_1}]
    \efig
  \end{mathpar}  
\end{definition}

\begin{definition}
  \label{def:MCADJ}
  Suppose $(\cat{M}_1,\top_1,\otimes_1)$ and $(\cat{M}_2,\top_2,\otimes_2)$
  are monoidal categories, and $(F,m)$ is a monoidal functor between
  $\cat{M}_1$ and $\cat{M}_2$ and $(G,n)$ is a monoidal
  functor between $\cat{M}_2$ and $\cat{M}_1$.  Then a
  \textbf{monoidal adjunction} is an ordinary adjunction
  $\cat{M}_1 : F \dashv G : \cat{M}_2$ such that the unit,
  $\eta_A : A \to GFA$, and the counit, $\varepsilon_A : FGA \to A$, are
  monoidal natural transformations.  Thus, the following
  diagrams must commute:
  \begin{mathpar}
    \bfig
    \square/->`->`->`<-/<1000,500>[
      FGA \otimes_2 FGB`
      F(GA \otimes_1 GB)`
      A \otimes_2 B`
      FGA \otimes_2 FGB;
      m_{GA,GB}`
      \varepsilon_A \otimes_1 \varepsilon_B`
      Fn_{A,B}`
      \varepsilon_{A \otimes_1 B}]
    \efig
    \and
    \bfig
    %% \Vtriangle|amm|/->`<-`=/[
    %%   FG\top_1`
    %%   \top_1`
    %%   \top_1;
    %%   \varepsilon_{\top_1}`
    %%   \q{\top_1}`]
    \square/->`<-`->`=/<1000,500>[
      F\top_1`
      FG\top_2`
      \top_2`
      \top_2;
      Fn_{\top_2}`
      m_{\top_1}`
      \varepsilon_{\top_1}`]    
    \efig
    \and
    \bfig
    %% \dtriangle|mmb|<1000,500>[
    %%   A \otimes_2 B`
    %%   GFA \otimes_2 GFB`
    %%   GF(A \otimes_2 B);
    %%   \eta_A \otimes_2 \eta_B`
    %%   \eta_{A \otimes_2 B}`
    %%   \p{A,B}]
    \square/<-`->`->`->/<1000,500>[
      GFA \otimes_1 GFB`
      A \otimes_1 B`
      G(FA \otimes_2 FB)`
      GF(A \otimes_1 B);
      \eta_A \otimes_1 \eta_B`
      n_{FA,FB}`
      \eta_{A \otimes_1 B}`
      m_{A,B}]
    \efig
    \and
    \bfig
    %% \Vtriangle|amm|/->`=`<-/[
    %%   \top_1`
    %%   GF\top_1`
    %%   \top_1;
    %%   \eta_{\top_1}``
    %%   p_{\top_1}]
    \square/->`<-`<-`=/<1000,500>[
      G\top_2`
      GF\top_1`
      \top_1`
      \top_1;
      Gm_{\top_1}`
      n_{\top_2}`
      \eta_{\top_1}`]      
    \efig
  \end{mathpar} 
\end{definition}

\begin{definition}
  \label{def:SMCADJ}
  Suppose $(\cat{M}_1,\top_1,\otimes_1)$ and $(\cat{M}_2,\top_2,\otimes_2)$
  are SMCs, and $(F,m)$ is a symmetric monoidal functor between
  $\cat{M}_1$ and $\cat{M}_2$ and $(G,n)$ is a symmetric monoidal
  functor between $\cat{M}_2$ and $\cat{M}_1$.  Then a
  \textbf{symmetric monoidal adjunction} is an ordinary adjunction
  $\cat{M}_1 : F \dashv G : \cat{M}_2$ such that the unit,
  $\eta_A : A \to GFA$, and the counit, $\varepsilon_A : FGA \to A$, are
  symmetric monoidal natural transformations.  Thus, the following
  diagrams must commute:
  \begin{mathpar}
    \bfig
    \square/->`->`->`<-/<1000,500>[
      FGA \otimes_2 FGB`
      F(GA \otimes_1 GB)`
      A \otimes_2 B`
      FGA \otimes_2 FGB;
      m_{GA,GB}`
      \varepsilon_A \otimes_1 \varepsilon_B`
      Fn_{A,B}`
      \varepsilon_{A \otimes_1 B}]
    \efig
    \and
    \bfig
    %% \Vtriangle|amm|/->`<-`=/[
    %%   FG\top_1`
    %%   \top_1`
    %%   \top_1;
    %%   \varepsilon_{\top_1}`
    %%   \q{\top_1}`]
    \square/->`<-`->`=/<1000,500>[
      F\top_1`
      FG\top_2`
      \top_2`
      \top_2;
      Fn_{\top_2}`
      m_{\top_1}`
      \varepsilon_{\top_1}`]    
    \efig
    \and
    \bfig
    %% \dtriangle|mmb|<1000,500>[
    %%   A \otimes_2 B`
    %%   GFA \otimes_2 GFB`
    %%   GF(A \otimes_2 B);
    %%   \eta_A \otimes_2 \eta_B`
    %%   \eta_{A \otimes_2 B}`
    %%   \p{A,B}]
    \square/<-`->`->`->/<1000,500>[
      GFA \otimes_1 GFB`
      A \otimes_1 B`
      G(FA \otimes_2 FB)`
      GF(A \otimes_1 B);
      \eta_A \otimes_1 \eta_B`
      n_{FA,FB}`
      \eta_{A \otimes_1 B}`
      m_{A,B}]
    \efig
    \and
    \bfig
    %% \Vtriangle|amm|/->`=`<-/[
    %%   \top_1`
    %%   GF\top_1`
    %%   \top_1;
    %%   \eta_{\top_1}``
    %%   p_{\top_1}]
    \square/->`<-`<-`=/<1000,500>[
      G\top_2`
      GF\top_1`
      \top_1`
      \top_1;
      Gm_{\top_1}`
      n_{\top_2}`
      \eta_{\top_1}`]      
    \efig
  \end{mathpar} 
\end{definition}

\begin{definition}
  \label{def:monoidal-comonad}
  A \textbf{monoidal comonad} on a monoidal
  category $\cat{C}$ is a triple $(T,\varepsilon, \delta)$, where
  $(T,\m{})$ is a monoidal endofunctor on $\cat{C}$,
  $\varepsilon_A : TA \mto A$ and $\delta_A : TA \to T^2 A$ are
  monoidal natural transformations, which make the following
  diagrams commute:
  \begin{mathpar}
    \bfig
    \square<600,600>[
      TA`
      T^2A`
      T^2A`
      T^3A;
      \delta_A`
      \delta_A`
      T\delta_A`
      \delta_{TA}]
    \efig
    \and
    \bfig
    \Atrianglepair/=`->`=`<-`->/<600,600>[
      TA`
      TA`
      T^2 A`
      TA;`
      \delta_A``
      \varepsilon_{TA}`
      T\varepsilon_A]
    \efig
  \end{mathpar}
  The assumption that $\varepsilon$ and $\delta$ are 
  monoidal natural transformations amount to the following diagrams
  commuting:
  \begin{mathpar}
    \bfig
    \qtriangle/->`->`->/<1000,600>[
      TA \otimes TB`
      T(A \otimes B)`
      A \otimes B;
      \m{A,B}`
      \varepsilon_A \otimes \varepsilon_B`
    \varepsilon_{A \otimes B}]
    \efig
    \and
    \bfig
    \Vtriangle/<-`->`=/<600,600>[
      T\top`
      \top`
      \top;
      \m{\top}`
      \varepsilon_\top`]
    \efig    
  \end{mathpar}
  \begin{mathpar}
    \bfig
    \square|alab|/`->``->/<1050,600>[
      TA \otimes TB``
      T^2A \otimes T^2B`
      T(TA \otimes TB);`
      \delta_A \otimes \delta_B``
      \m{TA,TB}]
    \square(1050,0)|mmrb|/``->`->/<1050,600>[`
      T(A \otimes B)`
      T(TA \otimes TB)`
      T^2(A \otimes B);``
      \delta_{A \otimes B}`
      T\m{A,B}]
    \morphism(0,600)<2100,0>[TA \otimes TB`T(A \otimes B);\m{A,B}]
    \efig
    \and
    \bfig
    \square<600,600>[
      \top`
      T\top`
      T\top`
      T^2\top;
      \m{\top}`
      \m{\top}`
      \delta_\top`
      T\m{\top}]
    \efig
  \end{mathpar}
\end{definition}


\begin{definition}
  \label{def:symm-monoidal-comonad}
  A \textbf{symmetric monoidal comonad} on a symmetric monoidal
  category $\cat{C}$ is a triple $(T,\varepsilon, \delta)$, where
  $(T,\m{})$ is a symmetric monoidal endofunctor on $\cat{C}$,
  $\varepsilon_A : TA \mto A$ and $\delta_A : TA \to T^2 A$ are
  symmetric monoidal natural transformations, which make the following
  diagrams commute:
  \begin{mathpar}
    \bfig
    \square<600,600>[
      TA`
      T^2A`
      T^2A`
      T^3A;
      \delta_A`
      \delta_A`
      T\delta_A`
      \delta_{TA}]
    \efig
    \and
    \bfig
    \Atrianglepair/=`->`=`<-`->/<600,600>[
      TA`
      TA`
      T^2 A`
      TA;`
      \delta_A``
      \varepsilon_{TA}`
      T\varepsilon_A]
    \efig
  \end{mathpar}
  The assumption that $\varepsilon$ and $\delta$ are symmetric
  monoidal natural transformations amount to the following diagrams
  commuting:
  \begin{mathpar}
    \bfig
    \qtriangle/->`->`->/<1000,600>[
      TA \otimes TB`
      T(A \otimes B)`
      A \otimes B;
      \m{A,B}`
      \varepsilon_A \otimes \varepsilon_B`
    \varepsilon_{A \otimes B}]
    \efig
    \and
    \bfig
    \Vtriangle/<-`->`=/<600,600>[
      T\top`
      \top`
      \top;
      \m{\top}`
      \varepsilon_\top`]
    \efig    
  \end{mathpar}
  \begin{mathpar}
    \bfig
    \square|alab|/`->``->/<1050,600>[
      TA \otimes TB``
      T^2A \otimes T^2B`
      T(TA \otimes TB);`
      \delta_A \otimes \delta_B``
      \m{TA,TB}]
    \square(1050,0)|mmrb|/``->`->/<1050,600>[`
      T(A \otimes B)`
      T(TA \otimes TB)`
      T^2(A \otimes B);``
      \delta_{A \otimes B}`
      T\m{A,B}]
    \morphism(0,600)<2100,0>[TA \otimes TB`T(A \otimes B);\m{A,B}]
    \efig
    \and
    \bfig
    \square<600,600>[
      \top`
      T\top`
      T\top`
      T^2\top;
      \m{\top}`
      \m{\top}`
      \delta_\top`
      T\m{\top}]
    \efig
  \end{mathpar}
\end{definition}

\section{Proofs}
\label{sec:proofs}

\subsection{Lambek Categories with Exchange}
\label{subsec:lambek_categories_with_exchange}
\subsubsection{Proof of The Eilenberg-Moore Category is Monoidal (Lemma~\ref{lemma:the_eilenberg_moore_category_is_monoidal})}
\label{subsec:proof_of_the_eilenberg-moore_category_is_monoidal_lemma:the_eilenberg_moore_category_is_monoidal}

We must first define the unitors, and then the associator.  Then we
show that they respect the symmetry monoidal coherence diagrams.
Throughout this proof we will make use of the coalgebra $(A,h_A)$,
$(B,h_B)$, and $(C,h_C)$.

The tensor product of $(A, h_A)$ and $(B, h_b)$ is $(A \otimes
B,q_{A,B} \circ (h_A \otimes h_B))$, and the unit of the tensor
product is $(I, q_I)$; both actions are easily shown to satisfies
the action diagrams of the Eilenberg Moore category. The left and
right unitors are $\lambda : I \otimes A \mto A$ and $\rho : A
\otimes I \mto A$, because they are indeed coalgebra morphisms.

\ \\
\noindent
The respective diagram for the right unitor is as follows:
\begin{center}
  \begin{math}
    \begin{array}{lll}
      \bfig
      \square|amma|/->`->``/<650,500>[A \otimes I`eA \otimes I`A`;h_A \otimes \id{}`\rho``]
      \morphism(650,500)<650,0>[eA \otimes I`eA \otimes eI;\id{} \otimes \q{I}]
      \square(1300,0)|amma|/->``->`/<650,500>[eA \otimes eI`e(A \otimes I)``eA;\q{A,I}``e\rho`]

      \morphism(650,500)<1300,-500>[eA \otimes I`eA;\rho]
      \morphism<1950,0>[A`eA;h_A]
      \efig
    \end{array}
  \end{math}
\end{center}
The left diagram commutes by naturality of $\rho$, the right diagram
commutes by the fact that $e$ is a monoidal functor.  Showing the
left unitor is a coalgebra morphism is similar.

The unitors are natural and isomorphisms, because they are
essentially inherited from the underlying Lambek category.

The associator $\alpha : (A \otimes B) \otimes C \mto A \otimes (B
\otimes C)$ is also a coalgebra morphism.  First, notice that:
\[\q{A \otimes B,C} \circ ((\q{A,B} \circ (h_A \otimes h_B)) \otimes h_c) = \q{A \otimes B,C} \circ (\q{A,B} \otimes \id{}) \circ ((h_A \otimes h_B) \otimes h_C)\]
where the left-hand side is the action of the coalgebra $(A \otimes B)
\otimes C$. Similarly, the following is the action of the coalgebra
$A \otimes (B \otimes C)$:
\[
\q{A,B \otimes C} \circ (h_A \otimes (\q{B,C} \circ (h_B \otimes h_C))) = \q{A,B \otimes C} \circ (\id{} \otimes \q{B,C}) \circ (h_A \otimes (h_B \otimes h_C))
\]
The following diagram must commute:
\begin{center}
  \rotatebox{90}{$    
    \bfig
    \square|amma|<1200,500>[
      (A \otimes B) \otimes C`
      (eA \otimes eB) \otimes eC`
      A \otimes (B \otimes C)`
      eA \otimes (eB \otimes eC);
      (h_A \otimes h_B) \otimes h_C`
      \alpha`
      \alpha`
      h_A \otimes (h_B \otimes h_C)]

    \square(1200,0)|amma|/->`->``->/<1200,500>[
      (eA \otimes eB) \otimes eC`
      e(A \otimes B) \otimes eC`
      eA \otimes (eB \otimes eC)`
      eA \otimes e(B \otimes C);
      \q{} \otimes \id{}`
      \alpha``
      \id{} \otimes \q{}]

    \square(2400,0)|amma|/->``->`->/<1200,500>[
      e(A \otimes B) \otimes eC`
      e((A \otimes B) \otimes C)`
      eA \otimes e(B \otimes C)`
      e(A \otimes (B \otimes C));
      \q{}``
      e\alpha`
      \q{}]
    \efig
    $}
\end{center}
The left diagram commutes by naturality of $\alpha$, and the right
diagram commutes because $e$ is a monoidal functor.

Composition in $\cat{L}^e$ is the same as $\cat{L}$, and thus, the
monoidal coherence diagrams hold in $\cat{L}^e$ as well.  Thus,
$\cat{L}^e$ is monoidal.  We now show that it is symmetric.    
% subsubsection proof_of_the_eilenberg-moore_category_is_monoidal_lemma:the_eilenberg_moore_category_is_monoidal (end)

\subsubsection{Proof of Lemma~\ref{lemma:pseudo-braided}}
\label{subsec:proof_of_lemma:pseudo-braided}

We define $\beta$ as follows:
\[
\beta_{A,B} := A \otimes B \mto^{h_A \otimes h_B} eA \otimes eB \mto^{ex_{A,B}} eB \otimes eA \mto^{\varepsilon_B \otimes \varepsilon_A} B \otimes A
\]
Suppose $f : A \mto A'$ and $g : B \mto B'$ are two coalgebra
morphisms.  Then the following diagram shows that $\beta_{A,B}$ is a
natural transformation:
\[
\bfig
\square|amma|<900,500>[
  A \otimes B`
  eA \otimes eB`
  A' \otimes B'`
  eA' \otimes eB';
  h_A \otimes h_B`
  f \otimes g`
  ef \otimes eg`
  h_{A'} \otimes h_{B'}]

\square(900,0)|amma|<900,500>[
  eA \otimes eB`
  eB \otimes eA`
  eA' \otimes eB'`
  eB' \otimes eA';
  \e{A,B}`
  ef \otimes eg`
  eg \otimes ef`
  \e{A',B'}]

\square(1800,0)|amma|<900,500>[
  eB \otimes eA`
  B \otimes A`
  eB' \otimes eA'`
  B' \otimes A';
  \varepsilon_{B} \otimes \varepsilon_{A}`
  eg \otimes ef`
  g \otimes f`
  \varepsilon_{B'} \otimes \varepsilon_{A'}]
\efig
\]
The left diagram commutes because $f$ and $g$ are both coalgebra
morphisms, the middle diagram commutes because $\e{A,B}$ is a
natural transformation, and the right diagram commutes by naturality
of $\varepsilon$.
% subsubsection proof_of_lemma:pseudo-braided (end)

\subsubsection{Proof of Corollary~\ref{corollary:ex-simple}}
\label{subsec:proof_of_corollary:ex-simple}
This proof follows by the fact that the following diagram commutes:
\[
\bfig
\square|mmmm|/=`->`->`=/<900,500>[
  A \otimes B`
  A \otimes B`
  eA \otimes eB`
  eA \otimes eB;`
  h_A \otimes h_B`
  h_A \otimes h_B`]

\qtriangle(0,-500)|mmm|/=`<-`->/<900,500>[
  eA \otimes eB`
  eA \otimes eB`
  e^2A \otimes e^2B;`
  \varepsilon_{eA} \otimes \varepsilon_{eB}`
  h_{eA} \otimes h_{eB}]

\dtriangle(0,-1000)|mmm|/`->`<-/<900,500>[
  e^2A \otimes e^2B`
  eB \otimes eA`
  e^2B \otimes e^2A;`
  \e{eA,eB}`
  \varepsilon_{eB} \otimes \varepsilon_{eA}]

\morphism(0,0)<0,-1000>[eA \otimes eB`eB \otimes eA;\e{A,B}]

\square(900,0)|mmmm|/=`->`->`/<900,500>[
  A \otimes B`
  A \otimes B`
  eA \otimes eB`
  eA \otimes eB;`
  h_A \otimes h_B`
  h_A \otimes h_B`]

\dtriangle(900,-1500)|mmm|/`->`<-/<900,1500>[
  eA \otimes eB`
  B \otimes A`
  eB \otimes eA;`
  \e{A,B}`
  \varepsilon_{B} \otimes \varepsilon_A]

\morphism(900,-1500)|m|<-900,500>[B \otimes A`eB \otimes eA;h_B \otimes h_A]
\efig
\]
The diagram on the right commutes because $\beta_{A,B}$ is a natural
transformation, and the other diagrams commute either because
$\cat{L}$ is a Lambek category with exchange, or by the action
diagrams.
% subsubsection proof_of_corollary:ex-simple (end)

\subsubsection{Proof of Lemma~\ref{lemma:cofork-for-ex}}
\label{subsec:proof_of_lemma:cofork-for-ex}
We prove this by equational reasoning as follows:
\begin{center}
  \begin{math}
    \small
    \begin{array}{lll}
      (\h{B} \otimes \h{A}) \circ (\varepsilon_B \otimes \varepsilon_A) \circ \e{A,B} \circ (\h{A} \otimes \h{B})
      \\\,\,\,\,\,\,\,\,\,\,\,
      = (\h{B} \otimes \h{A}) \circ (\varepsilon_B \otimes \varepsilon_A) \circ (\h{B} \otimes \h{A}) \circ \beta_{A,B}
      & \text{(Corollary~\ref{corollary:ex-simple})}\\
      \,\,\,\,\,\,\,\,\,\,\,= (\h{B} \otimes \h{A}) \circ ((\varepsilon_B \circ \h{B}) \otimes (\varepsilon_A \circ \h{A})) \circ \beta_{A,B}
      & \text{}\\
      \,\,\,\,\,\,\,\,\,\,\,= (\h{B} \otimes \h{A}) \circ (\id_B \otimes \id_A) \circ \beta_{A,B}
      & \text{(Action diagrams)}\\
      \,\,\,\,\,\,\,\,\,\,\,= (\h{B} \otimes \h{A}) \circ \beta_{A,B}
      & \text{}\\
      \,\,\,\,\,\,\,\,\,\,\,= \e{A,B} \circ (\h{A} \otimes \h{B})
      & \text{(Corollary~\ref{corollary:ex-simple})}\\
      \,\,\,\,\,\,\,\,\,\,\,= (\id_B \otimes \id_A) \circ \e{A,B} \circ (\h{A} \otimes \h{B})
      & \text{}\\
      \,\,\,\,\,\,\,\,\,\,\,= ((e\varepsilon_B \circ \delta_B) \otimes (e\varepsilon_A \circ \delta_A)) \circ \e{A,B} \circ (\h{A} \otimes \h{B})
      & \text{(Monoidal Comonad)}\\
      \,\,\,\,\,\,\,\,\,\,\,= (e\varepsilon_B \otimes e\varepsilon_A) \circ (\delta_B \otimes \delta_A) \circ \e{A,B} \circ (\h{A} \otimes \h{B})
      & \text{}\\
    \end{array}
  \end{math}
\end{center}
% subsubsection proof_of_lemma:cofork-for-ex (end)

\subsubsection{Proof of Lemma~\ref{lemma:beta-coalgebra-morph}}
\label{subsec:proof_of_lemmabeta-coalgebra-morph}
The proof follows from the commutativity of the following diagram:
  \[
  \small
  \bfig
  \square|amma|<800,500>[
    A \otimes B`
    eA \otimes eB`
    eA \otimes eB`
    e^2A \otimes e^2B;
    h_A \otimes h_B`
    h_A \otimes h_B`
    \delta_A \otimes \delta_B`
    eh_A \otimes eh_B]

  \square(800,0)|amma|<800,500>[
    eA \otimes eB`
    eB \otimes eA`
    e^2A \otimes e^2B`
    e^2B \otimes e^2A;
    \e{A,B}`
    \delta_A \otimes \delta_B`
    \delta_B \otimes \delta_A`
    \e{eA,eB}]

  \square(1600,0)|amma|<800,500>[
    eB \otimes eA`
    B \otimes A`
    e^2B \otimes e^2A`
    eA \otimes eB;
    \varepsilon_B \otimes \varepsilon_A`
    \delta_B \otimes \delta_A`
    h_B \otimes h_A`
    e\varepsilon_B \otimes e\varepsilon_A]

  \square(0,-500)|amma|<800,500>[
    eA \otimes eB`
    e^2A \otimes e^2B`
    e(A \otimes B)`
    e(eA \otimes eB);
    eh_A \otimes eh_B`
    \q{A,B}`
    \q{eA,eB}`
    e(h_A \otimes h_B)]

  \square(800,-500)|amma|<800,500>[
    e^2A \otimes e^2B`
    e^2B \otimes e^2A`
    e(eA \otimes eB)`
    e(eB \otimes eA);
    \e{eA,eB}`
    \q{eA,eB}`
    \q{eB,eA}`
    e\e{A,B}]

  \square(1600,-500)|amma|<800,500>[
    e^2B \otimes e^2A`
    eA \otimes eB`
    e(eB \otimes eA)`
    e(B \otimes A);
    e\varepsilon_B \otimes e\varepsilon_A`
    \q{eB,eA}`
    \q{B,A}`
    e(\varepsilon_B \otimes \varepsilon_A)]

  \place(400,250)[\text{(1)}]
  \place(1200,250)[\text{(2)}]
  \place(2000,250)[\text{(3)}]
  \place(400,-250)[\text{(4)}]
  \place(1200,-250)[\text{(5)}]
  \place(2000,-250)[\text{(6)}]
  \efig 
  \]
  Diagram one commutes by the action diagrams for the coalgebras
  $(A,h_A)$ and $(B,h_B)$, diagram two commutes because $\cat{L}$ is a
  Lambek category with exchange, diagram three does not commute, but
  holds by Lemma~\ref{lemma:cofork-for-ex}, diagram four and six
  commute by naturality of $\q{}$, and diagram five commutes because
  $\cat{L}$ is a Lambek category with exchange.
% subsubsection proof_of_lemma:beta-coalgebra-morph (end)

  \subsubsection{Proof of The Eilenberg-Moore Category is Symmetric Monoidal (Lemma~\ref{lemma:the_eilenberg-moore_category_is_symmetric_monoidal})}
  \label{subsec:proof_of_the_eilenberg-moore_category_is_symmetric_lemma:the_eilenberg-moore_category_is_symmetric_monoidal}
  The following diagram shows that $\beta_{B,A} \circ \beta_{A,B} = \id_{A \otimes B}$:
  \begin{center}
    \begin{math}
      \bfig
      \square|amma|<800,500>[
        A \otimes B`
        eA \otimes eB`
        eA \otimes eB`
        e^2A \otimes e^2 B;
        h_A \otimes h_B`
        h_A \otimes h_B`
        \delta_A \otimes \delta_B`
        \delta_A \otimes \delta_B]

      \square(0,-500)|amma|<800,500>[
        eA \otimes eB`
        e^2A \otimes e^2B`
        eB \otimes eA`
        e^2B \otimes e^2A;
        \delta_A \otimes \delta_B`
        \e{A,B}`
        \e{eA,eB}`
        \delta_B \otimes \delta_A]

      \square(0,-1000)|ammm|<800,500>[
        eB \otimes eA`
        e^2B \otimes e^2A`
        B \otimes A`
        eB \otimes eA;
        \delta_B \otimes \delta_A`
        \varepsilon_B \otimes \varepsilon_A`
        e\varepsilon_{B} \otimes e\varepsilon_{A}`
        h_B \otimes h_A]

      \square(800,-1000)|ammm|<1200,500>[
        e^2B \otimes e^2A`
        e^2A \otimes e^2B`
        eB \otimes eA`
        eA \otimes eB;
        \e{eB,eA}`
        e\varepsilon_{B} \otimes e\varepsilon_{A}`
        e\varepsilon_{A} \otimes e\varepsilon_{B}`
        \e{B,A}]

      \btriangle(800,-500)|mmm|/`=`/<1200,500>[
        e^2A \otimes e^2B`
        e^2B \otimes e^2A`
        e^2A \otimes e^2B;``]

      \morphism(2000,-1000)<600,0>[
        eA \otimes eB`
        A \otimes B;
        \varepsilon_A \otimes \varepsilon_B]

      \morphism(0,500)/{@{=}@/^10em/}/<2600,-1500>[
        A \otimes B`
        A \otimes B;]

      \place(400,250)[(1)]
      \place(400,-250)[(2)]
      \place(400,-750)[(3)]
      \place(1100,-300)[(4)]
      \place(1400,-750)[(5)]
      \place(1400,250)[(6)]
      \efig
    \end{math}
  \end{center}
  Diagram one trivially commutes, diagram two, four, and five commute
  because $\cat{L}$ is a Lambek category with exchange, diagram three
  does not commute, but holds by Lemma~\ref{lemma:cofork-for-ex},
  diagrams six, seven, and eight commute by the fact that
  $(e,\varepsilon,\delta)$ is a comonad and the action diagrams of the
  Eilenberg Moore category.
  
  At this point we must verify that $\beta$ respects the coherence
  diagrams of a symmetric monoidal category; see
  Definition~\ref{def:sym-monoidal-category}.  Thus, we must show that
  each of the following diagrams hold:
  \begin{description}
  \item[Case]
    \begin{center}
      \begin{math}
        \bfig
    \hSquares|aammmaa|/->`->`->``->`->`->/[
        (A \otimes B) \otimes C`
        A \otimes (B \otimes C)`
        (B \otimes C) \otimes A`
        (B \otimes A) \otimes C`
        B \otimes (A \otimes C)`
        B \otimes (C \otimes A);
        \alpha_{A,B,C}`
        \beta_{A,B \otimes C}`
        \beta_{A,B} \otimes \id_C``
        \alpha_{B,C,A}`
        \alpha_{B,A,C}`
        \id_B \otimes \beta_{A,C}]
      \efig      
      \end{math}
    \end{center}
      We can show that this diagram commutes, by reducing it to the
      corresponding diagram on free coalgebras which we know holds by
      the assumption that $\cat{L}$ is a Lambek category with
      exchange.  This reduction is as follows (due to the size of the
      diagram it is broken up into three diagrams that can be
      straightforwardly composed):
      \begin{enumerate}
      \item[] Diagram 1:
        \begin{center}
          \begin{math}
            \bfig
            \square|amma|<1000,500>[
              (eB \otimes eA) \otimes C`
              (e^2B \otimes e^2A) \otimes C`
              (B \otimes A) \otimes C`
              (eB \otimes eA) \otimes C;
              (\delta \otimes \delta) \otimes \id`
              (\varepsilon \otimes \varepsilon) \otimes \id`
              (e\varepsilon \otimes e\varepsilon) \otimes \id`
              (h_B \otimes h_A) \otimes \id]


            \square|amma|/{@{->}@/^2em/}`->`->`/<2000,500>[
              (eB \otimes eA) \otimes C`
              (eB \otimes eA) \otimes eC`
              (B \otimes A) \otimes C`
              eB \otimes (eA \otimes eC);
              \id \otimes h_C`
              (\varepsilon \otimes \varepsilon) \otimes \id`
              \alpha`]

            \morphism(1000,0)|m|<1000,500>[
              (eB \otimes eA) \otimes C`
              (eB \otimes eA) \otimes eC;
              \id \otimes h_C]

            \square(0,-500)|amma|/`=`<-`->/<2000,500>[
              (B \otimes A) \otimes C`
              eB \otimes (eA \otimes eC)`
              (B \otimes A) \otimes C`
              B \otimes (A \otimes C);``
              h_B \otimes (h_A \otimes h_C)`
              \alpha]

            \square(0,-1000)|amma|/->`=`->`/<2000,500>[
              (B \otimes A) \otimes C`
              B \otimes (A \otimes C)`
              (B \otimes A) \otimes C`
              B \otimes (eA \otimes eC);
              \alpha``
              \id \otimes (h_A \otimes h_C)`]

            \morphism(0,-1000)<1000,0>[
              (B \otimes A) \otimes C`
              B \otimes (A \otimes C);
              \alpha]

            \morphism(1000,-1000)<1000,0>[
              B \otimes (A \otimes C)`
              B \otimes (eA \otimes eC);
              \id \otimes (h_A \otimes h_C)]

            \square(0,500)|amma|/->`->`->`/<2000,500>[
              (eA \otimes eB) \otimes C`
              (eA \otimes eB) \otimes eC`
              (eB \otimes eA) \otimes C`
              (eB \otimes eA) \otimes eC;
              \id \otimes h_C`
              \e{} \otimes \id`
              \e{} \otimes \id`]

            \square(0,1000)|amma|/=`->`->`->/<2000,500>[
              (A \otimes B) \otimes C`
              (A \otimes B) \otimes C`
              (eA \otimes eB) \otimes C`
              (eA \otimes eB) \otimes eC;`
              (h_A \otimes h_B) \otimes \id`
              (h_A \otimes h_B) \otimes h_C`
              \id \otimes h_C]

            \place(500,250)[(2)]
            \place(1450,450)[(1)]
            \place(1000,-250)[(3)]
            \efig
          \end{math}
        \end{center}
        Diagram one commutes because $(e,\varepsilon,\delta)$ is a
        comonad, diagram two does not commute, but holds by
        Lemma~\ref{lemma:cofork-for-ex}, and diagram 3 commutes by
        naturality of $\alpha$.  All other diagrams commute trivially.

      \item[] Diagram 2:
        \begin{center}
        \rotatebox{90}{$    
        \bfig
        \square|amma|/->`->``/<1100,400>[
          (eA \otimes eB) \otimes eC`
          eA \otimes (eB \otimes eC)`
          (eB \otimes eA) \otimes eC`;
          \alpha`
          \e{} \otimes \id``]
        
        \morphism(0,0)|m|/->/<0,-400>[
          (eB \otimes eA) \otimes eC`
          eB \otimes (eA \otimes eC);
          \alpha]

        \morphism(0,-400)|a|/->/<4550,0>[
          eB \otimes (eA \otimes eC)`
          eB \otimes (eC \otimes eA);
          \id \otimes \e{}]
        
        \morphism(1100,400)|a|/->/<1150,0>[
          eA \otimes (eB \otimes eC)`
          eA \otimes (e^2B \otimes e^2C);
          \id \otimes (\delta \otimes \delta)]
        \morphism(2250,400)|a|/->/<1150,0>[
          eA \otimes (e^2B \otimes e^2C)`
          eA \otimes e(eB \otimes eC);
          \id \otimes \q{}]
        \morphism(3400,400)|a|/->/<1150,0>[
          eA \otimes e(eB \otimes eC)`
          e(eB \otimes eC) \otimes eA;
          \e{}]
        \morphism(4550,400)|m|/->/<0,-400>[
          e(eB \otimes eC) \otimes eA`
          (eB \otimes eC) \otimes eA;
          \varepsilon \otimes \id]
        \morphism(4550,0)|m|/->/<0,-400>[
          (eB \otimes eC) \otimes eA`
          eB \otimes (eC \otimes eA);
          \alpha]

        \square(0,400)|amma|<1100,400>[
          (A \otimes B) \otimes C`
          A \otimes (B \otimes C)`
          (eA \otimes eB) \otimes eC`
          eA \otimes (eB \otimes eC);
          \alpha`
          (h_A \otimes h_B) \otimes h_C`
          h_A \otimes (h_B \otimes h_C)`
          \alpha]

        \square(1100,400)|amma|<1150,400>[
          A \otimes (B \otimes C)`
          eA \otimes (eB \otimes eC)`
          eA \otimes (eB \otimes eC)`
          eA \otimes (e^2B \otimes e^2C);
          h_A \otimes (h_B \otimes h_C)`
          h_A \otimes (h_B \otimes h_C)`
          \id \otimes (eh_B \otimes eh_C)`
          \id \otimes (\delta \otimes \delta)]

        \square(2250,400)|amma|<1150,400>[
          eA \otimes (eB \otimes eC)`
          eA \otimes e(B \otimes C)`
          eA \otimes (e^2B \otimes e^2C)`
          eA \otimes e(eB \otimes eC);
          \id \otimes \q{}`
          \id \otimes (eh_B \otimes eh_C)`
          \id \otimes e(h_B \otimes h_C)`
          \id \otimes \q{}]

        \square(3400,400)|amma|<1150,400>[
          eA \otimes e(B \otimes C)`
          e(B \otimes C) \otimes eA`
          eA \otimes e(eB \otimes eC)`
          e(eB \otimes eC) \otimes eA;
          \e{}`
          \id \otimes e(h_B \otimes h_C)`
          e(h_B \otimes h_C) \otimes \id`
          \e{}]

        \square(0,-800)|amma|/->`<-`=`/<4550,400>[
          eB \otimes (eA \otimes eC)`
          eB \otimes (eC \otimes eA)`
          B \otimes (A \otimes C)`
          eB \otimes (eC \otimes eA);
          \id \otimes \e{}`
          h_B \otimes (h_A \otimes h_C)``]

        \square(0,-1200)|amma|/->`->``/<1137,400>[
          B \otimes (A \otimes C)`
          B \otimes (eA \otimes eC)`
          B \otimes (eA \otimes eC)`;
          \id \otimes (h_A \otimes h_C)`
          \id \otimes (h_A \otimes h_C)``]

        \square(1137,-1200)|amma|/->``=`/<1137,400>[
          B \otimes (eA \otimes eC)`
          B \otimes (eC \otimes eA)``
          B \otimes (eC \otimes eA);
          \id \otimes \e{}```]

        \morphism(0,-1200)|a|/->/<2274,0>[
          B \otimes (eA \otimes eC)`
          B \otimes (eC \otimes eA);
          \id \otimes \e{}]

        \square(2274,-1200)|amma|/->`=`=`->/<2276,400>[
          B \otimes (eC \otimes eA)`
          eB \otimes (eC \otimes eA)`
          B \otimes (eC \otimes eA)`
          eB \otimes (eC \otimes eA);
          h_B \otimes \id`
          `
          `
          h_B \otimes \id]

        \place(550,600)[(1)]
        \place(1650,600)[(2)]
        \place(2850,600)[(3)]
        \place(3950,600)[(4)]
        \place(2275,0)[(5)]
        \efig
        $}
      \end{center}
        Diagram one commutes by naturality of $\alpha$, diagram two
        commutes by the action diagrams, diagram three commutes by
        naturality of $\q{}$, diagram four commutes by naturality of
        $\e{}$, and diagram five commutes because $\cat{L}$ is a
        Lambek category with exchange. All other diagrams trivially
        commute.

      \item[] Diagram 3:
        \begin{center}
          \begin{math}
            \bfig
            \square|amma|<1150,400>[
              e(B \otimes C) \otimes eA`
              (B \otimes C) \otimes A`
              e(eB \otimes eC) \otimes eA`
              (eB \otimes eC) \otimes A;
              \varepsilon \otimes \varepsilon`
              e(h_B \otimes h_C) \otimes \id`
              (h_B \otimes h_C) \otimes \id`
              \varepsilon \otimes \varepsilon]

            \square(0,-400)|amma|<1150,400>[
              e(eB \otimes eC) \otimes eA`
              (eB \otimes eC) \otimes A`
              (eB \otimes eC) \otimes eA`
              (B \otimes C) \otimes A;
              \varepsilon \otimes \varepsilon`
              \varepsilon \otimes \id`
              (\varepsilon \otimes \varepsilon) \otimes \id`
              (\varepsilon \otimes \varepsilon) \otimes \varepsilon]

            \square(0,-800)|amma|<1150,400>[
              (eB \otimes eC) \otimes eA`
              (B \otimes C) \otimes A`
              eB \otimes (eC \otimes eA)`
              B \otimes (C \otimes A);
              (\varepsilon \otimes \varepsilon) \otimes \varepsilon`
              \alpha`
              \alpha`
              \varepsilon \otimes (\varepsilon \otimes \varepsilon)]

            \square(0,-1200)|amma|/->`=``/<1150,400>[
              eB \otimes (eC \otimes eA)`
              B \otimes (C \otimes A)`
              eB \otimes (eC \otimes eA)`;
              \varepsilon \otimes (\varepsilon \otimes \varepsilon)```]
            
            \square(0,-1600)|amma|/`=``->/<1150,400>[
              eB \otimes (eC \otimes eA)``
              eB \otimes (eC \otimes eA)`
              B \otimes (C \otimes A);```
              \varepsilon \otimes (\varepsilon \otimes \varepsilon)]

            \morphism(1150,-800)|m|/=/<0,-800>[
              B \otimes (C \otimes A)`
              B \otimes (C \otimes A);]              
            \efig
          \end{math}
        \end{center}
        The top most diagram commutes by naturality of $\varepsilon$
        and the middle diagram commutes by naturality of $\alpha$.
        All other diagrams trivially commute.
      \end{enumerate}

    \item[Case]
      \begin{center}
        \begin{math}
          \bfig
          \Vtriangle[
            I \otimes A`
            A \otimes I`
            A;
            \beta_{I,A}`
            \lambda_A`
            \rho_A]
          \efig
        \end{math}
      \end{center}
      Just as we did for the previous case we reduce this diagram down
      to the corresponding one on free coaglebras that we know holds
      by the assumption that $\cat{L}$ is a Lambek category with
      exchange.  This case follows from the following commutative
      diagram:
      \begin{center}
        \begin{math}
          \bfig
          \square|amma|/->`->`->`/<1000,400>[
            eI \otimes eA`
            eA \otimes eI`
            I \otimes eA`
            eA \otimes I;
            \e{}`
            \varepsilon \otimes \id`
            \id \otimes \varepsilon`]

          \square(0,-400)|amma|/`->`->`=/<1000,400>[
            I \otimes eA`
            eA \otimes I`
            eA`
            eA;`
            \lambda`
            \rho`]

          \qtriangle(-1000,0)|amm|<1000,400>[
            I \otimes A`
            eI \otimes eA`
            I \otimes eA;
            h_I \otimes h_A`
            \id \otimes h_A`
            \varepsilon \otimes \id]

          \dtriangle(-1000,-400)|ama|/`->`->/<1000,400>[
            I \otimes eA`
            A`
            eA;`
            \lambda`
            h_A]            

          \morphism(-1000,400)|m|<0,-800>[
            I \otimes A`
            A;
            \lambda]

          \ptriangle(1000,0)|amm|<1000,400>[
            eA \otimes eI`
            A \otimes I`
            eA \otimes I;
            \varepsilon \otimes \varepsilon`
            \id \otimes \varepsilon`
            \varepsilon \otimes \id]

          \dtriangle(1000,-400)|ama|/`->`->/<1000,800>[
            A \otimes I`
            eA`
            A;`
            \rho`
            \varepsilon]
          \efig
        \end{math}
      \end{center}
      The left most triangle commutes by the action diagrams and the
      lower diagram commutes by naturality of $\lambda$.  Similarly,
      the right most lower diagram commutes by naturality of $\rho$.
      The middle diagram commutes because $\cat{L}$ is a Lambek
      category with exchange.  All other diagrams trivially commute.
  \end{description}
  % subsubsection proof_of_the_eilenberg-moore_category_is_symmetric_lemma:the_eilenberg-moore_category_is_symmetric_monoidal (end)

% subsection lambek_categories_with_exchange (end)

\subsection{Weakening and Contraction}
\label{subsec:weakening_and_contraction}
\subsection{Proof of Composition of Weakening and Contraction (Lemma~\ref{lem:compose-cw})}
\label{subsec:proof_of_composition_of_weakening_and_contraction_lem:compose-cw}
Since by definition $w:\cat{L} \mto \cat{L}$ and $c:\cat{L} \mto
\cat{L}$ are monoidal functors we know that their composition
$cw:\cat{L} \mto \cat{L}$ is a monoidal functor:
\[
\begin{array}{ll}
  \q{A,B} : cwA\otimes cwB\mto cw(A\otimes B)   \\
  \q{A,B} = c\q{A,B}^w\circ\q{wA,wB}^c        \\
  \q{I} : I\mto cwI                             \\
  \q{I} = c\q{I}^w\circ\q{I}^c
\end{array}
\]

We must now define both $\varepsilon_A:cwA\mto A$ and
$\delta_A:cwA\mto cwcwA$, and then show that they are monoidal
natural transformations subject to the comonad laws. Since we are
composing two comonads each of $\varepsilon$ and $\delta$ can be
given two definitions, but they are equivalent:
\begin{itemize}
\item $\varepsilon_A:cwA\mto A$ is defined as in the diagram
  below, which commutes by the naturality of $\varepsilon^c$.
  \begin{mathpar}
    \bfig
    \square(1050,0)/->`->`->`->/<1050,600>[
      cwA`
      wA`
      cA`
      A;
      \varepsilon_{wA}^c`
      c\varepsilon_A^w`
      \varepsilon_A^w`
      \varepsilon_A^c]
    \efig
  \end{mathpar}

\item $\delta_A:cwA\mto cwcwA$ is defined as in the diagram:
  \begin{mathpar}
    \bfig
    \square|almb|/->`->`->`->/<1050,600>[
      cwA`
      cw^2A`
      c^2wA`
      c^2w^2A;
      c\delta_A^w`
      \delta_{wA}^c`
      \delta_{w^2A}^c`
      c^2\delta_A^w]
    \square(1050,0)|amrb|/->``->`->/<1050,600>[
      cw^2A`
      c^2w^2A`
      c^2w^2A`
      cwcwA;
      \delta_{w^2A}^c``
      cdist_{wA}`
      cdist_{wA}]
    \efig
  \end{mathpar}
  The left part of the diagram commutes by the naturality
  of $\delta^c$ and the right part commutes trivially.
\end{itemize}

The remainder of the proof shows that the comonad laws hold.

\begin{itemize}
\item[] \textbf{Case 1:}
  \begin{mathpar}
    \bfig
    \square/->`->`->`->/<1050,600>[
      cwA`
      cwcwA`
      cwcwA`
      cwcwcwA;
      \delta_A`
      \delta_A`
      cw\delta_A`
      \delta_{cwA}]
    \efig
  \end{mathpar}

  The previous diagram commutes because the following one does.

  \begin{mathpar}
    \bfig
    \ptriangle/->`->`=/<700,400>[
      cwA`
      cwcwA`
      cwcwA;
      \delta_A`
      \delta_A`]
    \square(700,0)|amm|/->`->`->`/<900,400>[
      cwcwA`
      cwcw^2A`
      c^2wcwA`
      c^2wcw^2A;
      cwc\delta_A^w`
      \delta_{wcwA}^c`
      \delta_{wcw^2A}^c`]
    \ptriangle(1600,0)|amm|/->``<-/<1100,400>[
      cwcw^2A`
      cwc^2w^2A`
      c^2wcw^2A;
      cw\delta_{w^2A}^c`
      `
      cdist_{cw^2A}]
    \qtriangle(700,-600)|mmm|/->`->`->/<900,600>[
      c^2wcwA`
      c^2wcw^2A`
      c^2w^2cwA;
      c^2wc\delta_A^w`
      c^2\delta_{cwA}^w`
      c^2wdist_{wA}]
    \btriangle(0,-600)/->``->/<1600,600>[
      cwcwA`
      cw^2cwA`
      c^2w^2cwA;
      c\delta_{cwA}^w`
      `
      \delta_{w^2cwA}^c]
    \dtriangle(1600,-600)/`->`->/<1100,1000>[
      cwc^2w^2A`
      c^2w^2cwA`
      cwcwcwA;
      `
      cwcdist_{wA}`
      cdist_{wcwA}]
    % To show texts in each subdiagram:
    \ptriangle(200,-150)/``/<400,400>[(1)``;``]
    \ptriangle(1000,-200)/``/<400,400>[(2)``;``]
    \ptriangle(1300,-600)/``/<400,400>[(3)``;``]
    \ptriangle(500,-700)/``/<400,400>[(4)``;``]
    \ptriangle(1850,-150)/``/<400,400>[(5)``;``]
    \ptriangle(2100,-700)/``/<400,400>[(6)``;``]
    \efig
  \end{mathpar}

  (1) commutes by equality and we will not expand $\delta_A$ for
  simplicity. (2) and (4) commutes by the naturality of $\delta^c$. (3),
  (5) commutes by the conditions of $dist$. (6) commutes by the naturality of
  $dist$.

\item[] \textbf{Case 2}:
  \begin{mathpar}
    \bfig
    \qtriangle/->`=`->/<600,600>[
      cwA`
      cwcwA`
      cwA;
      \delta_A``
      cw\varepsilon_A]
    \efig
  \end{mathpar}

  The triangle commutes because of the following diagram chasing.

  \begin{mathpar}
    \bfig
    \qtriangle|amm|/->`<-`=/<1200,600>[
      cwA`
      cw^2A`
      cw^2A;
      c\delta_A^w`
      c\varepsilon_{wA}^w`]
    \ptriangle(1200,0)|amm|/->``->/<600,600>[
      cw^2A`
      c^2w^2A`
      cw^2A;
      \delta_{w^2A}^c``
      c\varepsilon_{w^2A}^c]
    \btriangle(0,-1200)/=``<-/<1200,1800>[
      cwA`
      cwA`
      wcwA;
      ``\varepsilon_{cwA}^w]
    \btriangle(1200,-1200)|mmb|/`<-`<-/<600,1200>[
      cw^2A`
      wcwA`
      cwcwA;
      `
      cw\varepsilon_{wA}^c`
      \varepsilon_{wcwA}^c]
    \dtriangle(600,-600)|mmm|/`->`<-/<600,600>[
      cw^2A`
      wA`
      w^2A;
      `
      \varepsilon_{w^2A}^c`
      \varepsilon_{wA}^w]
    \morphism(0,600)|m|<600,-1200>[cwA`wA;\varepsilon_{wA}^c]
    \morphism(0,-1200)|m|<600,600>[cwA`wA;\varepsilon_{wA}^c]
    \morphism(1200,-1200)|m|<0,600>[wcwA`w^2A;w\varepsilon_{wA}^c]
    \morphism(1800,600)|r|<0,-1800>[c^2w^2A`cwcwA;cdist_{wA}]
    \ptriangle(800,300)/``/<100,100>[(1)``;``]
    \ptriangle(1350,300)/``/<100,100>[(2)``;``]
    \ptriangle(700,-300)/``/<100,100>[(3)``;``]
    \ptriangle(1600,-300)/``/<100,100>[(4)``;``]
    \ptriangle(300,-700)/``/<100,100>[(5)``;``]
    \ptriangle(700,-1000)/``/<100,100>[(6)``;``]
    \ptriangle(1450,-1000)/``/<100,100>[(7)``;``]
    \efig
  \end{mathpar}
  (1) commutes by the comonad law for $w$ with components $\delta_A^w$
  and $\varepsilon_{wA}^w$. (2) commutes by the comonad law for $c$ with
  components $\delta_{w^2A}^c$ and $\varepsilon_{w^2A}^c$. (3) and (7)
  commute by the naturality of $\varepsilon^c$. (4) commutes by the condition
  of $dist$. (5) commutes trivially. And (6) commutes by the naturality of
  $\varepsilon^w$.
  
\item[] \textbf{Case 3}:
  \begin{mathpar}
    \bfig
    \btriangle/->`=`->/<600,600>[
      cwA`
      cwcwA`
      cwA;
      \delta_A``
      \varepsilon_{cwA}]
    \efig
  \end{mathpar}

  The previous triangle commutes because the following diagram chasing
  does.

  \begin{mathpar}
    \bfig
    \qtriangle|amm|/->`->`/<800,400>[
      cwA`
      cw^2A`
      c^2wA;
      c\delta_A^w`
      \delta_{wA}^c`]
    \morphism(0,400)|m|/<-/<800,-800>[cwA`c^2wA;c\varepsilon_{wA}^c]
    \ptriangle(800,0)|amm|/->``<-/<800,400>[
      cw^2A`
      c^2w^2A`
      c^2wA;
      \delta_{w^2A}^c``
      c^2\delta_A^w]
    \morphism(800,-400)|m|/<-/<800,800>[c^2wA`c^2w^2A;c^2w\varepsilon_A^w]
    \morphism(800,0)/=/<0,-400>[c^2wA`c^2wA;]
    \btriangle(0,-800)/=``<-/<800,1200>[
      cwA`
      cwA`
      cwcA;
      ``
      cw\varepsilon_A^c]
    \dtriangle(800,-800)/`->`<-/<800,1200>[
      c^2w^2A`
      cwcA`
      cwcwA;
      `
      cdist_{wA}`
      cwc\varepsilon_A^w]
    \morphism(800,-400)|m|/->/<0,-400>[c^2wA`cwcA;cdist_A]
    \ptriangle(800,100)/``/<100,100>[(1)``;``]
    \ptriangle(600,-100)/``/<100,100>[(2)``;``]
    \ptriangle(1000,-100)/``/<100,100>[(3)``;``]
    \ptriangle(400,-600)/``/<100,100>[(4)``;``]
    \ptriangle(1200,-600)/``/<100,100>[(5)``;``]
    \efig
  \end{mathpar}

  (1) commutes by the naturality of $\delta^c$. (2) is the comonad law
  for $c$ with components $\delta_{wA}^c$ and $\varepsilon_{wA}^c$. (3)
  is the comonad law for $w$ with components $\delta_A^w$ and
  $\varepsilon_A^w$. (4) commutes by the condition of $dist$. And (5)
  commute by the naturality of $dist$.

\end{itemize}
% subsection proof_of_composition_of_weakening_and_contraction_(lemma~\ref{lem:compose-cw}) (end)
% section proofs (end)
<<<<<<< HEAD



\subsection{Proof of Conditions of Lambek category with $cw$ (Lemma~\ref{lem:compose-cw-2})}
\label{subsec:proof_of_conditions_of_lambek_with_cw_lem:compose-cw-2}
  \begin{itemize}
  \item[1.] As shown in the paper.
  % Conditions for each cwA being a comonoid
  \item[2.] Each $(cwA,\w{A},\c{A})$ is a comonoid.
    \begin{itemize}
    \item[] \textbf{Case 1:}
      \begin{mathpar}
      \bfig
      \square/->`->``/<1050,400>[
        cwA`
        cwA\otimes cwA`
        cwA\otimes cwA`;
        \c{A}`
        \c{A}``]
      \square(1050,0)/->``<-`/<1150,400>[
        cwA\otimes cwA`
        cwA\otimes(cwA\otimes cwA)``
        (cwA\otimes cwA)\otimes cwA;
        id_{cwA}\otimes\c{A}``
        \alpha_{cwA,cwA,cwA}`]
        \morphism(0,0)|b|<2200,0>[
          cwA\otimes cwA`
          (cwA\otimes cwA)\otimes cwA;
          \c{A}\otimes id_{cwA}]
      \efig
      \end{mathpar}

      The previous diagram commutes by the following diagram chasing.

      \begin{mathpar}
      \bfig
        \ptriangle/->`->`=/<1100,400>[
          cwA`
          cwA\otimes cwA`
          cwA\otimes cwA;
          \c{A}`
          \c{A}`]
        \qtriangle(1100,0)/->``->/<1700,400>[
          cwA\otimes cwA`
          cwA\otimes(cwA\otimes I)`
          cwA\otimes((cwA\otimes I)\otimes cwA);
          id_{cwA}\otimes\rho_{cwA}^{-1}``
          id_{cwA}\otimes\cL{wA,I}]
        \square(0,-400)|mlmm|/->`->`->`/<1100,400>[
          cwA\otimes cwA`
          cwA\otimes(I\otimes cwA)`
          (cwA\otimes I)\otimes cwA`
          cwA\otimes(cwA\otimes(I\otimes cwA));
          id_{cwA}\otimes\lambda_{cwA}^{-1}`
          \rho_{cwA}^{-1}\otimes id_{cwA}`
          id_{cwA}\otimes\cR{wA,I}`]
        \dtriangle(1100,-400)|mrm|/<-`->`->/<1700,400>[
          cwA\otimes((cwA\otimes I)\otimes cwA)`
          cwA\otimes(cwA\otimes(I\otimes cwA))`
          cwA\otimes(cwA\otimes cwA);
          id_{cwA}\otimes\alpha_{cwA,I,cwA}`
          id_{cwA}\otimes(\rho_{cwA}\otimes id_{cwA})`
          id_{cwA}\otimes(id_{cwA}\otimes\lambda_{cwA})]
        \square(0,-800)/`->`<-`->/<2800,400>[
          (cwA\otimes I)\otimes cwA`
          cwA\otimes(cwA\otimes cwA)`
          ((cwA\otimes I)\otimes cwA)\otimes cwA`
          (cwA\otimes cwA)\otimes cwA;
          `
          \cL{wA,I}\otimes id_{cwA}`
          \alpha_{cwA,cwA,cwA}`
          (\rho_{cwA}\otimes id_{cwA})\otimes id_{cwA}]
        \ptriangle(300,150)/``/<100,100>[(1)``;``]
        \ptriangle(1950,0)/``/<100,100>[(2)``;``]
        \ptriangle(2400,-350)/``/<100,100>[(3)``;``]
        \ptriangle(1400,-750)/``/<100,100>[(4)``;``]
      \efig
      \end{mathpar}

      (1) commutes trivially and we would not expand $\c{}$ for
      simplicity. (2) and (4) commute because $(\cat{L},c,\cL{},\cR{})$
      is a Lambek category with contraction. (3) commutes because
      $\cat{L}$ is monoidal.

    \item[] \textbf{Case 2:}
      \begin{mathpar}
      \bfig
      \Atrianglepair/->`->`->`<-`->/<1000,400>[
        cwA`
        I\otimes cwA`
        cwA\otimes cwA`
        cwA\otimes I;
        \lambda^{-1}`
        \c{A}`
        \rho^{-1}`
        \w{A}\otimes id_{cwA}`
        id_{cwA}\otimes\w{A}]
      \efig
      \end{mathpar}
      The diagram above commutes by the following diagram chasing.
      \begin{mathpar}
      \bfig
        \square/<-`<-`<-`/<2200,1200>[
          I\otimes cwA`
          wA\otimes cwA`
          cwA`
          cwA\otimes cwA;
          \w{A}^w\otimes id_{cwA}`
          \lambda_{cwA}^{-1}`
          \varepsilon_{wA}^c\otimes cwA`]
        \square(0,-1200)/`->`->`<-/<2200,1200>[
          cwA`
          cwA\otimes cwA`
          cwA\otimes I`
          cwA\otimes wA;
          `
          \rho_{cwA}^{-1}`
          id_{cwA}\otimes\varepsilon_{wA}^c`
          id_{cwA}\otimes\w{A}]
        \Ctriangle(0,-400)|mmm|/<-``->/<500,400>[
          I\otimes cwA`
          cwA`
          cwA\otimes I;
          \lambda_{cwA}^{-1}``
          \rho_{cwA}^{-1}]
        \morphism(500,800)|m|<-500,400>[
          I\otimes(I\otimes cwA)`
          I\otimes cwA;
          id_I\otimes\lambda_{cwA}]
        \square(500,400)|mmmm|/<-`<-`<-`->/<1200,400>[
          I\otimes(I\otimes cwA)`
          wA\otimes(I\otimes cwA)`
          I\otimes cwA`
          cwA\otimes(I\otimes cwA);
          \w{A}^w\otimes id_{I\otimes cwA}`
          \lambda_{I\otimes cwA}^{-1}`
          \varepsilon_{wA}^c\otimes id_{I\otimes cwA}`
          \cR{wA,I}]
        \morphism(1700,800)|m|<500,400>[
          wA\otimes(I\otimes cwA)`
          wA\otimes cwA;
          id_{wA}\otimes\lambda_{cwA}]
        \Dtriangle(1700,-400)|mmm|/`->`<-/<500,400>[
          cwA\otimes(I\otimes cwA)`
          cwA\otimes cwA`
          (cwA\otimes I)\otimes cwA;
          `
          id_{cwA}\otimes\lambda_{cwA}`
          \rho_{cwA}\otimes id_{cwA}]
        \square(500,-800)|mmmm|/->`->`->`<-/<1200,400>[
          cwA\otimes I`
          (cwA\otimes I)\otimes cwA`
          (cwA\otimes I)\otimes I`
          (cwA\otimes I)\otimes wA;
          \cL{wA,I}`
          \rho_{cwA}^{-1}`
          id_{cwA\otimes I}\otimes\varepsilon_{wA}^c`
          id_{cwA\otimes I}\otimes\w{A}^w]
        \morphism(500,-800)|m|<-500,-400>[
          (cwA\otimes I)\otimes I`
          cwA\otimes I;
          \rho_{cwA}\otimes id_I]
        \morphism(1700,-800)|m|<500,-400>[
          (cwA\otimes I)\otimes wA`
          cwA\otimes wA;
          \rho_{cwA}\otimes id_{wA}]
        \ptriangle(200,500)/``/<100,100>[(1)``;``]
        \ptriangle(1100,900)/``/<100,100>[(2)``;``]
        \ptriangle(2000,500)/``/<100,100>[(3)``;``]
        \ptriangle(1100,500)/``/<100,100>[(4)``;``]
        \ptriangle(1100,-100)/``/<100,100>[(5)``;``]
        \ptriangle(200,-700)/``/<100,100>[(6)``;``]
        \ptriangle(1100,-1100)/``/<100,100>[(7)``;``]
        \ptriangle(2000,-700)/``/<100,100>[(8)``;``]
        \ptriangle(1100,-700)/``/<100,100>[(9)``;``]
      \efig
      \end{mathpar}
    (1), (2) and (3) commute by the functionality of $\lambda$. (6), (7)
    and (8) commute by the functionality of $\rho$. (4) and (9) are
    conditions of the Lambek category with $cw$. And (5) is the
    definition of $\c{}$.

    \end{itemize}
    
    % Condition 3
    \item[3.] $\w{}$ and $\c{}$ are coalgebra morphisms.
      \begin{itemize}
      \item[] \textbf{Case 1:}
        \begin{mathpar}
        \bfig
          \square/->`->`->`->/<1000,400>[
          cwA`
          I`
          cwcwA`
          cwI;
          \w{A}`
          \delta{A}`
          \q{I}`
          cw\w{A}]
        \efig
        \end{mathpar}

        The previous diagram commutes by the diagram below. (1) commutes by
        the naturality of $\delta^c$. (2) commutes by the condition of
        $dist_{wA}$. (3), (5) and (6) commute because $c$ is a monoidal
        comonad. (4) commutes because $(\cat{L},w,\w{}^w)$ is a Lambek
        category with weakening. (7) commutes because $c$ and $w$ are
        monoidal comonads.
        \begin{mathpar}
        \bfig
          \square/->`->``/<800,400>[
            cwA`
            cI`
            c^2wA`;
            c\w{A}^w`
            \delta_{wA}^c``]
          \morphism<0,-400>[c^2wA`c^2w^2A;c^2\delta_A^w]
          \morphism(0,400)|m|<800,-800>[cwA`cw^2A;c\delta_A^w]
          \square(0,-800)|almb|/<-`->`=`->/<800,400>[
            c^2w^2A`
            cw^2A`
            cwcwA`
            cw^2A;
            \delta_{w^2A}^c`
            cdist_{wA}``
            cw\varepsilon_{wA}^c]
          \morphism(0,-400)|m|<800,-400>[
            c^2w^2A`cw^2A;c\varepsilon_{w^A}^c]
          \Vtriangle(800,0)|amm|/->`<-`=/<400,400>[
            cI`
            I`
            I;
            \epsilon_I^c`
            \q{I}^c`]
          \Ctriangle(1200,-400)|arm|/`->`<-/<400,400>[
            I`I`cI;
            `
            \q{I}^c`
            \varepsilon_I^c]
          \morphism(1600,-400)|r|<0,-400>[cI`cwI;c\q{I}^w]
          \btriangle(800,-800)|amb|/`->`<-/<800,1200>[
            cI`
            cw^2A`
            cwI;
            `
            c\q{I}^w`
            cw\w{A}^w]
          \ptriangle(300,-250)/``/<100,100>[(1)``;``]
          \ptriangle(150,-750)/``/<100,100>[(2)``;``]
          \ptriangle(500,-600)/``/<100,100>[(3)``;``]
          \ptriangle(800,-200)/``/<100,100>[(4)``;``]
          \ptriangle(1200,100)/``/<100,100>[(5)``;``]
          \ptriangle(1450,-100)/``/<100,100>[(6)``;``]
          \ptriangle(1450,-500)/``/<100,100>[(7)``;``]
        \efig
        \end{mathpar}
      
      \item[] \textbf{Case 2:}
        \begin{mathpar}
        \bfig
          \square/->`->``/<1050,400>[
            cwA`
            cwA\otimes cwA`
            cwcwA`;
            \c{A}`
            \delta_A``]
          \square(1050,0)|ammb|/->``->`/<1050,400>[
            cwA\otimes cwA`
            cwcwA\otimes cwcwA``
            cw(cwA\otimes cwA);
            \delta_A\otimes\delta_A``
            \q{cwA,cwA}`]
            \morphism(0,0)|b|<2100,0>[cwcwA`cw(cwA\otimes cwA);cw\c{A}]
        \efig
        \end{mathpar}

        To prove the previous diagram commute, we first expand it, Then we
        divide it into five parts as shown belovee, and prove each part commutes.

        \begin{mathpar}
        \bfig
          \square|almm|/->`->`<-`/<600,400>[
            cwA`
            cwA\otimes I`
            cw^2A`
            w(cwA\otimes I);
            \rho_{cwA}^{-1}`
            c\delta_A^w`
            \varepsilon_{cwA\otimes I}^w`]
          \qtriangle(600,0)/->``->/<2000,400>[
            cwA\otimes I`
            (cwA\otimes I)\otimes cwA`
            cwA\otimes cwA;
            \cL{wA,I}``
            \rho_{cwA}\otimes id_{cwA}]
          \morphism<0,-400>[cw^2A`c^2w^2A;\delta_{w^2A}^c]
          \morphism(0,-400)<0,-400>[c^2w^2A`cwcwA;cdist_{wA}]
          \morphism(0,-800)<0,-400>[cwcwA`cw(cwA\otimes I);cw\rho_{cwA}]
          \btriangle(0,-1600)/->``->/<1300,400>[
            cw(cwA\otimes I)`
            cw((cwA\otimes I)\otimes cwA)`
            cw(cwA\otimes cwA);
            cw\cL{wA,I}``
            cw(\rho_{cwA}\otimes id_{cwA})]
          \morphism(0,-1200)|m|<600,1200>[
            cw(cwA\otimes I)`w(cwA\otimes I);
            \varepsilon_{w(cwA\otimes I)}^c]
          \square(1300,-1600)|mmmb|/->`<-``<-/<1300,1600>[
            w(cwA\otimes cwA)`
            cwA\otimes cwA`
            cw(cwA\otimes cwA)`
            c(wcwA\otimes wcwA);
            \varepsilon_{cwA\otimes cwA}^w`
            c\varepsilon_{cwA\otimes cwA}^w`
            `
            c\q{cwA\otimes cwA}^w]
          \Ctrianglepair(2600,-800)|mrmmr|/<-`->`=`<-`->/<900,400>[
            cwA\otimes cwA`
            cw^2A\otimes cw^2A`
            cw^2A\otimes cw^2A`
            c^2w^2A\otimes c^2w^2A;
            c\varepsilon_{wA}^c\otimes c\varepsilon_{wA}^c`
            c\delta_A^w\otimes c\delta_A^w``
            \varepsilon_{cw^2A}^c\otimes\varepsilon_{cw^2A}^c`
            \delta_{w^2A}^c\otimes\delta_{w^2A}^c]
          \morphism(2600,-800)|m|<0,-400>[
            c^2w^2A\otimes c^2w^2A`
            cwcwA\otimes cwcwA;
            cdist_{wA}\otimes cdist_{wA}]
          \morphism(2600,-1200)|m|<0,-400>[
            cwcwA\otimes cwcwA`
            c(wcwA\otimes wcwA);
            \q{wcwA\otimes wcwA}^c]
          \ptriangle(2400,-350)/``/<100,100>[(a)``;``]
          \ptriangle(2400,-650)/``/<100,100>[(b)``;``]
          \ptriangle(300,100)/``/<100,100>[(c)``;``]
          \ptriangle(650,-1000)/``/<100,100>[(d)``;``]
          \ptriangle(1800,-1100)/``/<100,100>[(e)``;``]
        \efig
        \end{mathpar}

        Part (a) and (b) are comonad laws.
        
        Part (c) commutes by the following diagram chase. (1) is equality.
        (2) is the comonad law for $w$. (3) is the comonad law for $c$.
        (4) commutes by the naturality of $\varepsilon^c$. (5) is one of
        the conditions for $dist_{wA}$. (6) commutes by the naturality of
        $\varepsilon^w$. And (7) commutes by the naturality of
        $\varepsilon^c$.
        \begin{mathpar}
        \bfig
          \btriangle|lmm|/->`->`=/<600,600>[
            cwA`
            cw^2A`
            cw^2A;
            c\delta_A^w`
            c\delta_A^w`]
          \morphism(0,600)|m|/=/<1200,-600>[cwA`cwA;]
          \ptriangle(0,-600)|mlm|/`->`<-/<600,600>[
            cw^2A`
            cw^2A`
            c^2w^2A;
            `
            \delta_{w^2A}^c`
            \varepsilon_{cw^2A}^c]
          \ptriangle(600,-600)|mmm|/->`->`<-/<600,600>[
            cw^2A`
            cwA`
            wcwA;
            c\varepsilon_{wA}^w`
            dist_{wA}`
            \varepsilon_{cwA}^w]
          \ptriangle(0,-1000)|mlm|/`->`<-/<600,400>[
            c^2w^2A`
            wcwA`
            cwcwA;
            `
            cdist_{wA}`
            \varepsilon_{wcwA}^c]
          \square(0,-600)/->``<-`/<1800,1200>[
            cwA`
            cwA\otimes I``
            w(cwA\otimes I);
            \rho_{cwA}^{-1}``
            \varepsilon_{cwA\otimes I}^w`]
          \square(600,-1000)|mmrm|/->``<-`/<1200,400>[
            wcwA`
            w(cwA\otimes I)``
            cw(cwA\otimes I);
            w\rho_{cwA}^{-1}``
            \varepsilon_{w(cwA\otimes I)}^c`]
          \morphism(0,-1000)|b|<1800,0>[
            cwcwA`
            cw(cwA\otimes I);
            cw\rho_{cwA}^{-1}]
          \ptriangle(200,100)/``/<100,100>[(1)``;``]
          \ptriangle(650,50)/``/<100,100>[(2)``;``]
          \ptriangle(200,-300)/``/<100,100>[(3)``;``]
          \ptriangle(350,-650)/``/<100,100>[(4)``;``]
          \ptriangle(800,-300)/``/<100,100>[(5)``;``]
          \ptriangle(1500,-100)/``/<100,100>[(6)``;``]
          \ptriangle(1100,-900)/``/<100,100>[(7)``;``]
        \efig
        \end{mathpar}

        Part (d) commutes by the following diagram chase. The upper two
        squares both commute by the naturality of $\varepsilon^w$, and the
        lower two squares commute by the naturality of $\varepsilon^c$.
        \begin{mathpar}
        \bfig
          \square|almm|/->`<-`<-`->/<1200,400>[
            cwA\otimes I`
            (cwA\otimes I)\otimes cwA`
            w(cwA\otimes I)`
            w((cwA\otimes I)\otimes cwA);
            \cL{wA,I}`
            \varepsilon_{cwA\otimes I}^w`
            \varepsilon_{(cwA\otimes I)\otimes cwA}^w`
            w\cL{wA,I}]
          \square(0,-400)|mlmb|/`<-`<-`->/<1200,400>[
            w(cwA\otimes I)`
            w((cwA\otimes I)\otimes cwA)`
            cw(cwA\otimes I)`
            cw((cwA\otimes I)\otimes cwA);
            `
            \varepsilon_{w(cwA\otimes I)}^c`
            \varepsilon_{w((cwA\otimes I)\otimes A)}^c`
            cw\cL{wA,I}]
          \square(1200,0)|ammm|/->``<-`->/<1350,400>[
            (cwA\otimes I)\otimes cwA`
            cwA\otimes cwA`
            w((cwA\otimes I)\otimes cwA)`
            w(cwA\otimes cwA);
            \rho_{cwA}\otimes id_{cwA}``
            \varepsilon_{cwA\otimes cwA}^w`
            w(\rho_{cwA}\otimes id_{cwA})]
          \square(1200,-400)|mmrb|/``<-`->/<1350,400>[
            w((cwA\otimes I)\otimes cwA)`
            w(cwA\otimes cwA)`
            cw((cwA\otimes I)\otimes cwA)`
            cw(cwA\otimes cwA);
            ``
            \varepsilon_{w(cwA\otimes cwA)}^c`
            cw(\rho_{cwA}\otimes id_{cwA})]
        \efig
        \end{mathpar}

        Part (e) commutes by the following diagram. (1) commutes by the
        condition of $dist_{wA}$. (2) and (4) commute by the naturality of
        $\varepsilon^c$. (3) and (5) commute because $w$ and $c$ are
        monoidal comonads.
        \begin{mathpar}
        \bfig
          \qtriangle|amm|/<-`<-`->/<1200,400>[
            cwA\otimes cwA`
            cw^2A\otimes cw^2A`
            wcwA\otimes wcwA;
            c\varepsilon_{wA}^w\otimes c\varepsilon_{wA}^w`
            \varepsilon_{cwA}^w\otimes\varepsilon_{cwA}^w`
            dist_{wA}\otimes dist_{wA}]
          \square(1200,0)|amrm|/<-``->`<-/<1200,400>[
            cw^2A\otimes cw^2A`
            c^2w^2A\otimes c^2w^2A`
            wcwA\otimes wcwA`
            cwcwA\otimes cwcwA;
            \varepsilon_{cw^2A}^c\otimes\varepsilon_{cw^2A}^c``
            cdist_{wA}\otimes cdist_{wA}`
            \varepsilon_{wcwA}^c\otimes\varepsilon_{wcwA}^c]
          \morphism(0,-400)|l|<0,800>[
            w(cwA\otimes cwA)`
            cwA\otimes cwA;
            \varepsilon_{cwA\otimes cwA}^w]
          \Atriangle(0,-400)|mmm|/->`<-`/<1200,400>[
            wcwA\otimes wcwA`
            w(cwA\otimes cwA)`
            c(wcwA\otimes wcwA);
            \q{cwA,cwA}^w`
            \varepsilon_{wcwA\otimes wcwA}^c`]
          \dtriangle(1200,-400)/`->`<-/<1200,400>[
            cwcwA\otimes cwcwA`
            cw(cwA\otimes cwA)`
            c(wcwA\otimes wcwA);
            `
            \q{wcwA\otimes wcwA}^c`
            c\q{cwA\otimes cwA}]
          \morphism(0,-400)|b|/<-/<1200,0>[
            w(cwA\otimes cwA)`
            cw(cwA\otimes cwA);
            \varepsilon_{w(cwA\otimes cwA)}^c]
          \ptriangle(900,150)/``/<100,100>[(1)``;``]
          \ptriangle(1800,100)/``/<100,100>[(2)``;``]
          \ptriangle(500,-100)/``/<100,100>[(3)``;``]
          \ptriangle(1200,-300)/``/<100,100>[(4)``;``]
          \ptriangle(2150,-250)/``/<100,100>[(5)``;``]
        \efig
        \end{mathpar}
      \end{itemize}
    
    % Condition 4
    \item[4.] Any coalgebra morphism $f:(cwA,\delta_A)\mto (cwB,\delta_B)$
      between free coalgebras preserves the comonoid structure given
      by $\w{}$ and $\c{}$.

      \begin{itemize}
      \item[] \textbf{Case 1:}
        This coherence diagram is given in the definition of the Lambek
        category with $cw$.
        \begin{mathpar}
        \bfig
          \Vtriangle/->`->`->/<500,400>[
            cwA`
            cwB`
            I;
            f`
            \w{A}`
            \w{B}]
        \efig
        \end{mathpar}

      \item[] \textbf{Case 2:}
        \begin{mathpar}
        \bfig
          \square/->`->`->`->/<800,400>[
          cwA`
          cwA\otimes cwA`
          cwB`
          cwB\otimes cwB;
          \c{A}`
          f`
          f\otimes f`
          \c{B}]
        \efig
        \end{mathpar}

        The square commutes by the diagram chasing below, which commutes by
        the naturality of $\rho$ and $\cL{}$.

        \begin{mathpar}
        \bfig
          \square|almb|/->`->`->`->/<600,500>[
            cwA`
            cwA\otimes I`
            cwB`
            cwB\otimes I;
            \rho_{cwA}^{-1}`
            cwf`
            cwf\otimes id_I`
            \rho_{cwB}^{-1}]
          \square(600,0)|ammb|/->``->`->/<1000,500>[
            cwA\otimes I`
            (cwA\otimes I)\otimes cwA`
            cwB\otimes I`
            (cwB\otimes I)\otimes cwB;
            \cL{wA,I}``
            (cwf\otimes id_I)\otimes cwf`
            \cL{wB,I}]
          \square(1600,0)|amrb|/->``->`->/<1000,500>[
            (cwA\otimes I)\otimes cwA`
            cwA\otimes cwA`
            (cwB\otimes I)\otimes cwB`
            cwB\otimes cwB;
            \rho_{cwA}\otimes id_{cwA}``
            cwf\otimes cwf`
            \rho_{cwB}\otimes id_{cwB}]
        \efig
        \end{mathpar}
      \end{itemize}
  \end{itemize}
% subsection proof_of_conditions_of_lambek_with_cw_(lemma~\ref{lem:compose-cw-2}) (end)
% subsection weakening_and_contraction (end)

% section proofs (end)


























=======
>>>>>>> origin/master
