\documentclass[a4paper,UKenglish]{lipics-v2016}

\usepackage{amssymb,amsmath}
\usepackage{amsthm}
\usepackage{cmll}
\usepackage{txfonts}
\usepackage{graphicx}
\usepackage{stmaryrd}
\usepackage{todonotes}
\usepackage{mathpartir}
\usepackage{hyperref}
\usepackage{mdframed}
\usepackage[barr]{xy}
\usepackage{comment}
\usepackage{graphicx}
\usepackage[inline]{enumitem}

\usepackage{caption}
\captionsetup[figure]{name=Diagram}

%% This renames Barr's \to to \mto.  This allows us to use \to for imp
%% and \mto for a inline morphism.
\let\mto\to
\let\to\relax
\newcommand{\to}{\rightarrow}
\newcommand{\ndto}[1]{\to_{#1}}
\newcommand{\ndwedge}[1]{\wedge_{#1}}
\newcommand{\rto}{\leftharpoonup}
\newcommand{\lto}{\rightharpoonup}

% Commands that are useful for writing about type theory and programming language design.
%% \newcommand{\case}[4]{\text{case}\ #1\ \text{of}\ #2\text{.}#3\text{,}#2\text{.}#4}
\newcommand{\interp}[1]{\llbracket #1 \rrbracket}
\newcommand{\normto}[0]{\rightsquigarrow^{!}}
\newcommand{\join}[0]{\downarrow}
\newcommand{\redto}[0]{\rightsquigarrow}
\newcommand{\nat}[0]{\mathbb{N}}
\newcommand{\fun}[2]{\lambda #1.#2}
\newcommand{\CRI}[0]{\text{CR-Norm}}
\newcommand{\CRII}[0]{\text{CR-Pres}}
\newcommand{\CRIII}[0]{\text{CR-Prog}}
\newcommand{\subexp}[0]{\sqsubseteq}
%% Must include \usepackage{mathrsfs} for this to work.

\date{}

\let\b\relax
\let\d\relax
\let\t\relax
\let\r\relax
\let\c\relax
\let\j\relax
\let\wn\relax
\let\H\relax

% Cat commands.
\newcommand{\powerset}[1]{\mathcal{P}(#1)}
\newcommand{\cat}[1]{\mathcal{#1}}
\newcommand{\func}[1]{\mathsf{#1}}
\newcommand{\iso}[0]{\mathsf{iso}}
\newcommand{\H}[0]{\func{H}}
\newcommand{\J}[0]{\func{J}}
\newcommand{\catop}[1]{\cat{#1}^{\mathsf{op}}}
\newcommand{\Hom}[3]{\mathsf{Hom}_{\cat{#1}}(#2,#3)}
\newcommand{\limp}[0]{\multimap}
\newcommand{\colimp}[0]{\multimapdotinv}
\newcommand{\dial}[1]{\mathsf{Dial_{#1}}(\mathsf{Sets^{op}})}
\newcommand{\dialSets}[1]{\mathsf{Dial_{#1}}(\mathsf{Sets})}
\newcommand{\dcSets}[1]{\mathsf{DC_{#1}}(\mathsf{Sets})}
\newcommand{\sets}[0]{\mathsf{Sets}}
\newcommand{\obj}[1]{\mathsf{Obj}(#1)}
\newcommand{\mor}[1]{\mathsf{Mor(#1)}}
\newcommand{\id}[0]{\mathsf{id}}
\newcommand{\lett}[0]{\mathsf{let}\,}
\newcommand{\inn}[0]{\,\mathsf{in}\,}
\newcommand{\cur}[1]{\mathsf{cur}(#1)}
\newcommand{\curi}[1]{\mathsf{cur}^{-1}(#1)}

\newcommand{\w}[1]{\mathsf{weak}_{#1}}
\newcommand{\c}[1]{\mathsf{contra}_{#1}}
\newcommand{\cL}[1]{\mathsf{contraL}_{#1}}
\newcommand{\cR}[1]{\mathsf{contraR}_{#1}}
\newcommand{\e}[1]{\mathsf{ex}_{#1}}

\newcommand{\m}[1]{\mathsf{m}_{#1}}
\newcommand{\n}[1]{\mathsf{n}_{#1}}
\newcommand{\b}[1]{\mathsf{b}_{#1}}
\newcommand{\d}[1]{\mathsf{d}_{#1}}
\newcommand{\h}[1]{\mathsf{h}_{#1}}
\newcommand{\p}[1]{\mathsf{p}_{#1}}
\newcommand{\q}[1]{\mathsf{q}_{#1}}
\newcommand{\t}[0]{\mathsf{t}}
\newcommand{\r}[1]{\mathsf{r}_{#1}}
\newcommand{\s}[1]{\mathsf{s}_{#1}}
\newcommand{\j}[1]{\mathsf{j}_{#1}}
\newcommand{\jinv}[1]{\mathsf{j}^{-1}_{#1}}
\newcommand{\wn}[0]{\mathop{?}}
\newcommand{\codiag}[1]{\bigtriangledown_{#1}}

\newenvironment{changemargin}[2]{%
  \begin{list}{}{%
    \setlength{\topsep}{0pt}%
    \setlength{\leftmargin}{#1}%
    \setlength{\rightmargin}{#2}%
    \setlength{\listparindent}{\parindent}%
    \setlength{\itemindent}{\parindent}%
    \setlength{\parsep}{\parskip}%
  }%
  \item[]}{\end{list}}

\newenvironment{diagram}{
  \begin{center}
    \begin{math}
      \bfig
}{
      \efig
    \end{math}
  \end{center}
}

%% %% Ott
%% \input{BiLNL-inc}

\title{On Linear Modalities for Exchange, Weakening, and Contraction}
\author[1]{Jiaming Jiang}
\author[2]{Harley Eades III}
\affil[1]{Computer Science, North Carolina State University, Raleigh, North Carolina, USA\\
  \texttt{jjiang13@ncsu.edu}}
\affil[2]{Computer Science, Augusta University, Augusta, Georgia, USA\\
  \texttt{heades@augusta.edu}}

\Copyright{Jiaming J. Open and Harley E. Access}

\subjclass{TODO}
\keywords{TODO}

\begin{document}

\maketitle 

\begin{abstract}

  TODO

\end{abstract}

\section{Introduction}
\label{sec:introduction}
TODO \cite{Benton:1994}
% section introduction (end)

\section{Categorical Models}
\label{sec:categorical_models}

\subsection{Lambek Categories}
\label{subsec:lambek_categories}
\input{Lambek-categories}
% subsection lambek_categories (end)



\subsection{Lambek Categories with Exchange}
\label{subsec:lambek_categories_with_exchange}
\input{exchange}

% subsection lambek_categories_with_exchange (end)



\subsection{Lambek Categories with Weakening}
\label{subsec:lambek_categories_with_weakening}
\input{weakening}

% subsection lambek_categories_with_weakening (end)



\subsection{Lambek Categories with Contraction}
\label{subsec:lambek_categories_with_contraction}
\input{contraction}

% subsection lambek_categories_with_contraction (end)



\subsection{Linear Categories}
\label{subsec:linear_categories}

\begin{definition}
  \label{def:linear-category}
  A \textbf{linear category}, $(\cat{L},!,\w{},\c{})$, is a symmetric
  monoidal closed category $(\cat{L},I,\otimes,\limp)$ equipped with a
  symmetric monoidal comonad $(!,\varepsilon,\delta)$ with
  $\q{A,B}:!A\otimes !B\mto !(A\otimes B)$ and $\q{I}:I\mto !I$, and two
  monoidal natural transformations with components $\w{A}:!A\mto I$ and
  $\c{A}:!A\mto !A\otimes !A$, satisfying the following conditions:
  \begin{itemize}
  \item each $(!A,\w{A},\c{A})$ is a commutative comonoid, i.e.
    the following diagrams commute and $\beta\circ\c{A}=\c{A}$ where
    $\beta_{B,C}:B\otimes C\mto C\otimes B$ is the symmetry natural
    transformation of $\cat{L}$;
    \begin{mathpar}
      \bfig
      \square/->`->``/<1050,400>[
        !A`
        !A\otimes !A`
        !A\otimes !A`;
        \c{A}`
        \c{A}``]
      \square(1050,0)/->``<-`/<1050,400>[
        !A\otimes !A`
        !A\otimes(!A\otimes !A)``
        (!A\otimes !A)\otimes !A;
        id_{!A}\otimes\c{A}``
        \alpha_{!A,!A,!A}`]
        \morphism(0,0)|b|<2100,0>[
          !A\otimes !A`
          (!A\otimes !A)\otimes !A;
          \c{A}\otimes id_{!A}]
      \efig
    \end{mathpar}
    \begin{mathpar}
    \bfig
    \Atrianglepair/->`->`->`<-`->/<800,400>[
      !A`
      I\otimes !A`
      !A\otimes !A`
      !A\otimes I;
      \lambda^{-1}`
      \c{A}`
      \rho^{-1}`
      \w{A}\otimes id_{!A}`
      id_{!A}\otimes\w{A}]
    \efig
    \end{mathpar}

  \item $\w{A}$ and $\c{A}$ are coalgebra morphisms, i.e. the
    following diagrams commute;
    \begin{mathpar}
    \bfig
      \square/->`->`->`->/<1000,500>[
      !A`
      I`
      !!A`
      !I;
      \w{A}`
      \delta{A}`
      \q{I}`
      !\w{A}]
    \efig
    \end{mathpar}
    \begin{mathpar}
    \bfig
      \square/->`->``/<1050,400>[
        !A`
        !A\otimes !A`
        !!A`;
        \c{A}`
        \delta_A``]
      \square(1050,0)/->``->`/<1050,400>[
        !A\otimes !A`
        !!A\otimes !!A``
        !(!A\otimes !A);
        \delta_A\otimes\delta_A``
        \q{!A,!A}`]
        \morphism(0,0)|b|<2100,0>[!!A`!(!A\otimes !A);!\c{A}]
    \efig
    \end{mathpar}

  \item any coalgebra morphism $f:(!A,\delta_A)\mto (!B,\delta_B)$
    between free coalgebras preserve the comonoid structure given
    by $\w{}$ and $\c{}$, i.e. the following diagrams commute.
    \begin{mathpar}
    \bfig
      \Vtriangle/->`->`->/<600,400>[
        !A`
        !B`
        I;
        f`
        \w{A}`
        \w{B}]
    \efig
    \and
    \bfig
      \square/->`->`->`->/<800,400>[
      !A`
      !A\otimes !A`
      !B`
      !B\otimes !B;
      \c{A}`
      f`
      f\otimes f`
      \c{B}]
    \efig
    \end{mathpar}

  \end{itemize}
\end{definition}

\begin{definition}
  \label{def:dist}
  Given two comonads $(c,\varepsilon^c,\delta^c)$ and
  $(w,\varepsilon^w,\delta^w)$ on a category $\cat{L}$ such that
  $(\cat{L},c,\cL{},\cR{})$ is a Lambek category with contraction and
  $(\cat{L},w,\w{})$ is a Lambek category with weakening, we define a
  \textbf{distributive law} of $c$ over $w$ to be a natural
  transformation with components $dist_A:cwA\mto wcA$, subject to the
  following coherence diagrams:
  \begin{mathpar}
    \bfig
      \Vtriangle/<-`<-`->/<500,400>[
        wA`cwA`wcA;
        \varepsilon_{wA}^c`w\varepsilon_A^c`dist_A]
    \efig
    \and
    \bfig
      \Vtriangle/<-`<-`->/<500,400>[
        cA`cwA`wcA;
        c\varepsilon_A^w`\varepsilon_{cA}^w`dist_A]
    \efig
  \end{mathpar}
  \begin{mathpar}
    \bfig
      \square/->`->``->/<500,800>[
        cwA`c^2wA`wcA`wc^2A;
        \delta^c_{wA}`dist_A``w\delta^c_A]
      \morphism(500,800)<0,-400>[c^2wA`cwcA;cdist_A]
      \morphism(500,400)<0,-400>[cwcA`wc^2A;dist_{cA}]
    \efig
    \and
    \bfig
      \square/->`->``->/<500,800>[
        cwA`cw^2A`wcA`w^2cA;
        c\delta^w_A`dist_A``\delta^w_{cA}]
      \morphism(500,800)<0,-400>[cw^2A`wcwA;dist_{wA}]
      \morphism(500,400)<0,-400>[wcwA`w^2cA;wdist_A]
    \efig
  \end{mathpar}
\end{definition}

\begin{lemma}
  \label{lem:dist}
  Given two comonads $(c,\varepsilon^c,\delta^c)$ and
  $(w,\varepsilon^w,\delta^w)$ on a category $\cat{L}$ such that
  $(\cat{L},c,\cL{},\cR{})$ is a Lambek category with contraction and
  $(\cat{L},w,\w{})$ is a Lambek category with weakening, the following
  two diagrams commute:
  \begin{mathpar}
  \bfig
    \Vtriangle/->`->`<-/<500,400>[
      cwcA`
      cwc^2A`
      c^2wcA;
      cw\delta_A^c`
      \delta_{wcA}^c`
      cdist_{cA}]
  \efig
  \and
  \bfig
    \Vtriangle/->`->`->/<500,400>[
      wcwA`
      wcw^2A`
      w^2cwA;
      wc\delta_A^w`
      \delta_{cwA}^w`
      wdist_{wA}]
  \efig
  \end{mathpar}
\end{lemma}

\begin{proof}
  The two diagrams above commute because the following ones commute by the
  distributive law and the comonad laws for $c$ and $w$.
  \begin{mathpar}
  \bfig
    \Vtriangle|amm|/->`=`->/<600,300>[
      cwcA`
      cwc^2A`
      cwcA;
      cw\delta_A^c``
      cw\varepsilon_{cA}^c]
    \morphism(0,300)|b|<600,-700>[cwcA`c^2wcA;\delta_{wA}^c]
    \morphism(600,-400)|m|<0,400>[c^2wcA`cwcA;c\varepsilon_{wcA}^c]
    \morphism(600,-400)|b|<600,700>[c^2wcA`cwc^2A;cdist_{cA}]
  \efig
  \and
  \bfig
    \Vtriangle|amm|/->`=`->/<600,300>[
      wcwA`
      wcw^2A`
      wcwA;
      wc\delta_A^w``
      wc\varepsilon_{wA}^w]
    \morphism(0,300)|b|<600,-700>[wcwA`w^2cwA;\delta_{cwA}^w]
    \morphism(600,-400)|m|<0,400>[w^2cwA`wcwA;w\varepsilon_{cwA}^w]
    \morphism(1200,300)|b|<-600,-700>[wcw^2A`w^2cwA;wdist_{wA}]
  \efig
  \end{mathpar}
\end{proof}

% Lemma for composing contraction and weakening
\begin{lemma}[Composition of Weakening and Contraction]
  \label{lem:compose-cw}
  Suppose \\ $(\cat{L},I,\otimes,w,\w{}^w,c,\cL{},\cR{})$ is a Lambek
  category with weakening and contraction, where
  $(w,\varepsilon^w,\delta^w)$ and $(c,\varepsilon^c,\delta^c)$ are
  the respective monoidal comonads. Then the composition of $c$ and
  $w$ using the distributive law $dist_A:cwA\mto wcA$ is a monoidal
  comonad on $\cat{L}$.
\end{lemma}
\begin{proof}
  For the complete proof see
  Appendix~\ref{subsec:proof_of_composition_of_weakening_and_contraction_lem:compose-cw}.
\end{proof}

% Definition: Lambek category with cw
\begin{definition}
  \label{def:Lambek-cw}
  A \textbf{Lambek category with $cw$},
  $(\cat{L},cw,\w{}^w,\cL{},\cR{}, dist)$, is a Lambek category with
  weakening and contraction, and a distributive law.  Furthermore, the
  following coherence diagrams commute:
  \begin{mathpar}
    \bfig
      \square|amma|/->`->`<-`->/<1200,400>[
        I\otimes cwA`
        I\otimes (I\otimes cwA)`
        cwA\otimes(I\otimes cwA)`
        wA\otimes(I\otimes cwA);
        \lambda_{I\otimes cwA}^{-1}`
        \cR{wA,I}`
        \w{A}^w\otimes id_{I\otimes cwA}`
        \varepsilon_{wA}^c\otimes id_{I\otimes cwA}]
    \efig
    \and
    \bfig
      \square|amma|/->`->`<-`->/<1200,400>[
        cwA\otimes I`
        (cwA\otimes I)\otimes I`
        (cwA\otimes I)\otimes cwA`
        (cwA\otimes I)\otimes wA;
        \rho_{cwA\otimes I}^{-1}`
        \cL{wA,I}`
        id_{cwA\otimes I}\otimes\w{A}^w`
        id_{cwA\otimes I}\otimes\varepsilon_{wA}^c]
    \efig
    \and
    \bfig
    \square|amma|/->`->`->`/<1000,400>[
      cwA`
      cwB`
      wA`
      wB;
      f`
      \varepsilon_{wA}^c`
      \varepsilon_{wB}^c`]
    \morphism<500,0>[wA`I;\w{A}^w]
    \morphism(1000,0)<-500,0>[wB`I;\w{B}^w]
    \efig
  \end{mathpar}  
\iffalse
  \begin{mathpar}
  \bfig
    \Vtriangle/->`->`->/<600,400>[
      cwA`
      cwB`
      I;
      f`
      \w{A}`
      \w{B}]
  \efig
  \end{mathpar}
\fi
  where $f:(cwA,\delta_A)\mto(cwB,\delta_B)$ is any coalgebra morphism between
  free coalgebras.
\end{definition}



% Conditions for weakening and contraction
\begin{lemma}
  \label{lem:compose-cw-2}
  Let $(\cat{L},cw,\w{}^w,\cL{},\cR{})$ be a Lambek category with $cw$.
  Then the following conditions are satisfied:
  \begin{itemize}
    \item[1.] There exist two natural transformations $\w{A}:cwA\mto I$
      and $\c{A}:cwA\mto cwA\otimes cwA$.
    \item[2.] Each $(cwA,\w{A},\c{A})$ is a comonoid.
    \item[3.] $\w{A}$ and $\c{A}$ are coalgebra morphisms.
    \item[4.] Any coalgebra morphism $f:(cwA,\delta_A)\mto(cwB,\delta_B)$
      between free coalgebras preserves the comonoid structure given by
      $\w{}$ and $\c{}$.
  \end{itemize}
\end{lemma}

\begin{proof}
  We will only prove the first condition by defining $\w{}$ and $\c{}$. For the complete proof see
  Appendix~\ref{subsec:proof_of_conditions_of_lambek_with_cw_lem:compose-cw-2}.
    Each of $\w{}$ and $\c{}$can be given two equivalent definitions.
    $\w{A}:cwA\mto I$ is defined as in the diagram below. The left
    triangle commutes by the definition of $dist$ and the right triangle
    commutes by the definition of $\w{}^w$.
    \begin{mathpar}
    \bfig
    \Atrianglepair/<-`->`->`->`->/<600,400>[
      wcA`
      cwA`
      wA`
      I;
      dist_A`
      w\varepsilon_A^c`
      \w{cA}^w`
      \varepsilon_{wA}^c`
      \w{A}^w]
    \efig
    \end{mathpar}

    $\c{A}:cwA\mto cwA\otimes cwA$ is defined as below. The left part of
    the diagram commutes by the definitions of $\cL{}$ and of $\cR{}$, and
    the right part commutes because $\cat{L}$ is monoidal.
    \begin{mathpar}
      \bfig
      \square/->`->``->/<1050,400>[
        cwA`
        cwA\otimes I`
        I\otimes cwA`
        cwA\otimes(I\otimes cwA);
        \rho_{cwA}^{-1}`
        \lambda_{cwA}^{-1}``
        \cR{wA,I}]
      \ptriangle(1050,0)/->``/<1050,400>[
        cwA\otimes I`
        (cwA\otimes I)\otimes cwA`
        cwA\otimes(I\otimes cwA);
        \cL{wA,I}``]
      \dtriangle(1050,0)|mrb|/->`->`->/<1050,400>[
        (cwA\otimes I)\otimes cwA`
        cwA\otimes(I\otimes cwA)`
        cwA\otimes cwA;
        \alpha_{cwA,I,cwA}`
        \rho_{cwA}\otimes id_{cwA}`
        id_{cwA}\otimes\lambda_{cwA}]
      \efig
    \end{mathpar}
\end{proof}


% Definition: distributive law for exchange
\begin{definition}
  \label{def:distEx}
  Given two comonads $(cw,\varepsilon^{cw},\delta^{cw})$ and
  $(e,\varepsilon^e,\delta^e)$ on a category $\cat{L}$ such that
  $(\cat{L},cw,\w{},\c{})$ is a Lambek category with $cw$ and
  $(\cat{L},e,\e{})$ is a Lambek category with exchange, we define a
  \textbf{distributive law for exchange} of $cw$ over $e$ to be a natural
  isomorphism with components $distEx_A:cweA\mto ecwA$, subject to the
  following coherence diagrams:
  \begin{mathpar}
    \bfig
      \Vtriangle/<-`<-`->/<500,400>[
        eA`
        cweA`
        ecwA;
        \varepsilon_{eA}^{cw}`
        e\varepsilon_A^{cw}`
        distEx_A]
    \efig
    \and
    \bfig
      \Vtriangle/<-`<-`->/<500,400>[
        cwA`
        cweA`
        ecwA;
        cw\varepsilon_A^e`
        \varepsilon_{cwA}^e`
        distEx_A]
    \efig
  \end{mathpar}
\end{definition}

\begin{lemma}
  \label{lem:distEx}
  Given two comonads $(cw,\varepsilon^{cw},\delta^{cw})$ and
  $(e,\varepsilon^e,\delta^e)$ on a category $\cat{L}$ such that
  $(\cat{L},cw,\w{},\c{})$ is a Lambek category with $cw$ and
  $(\cat{L},e,\e{})$ is a Lambek category with exchange, the following
  two digrams also commute:
  \begin{mathpar}
  \bfig
    \Vtriangle/->`->`<-/<500,400>[
      cwecwA`
      cwe(cw)^2A`
      (cw)^2ecwA;
      cwe\delta_A^{cw}`
      \delta_{cweA}^{cw}`
      cwdistEx_{cwA}]
  \efig
  \and
  \bfig
    \Vtriangle/->`->`->/<500,400>[
      ecweA`
      ecwe^2A`
      e^2cweA;
      ecw\delta_A^e`
      \delta_{cweA}^e`
      edistEx_{eA}]
  \efig
  \end{mathpar}
\end{lemma}

  The proof is similar with the proof of Lemma~\ref{lem:dist} and we will
  not elaborate it here. Also, notice the difference between $dist$ of $c$
  over $w$ and $distEx$ of $cw$ over $e$. While $dist$ is a natural
  transformation, $distEx$ is a natural isomorphism.


% Lemma: cwe is a monoidal comonad
\begin{lemma}
  \label{lem:compose-cwe}
  let $(cw,\varepsilon^{cw},\delta^{cw})$ and $(e,\varepsilon^e,\delta^e)$
  be two monoidal comonads on a Lambek category with $cw$ and exchange
  $(\cat{L},I,\otimes,cw,\w{},\c{},e,\e{})$. Then the composition of $cw$
  and $e$ using the distributive law for exchange $distEx_A:cweA\mto ecwA$
  is a monoidal comonad $(cwe,\varepsilon,\delta)$ on $\cat{L}$.
\end{lemma}

\begin{proof}
  Suppose $(cw,\varepsilon^{cw},\delta^{cw})$ and
  $(e,\varepsilon^e,\delta^e)$ are monoidal comonads, and \\
  $(\cat{L},I,\otimes,cw,\w{},\c{},e,\e{})$ is a
  Lambek category with $cw$ and exchange. Since by definition
  $cw,e:\cat{L}\mto\cat{L}$ are monoidal functors, we know that their
  composition \\
  $cwe:\cat{L}\mto\cat{L}$ is a monoidal functor:
  \begin{align*}
    \q{A,B} &: cweA\otimes cweB\mto cwe(A\otimes B)   \\
    \q{A,B} &= cw\q{A,B}^e\circ\q{eA,eB}^{cw}         \\
    \q{I}   &: I\mto cweI                             \\
    \q{I}   &= cw\q{I}^e\circ\q{I}^{cw}
  \end{align*}
  Analogous to the proof of Lemma~\ref{lem:compose-cw}, each of
  $\varepsilon$ and $\delta$ can be given two equivalent definitions:
  \begin{mathpar}
  \bfig
    \square<800,400>[
      cweA`
      eA`
      cwA`
      A;
      \varepsilon_{eA}^{cw}`
      cw\varepsilon_A^e`
      \varepsilon_A^e`
      \varepsilon_A^{cw}]
  \efig
  \and
  \bfig
    \square|almb|/->`->`->`->/<800,500>[
      cweA`
      cwe^2A`
      (cw)^2eA`
      (cw)^2e^2A;
      cw\delta_A^e`
      \delta_{eA}^{cw}`
      \delta_{e^2A}^{cw}`
      (cw)^2\delta_A^e]
    \square(800,0)|amrb|/->``->`->/<800,500>[
      cwe^2A`
      (cw)^2e^2A`
      (cw)^2e^2A`
      cwecweA;
      \delta_{e^2A}^{cw}``
      cwdist_{eA}`
      cwdist_{eA}]
  \efig
  \end{mathpar}
  And the comonad laws can be proved similarly, which we will not elaborate
  for simplicity.
\end{proof}

% Eilenberg Moore category of cwe
\begin{definition}
  \label{def:eilenberg-moore-cwe}
  Suppose $(\cat{L},cwe,\w{},\c{},\e{})$ is a Lambek category with
  contraction, weakening and exchange. Then the Eilenberg Moore category,
  $\cat{L}^{cwe}$, of the comonad $(cwe,\varepsilon,\delta)$ has as objects
  all the $cwe$-coalgebras $(A,h_A:A\mto cweA)$, and as morphisms all the
  coalgebra morphisms. Futhermore, the following (action) diagrams commute:
  \begin{mathpar}
    \bfig
    \square[A`eA`eA`e^2A;h_A`h_A`eh_A`\delta_A]    
    \efig
    \and
    \bfig
    \btriangle/->`=`->/[A`eA`A;h_A``\varepsilon_A]
    \efig
  \end{mathpar}
\end{definition}

% L^{cwe} is a linear category
\begin{lemma}[The Eilenberg-Moore Category of the comonad $cwe$ is a linear category]
  \label{lem:eilenberg-moore-cwe-linear}
  The category $\cat{L}^{cwe}$ is a linear category.
\end{lemma}
\begin{proof}
  \begin{enumerate}
  \item $\cat{L}^{cwe}$ is a symmetric monoidal cloased category.

    Similar as the proofs for
    Lemmas~\ref{lemma:the_eilenberg_moore_category_is_monoidal} and
    \ref{lemma:the_eilenberg-moore_category_is_symmetric_monoidal},
    $\cat{L}^{cwe}$ is symmetric monoidal. The symmetry
    $\beta_{A,B}:A\otimes B\mto B\otimes A$ is also defined similarly as:
    \begin{center}
    \begin{math}
      \beta_{A,B} := A \otimes B \mto^{h_A \otimes h_B} eA \otimes eB \mto^{ex_{A,B}} eB \otimes eA \mto^{\varepsilon_B \otimes \varepsilon_A} B \otimes A
    \end{math}
    \end{center}

  \item $(cwe,\varepsilon,\delta)$ is a symmetric monoidal comonad.
    
    Lemma~\ref{lem:compose-cwe} has shown that $cwe$ is a monoidal comonad.

    To prove it is also symmetric, we first define a natural transformation
    $\e{A,B}^{cwe}:cweA\otimes cweB\mto cweB\otimes cweA$ as follows:
    \begin{center}
    \begin{math}
      \e{A,B}^{cwe} := cweA\otimes cweB \mto^{distEx_A\otimes distEx_B} ecwA\otimes ecwB \mto^{\e{cwA,cwB}} ecwB\otimes ecwA \mto^{distEx_B^{-1}\otimes distEx_A^{-1}} cweB\otimes cweA
    \end{math}
    \end{center}

    Then $\cat{L}^{cwe}$ is symmetric because the following diagram commutes
    \begin{mathpar}
    \bfig \square<900,400>[
        cweA\otimes cweB`cweB\otimes cweA`cwe(A\otimes B)`cwe(B\otimes A);
        \e{A,B}^{cwe}`\q{A,B}`\q{B,A}`cwe\beta_{A,B}]
    \efig
    \end{mathpar}
    by the diagram chasing below:
    \begin{mathpar}
    \bfig
      \Vtriangle|amm|<600,400>[
        cweA\otimes cweB`ecwA\otimes ecwB`eA\otimes eB;
        distEx_A\otimes distEx_B`
        \varepsilon_{eA}^{cw}\otimes\varepsilon_{eB}^{cw}`
        e\varepsilon_A^{cw}\otimes e\varepsilon_B^{cw}]
      \morphism(1200,400)|a|<900,0>[ecwA\otimes ecwB`ecwB\otimes ecwA;\e{cwA,cwB}]
      \Ctriangle(1400,-400)|mrm|/->`->`<-/<700,400>[
        ecwB\otimes ecwA`eB\otimes eA`cweB\otimes cweA;
        e\varepsilon_B^{cw}\otimes e\varepsilon_A^{cw}`
        distEx_B^{-1}\otimes distEx_A^{-1}`
        \varepsilon_{eB}^{cw}\otimes \varepsilon_{eA}^{cw}]
      \square(600,-400)|mmmm|<800,400>[
        eA\otimes eB`eB\otimes eA`e(A\otimes B)`e(B\otimes A);
        \e{A,B}`\q{A,B}`\q{B,A}`e\beta_{A,B}]
      \morphism(0,-800)|m|<600,400>[
        cwe(A\otimes B)`e(A\otimes B);
        \varepsilon_{e(A\otimes B)^{cw}}]
      \morphism(2100,-400)|r|<0,-400>[
        cweB\otimes cweA`cwe(B\otimes A);
        \q{B,A}]
      \morphism(2100,-800)|m|<-700,400>[
        cwe(B\otimes A)`e(B\otimes A);
        \varepsilon_{e(B\otimes A)}^{cw}]
      \btriangle(0,-800)/->``->/<2100,1200>[
        cweA\otimes cweB`cwe(A\otimes B)`cwe(B\otimes A);
        \q{A,B}``cwe\beta_{A,B}]
    \efig
    \end{mathpar}
    The triangle on top and the triangle on the right commute by the
    definition of $distEx$. The quadrangle on the left and the one on the
    right commute because $\q{}$ is a natural transformation. The
    quadrangle on top and the one at the bottom commute by the naturality
    of $\e{}$ and $\varepsilon^{cw}$, respectively. The square in the middle
    commutes by Corollary~\ref{corollary:ex-simple}.


  \item There are two monoidal natural transformations with components
        $\w{A}:cweA\mto I$ and $\c{A}:cweA\mto cweA\otimes cweA$.

    The natural transformations $\w{}$ and $\c{A}$ are defined as:
    \begin{center}
    \begin{math}
    \begin{array}{ll}
      \w{A} := cweA \mto^{\varepsilon_{weA}^c} weA \mto^{\w{eA}^w} I \\
      \,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,:= cweA \mto^{c\w{eA}^w} cI \mto^{\varepsilon_I^c} I \\
      \c{A} := cweA \mto^{\c{eA}^{cw}} cweA\otimes cweA
    \end{array}
    \end{math}
    \end{center}
    They are monoidal by definition.


  \item Each $(cweA,\w{A},\c{A})$ is a commutative comonoid.
    
    By Lemma~\ref{lem:compose-cw-2}, each $(cwA,\w{}^{cw},\c{}^{cw})$ is a
    comonoid in the Lambek category with $cw$. Similarly, each
    $(cweA,\w{A},\c{A})$ is a comonoid in $\cat{L}^{cwe}$. Since there is a
    symmetry $\beta$ in $\cat{L}^{cwe}$, then $\beta_A\circ\c{A}=\c{A}$. So
    each such comonoid is commutative.

  \item $\w{A}$ and $\c{A}$ are coalgebra morphisms, by similar proof as
    Lemma~\ref{lem:compose-cw-2}.
  \item Any coalgebra morphism $f:(cweA,\delta_A)\mto(cweA,\delta_B)$
    between free coalgebras preserve the comonoid structure given by
    $\w{}$ and $\c{}$, by similar proof as Lemma~\ref{lem:compose-cw-2}.
  \end{enumerate}
\end{proof}


% subsection linear_categories (end)

% section categorical_models (end)

\section{Related Work}
\label{sec:related_work}
TODO
% section related_work (end)

\section{Conclusion}
\label{sec:conclusion}
TODO
% section conclusion (end)

\bibliographystyle{plainurl} \bibliography{ref}

\appendix
\section{Appendix}
\label{sec:appendix}
\input{appendix}
% section appendix (end)

\end{document}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 

