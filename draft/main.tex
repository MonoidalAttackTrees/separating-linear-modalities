\documentclass{article}
\usepackage{amssymb,amsmath}
\usepackage{amsthm}
\usepackage{cmll}
\usepackage{txfonts}
\usepackage{graphicx}
\usepackage{stmaryrd}
\usepackage{todonotes}
\usepackage{mathpartir}
\usepackage{hyperref}
\usepackage{mdframed}
\usepackage[barr]{xy}
\usepackage{comment}
\usepackage{graphicx}
\usepackage{enumitem}

\usepackage{caption}
\captionsetup[figure]{name=Diagram}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{example}[theorem]{Example}

%% This renames Barr's \to to \mto.  This allows us to use \to for imp
%% and \mto for a inline morphism.
\let\mto\to
\let\to\relax
\newcommand{\to}{\rightarrow}
\newcommand{\ndto}[1]{\to_{#1}}
\newcommand{\ndwedge}[1]{\wedge_{#1}}

% Commands that are useful for writing about type theory and programming language design.
%% \newcommand{\case}[4]{\text{case}\ #1\ \text{of}\ #2\text{.}#3\text{,}#2\text{.}#4}
\newcommand{\interp}[1]{\llbracket #1 \rrbracket}
\newcommand{\normto}[0]{\rightsquigarrow^{!}}
\newcommand{\join}[0]{\downarrow}
\newcommand{\redto}[0]{\rightsquigarrow}
\newcommand{\nat}[0]{\mathbb{N}}
\newcommand{\fun}[2]{\lambda #1.#2}
\newcommand{\CRI}[0]{\text{CR-Norm}}
\newcommand{\CRII}[0]{\text{CR-Pres}}
\newcommand{\CRIII}[0]{\text{CR-Prog}}
\newcommand{\subexp}[0]{\sqsubseteq}
%% Must include \usepackage{mathrsfs} for this to work.

\date{}

\let\b\relax
\let\d\relax
\let\t\relax
\let\r\relax
\let\c\relax
\let\j\relax
\let\wn\relax
\let\H\relax

% Cat commands.
\newcommand{\powerset}[1]{\mathcal{P}(#1)}
\newcommand{\cat}[1]{\mathcal{#1}}
\newcommand{\func}[1]{\mathsf{#1}}
\newcommand{\iso}[0]{\mathsf{iso}}
\newcommand{\H}[0]{\func{H}}
\newcommand{\J}[0]{\func{J}}
\newcommand{\catop}[1]{\cat{#1}^{\mathsf{op}}}
\newcommand{\Hom}[3]{\mathsf{Hom}_{\cat{#1}}(#2,#3)}
\newcommand{\limp}[0]{\multimap}
\newcommand{\colimp}[0]{\multimapdotinv}
\newcommand{\dial}[1]{\mathsf{Dial_{#1}}(\mathsf{Sets^{op}})}
\newcommand{\dialSets}[1]{\mathsf{Dial_{#1}}(\mathsf{Sets})}
\newcommand{\dcSets}[1]{\mathsf{DC_{#1}}(\mathsf{Sets})}
\newcommand{\sets}[0]{\mathsf{Sets}}
\newcommand{\obj}[1]{\mathsf{Obj}(#1)}
\newcommand{\mor}[1]{\mathsf{Mor(#1)}}
\newcommand{\id}[0]{\mathsf{id}}
\newcommand{\lett}[0]{\mathsf{let}\,}
\newcommand{\inn}[0]{\,\mathsf{in}\,}
\newcommand{\cur}[1]{\mathsf{cur}(#1)}
\newcommand{\curi}[1]{\mathsf{cur}^{-1}(#1)}

\newcommand{\w}[1]{\mathsf{weak}_{#1}}
\newcommand{\c}[1]{\mathsf{contra}_{#1}}
\newcommand{\cL}[1]{\mathsf{contraL}_{#1}}
\newcommand{\cR}[1]{\mathsf{contraR}_{#1}}
\newcommand{\e}[1]{\mathsf{ex}_{#1}}

\newcommand{\m}[1]{\mathsf{m}_{#1}}
\newcommand{\n}[1]{\mathsf{n}_{#1}}
\newcommand{\b}[1]{\mathsf{b}_{#1}}
\newcommand{\d}[1]{\mathsf{d}_{#1}}
\newcommand{\h}[1]{\mathsf{h}_{#1}}
\newcommand{\p}[1]{\mathsf{p}_{#1}}
\newcommand{\q}[1]{\mathsf{q}_{#1}}
\newcommand{\t}[0]{\mathsf{t}}
\newcommand{\r}[1]{\mathsf{r}_{#1}}
\newcommand{\s}[1]{\mathsf{s}_{#1}}
\newcommand{\j}[1]{\mathsf{j}_{#1}}
\newcommand{\jinv}[1]{\mathsf{j}^{-1}_{#1}}
\newcommand{\wn}[0]{\mathop{?}}
\newcommand{\codiag}[1]{\bigtriangledown_{#1}}

\newenvironment{changemargin}[2]{%
  \begin{list}{}{%
    \setlength{\topsep}{0pt}%
    \setlength{\leftmargin}{#1}%
    \setlength{\rightmargin}{#2}%
    \setlength{\listparindent}{\parindent}%
    \setlength{\itemindent}{\parindent}%
    \setlength{\parsep}{\parskip}%
  }%
  \item[]}{\end{list}}

\newenvironment{diagram}{
  \begin{center}
    \begin{math}
      \bfig
}{
      \efig
    \end{math}
  \end{center}
}

%% %% Ott
%% \input{BiLNL-inc}

\urldef{\mailsa}\path|{heades}@augusta.edu|

\begin{document}

\title{Separating Linear Modalities}
\author{Jiaming Jiang and Harley Eades III}
\date{}

\maketitle 

\begin{abstract}

  TODO

\end{abstract}

\section{Introduction}
\label{sec:introduction}
TODO \cite{Benton:1994}
% section introduction (end)

\subsection{Symmetric Monoidal Categories}
\label{subsec:symmetric_monoidal_categories}

\begin{definition}
  \label{def:monoidal-category}
  A \textbf{monoidal category} is a category, $\cat{M}$,
  with the following data:
  \begin{itemize}
  \item An object $\top$ of $\cat{M}$,
  \item A bi-functor $\otimes : \cat{M} \times \cat{M} \mto \cat{M}$,
  \item The following natural isomorphisms:
    \[
    \begin{array}{lll}
      \lambda_A : \top \otimes A \mto A\\
      \rho_A : A \otimes \top \mto A\\      
      \alpha_{A,B,C} : (A \otimes B) \otimes C \mto A \otimes (B \otimes C)\\
    \end{array}
    \]
  \item Subject to the following coherence diagrams:
    \begin{mathpar}
      \bfig
      \vSquares|ammmmma|/->`->```->``<-/[
        ((A \otimes B) \otimes C) \otimes D`
        (A \otimes (B \otimes C)) \otimes D`
        (A \otimes B) \otimes (C \otimes D)``
        A \otimes (B \otimes (C \otimes D))`
        A \otimes ((B \otimes C) \otimes D);
        \alpha_{A,B,C} \otimes \id_D`
        \alpha_{A \otimes B,C,D}```
        \alpha_{A,B,C \otimes D}``
        \id_A \otimes \alpha_{B,C,D}]      
      
      \morphism(1185,1000)|m|<0,-1000>[
        (A \otimes (B \otimes C)) \otimes D`
        A \otimes ((B \otimes C) \otimes D);
        \alpha_{A,B \otimes C,D}]
      \efig
    \end{mathpar}
    \begin{mathpar}
      \bfig
      \Vtriangle[
        (A \otimes \top) \otimes B`
        A \otimes (\top \otimes B)`
        A \otimes B;
        \alpha_{A,\top,B}`
        \rho_{A}\otimes id_B`
        id_A\otimes\lambda_{B}]
      \efig
    \end{mathpar}
  \end{itemize}
\end{definition}

\begin{definition}
  \label{def:sym-monoidal-category}
  A \textbf{symmetric monoidal category (SMC)} is a category, $\cat{M}$,
  with the following data:
  \begin{itemize}
  \item An object $\top$ of $\cat{M}$,
  \item A bi-functor $\otimes : \cat{M} \times \cat{M} \mto \cat{M}$,
  \item The following natural isomorphisms:
    \[
    \begin{array}{lll}
      \lambda_A : \top \otimes A \mto A\\
      \rho_A : A \otimes \top \mto A\\      
      \alpha_{A,B,C} : (A \otimes B) \otimes C \mto A \otimes (B \otimes C)\\
    \end{array}
    \]
  \item A symmetry natural transformation:
    \[
    \beta_{A,B} : A \otimes B \mto B \otimes A
    \]
  \item Subject to the following coherence diagrams:
    \begin{mathpar}
      \bfig
      \vSquares|ammmmma|/->`->```->``<-/[
        ((A \otimes B) \otimes C) \otimes D`
        (A \otimes (B \otimes C)) \otimes D`
        (A \otimes B) \otimes (C \otimes D)``
        A \otimes (B \otimes (C \otimes D))`
        A \otimes ((B \otimes C) \otimes D);
        \alpha_{A,B,C} \otimes \id_D`
        \alpha_{A \otimes B,C,D}```
        \alpha_{A,B,C \otimes D}``
        \id_A \otimes \alpha_{B,C,D}]      
      
      \morphism(1185,1000)|m|<0,-1000>[
        (A \otimes (B \otimes C)) \otimes D`
        A \otimes ((B \otimes C) \otimes D);
        \alpha_{A,B \otimes C,D}]
      \efig
      \and
      \bfig
      \hSquares|aammmaa|/->`->`->``->`->`->/[
        (A \otimes B) \otimes C`
        A \otimes (B \otimes C)`
        (B \otimes C) \otimes A`
        (B \otimes A) \otimes C`
        B \otimes (A \otimes C)`
        B \otimes (C \otimes A);
        \alpha_{A,B,C}`
        \beta_{A,B \otimes C}`
        \beta_{A,B} \otimes \id_C``
        \alpha_{B,C,A}`
        \alpha_{B,A,C}`
        \id_B \otimes \beta_{A,C}]
      \efig      
    \end{mathpar}
    \begin{mathpar}
      \bfig
      \Vtriangle[
        (A \otimes \top) \otimes B`
        A \otimes (\top \otimes B)`
        A \otimes B;
        \alpha_{A,\top,B}`
        \rho_{A}\otimes id_B`
        id_A\otimes\lambda_{B}]
      \efig
      \and
      \bfig
      \btriangle[
        A \otimes B`
        B \otimes A`
        A \otimes B;
        \beta_{A,B}`
        \id_{A \otimes B}`
        \beta_{B,A}]
      \efig
      \and
      \bfig
      \Vtriangle[
        \top \otimes A`
        A \otimes \top`
        A;
        \beta_{\top,A}`
        \lambda_A`
        \rho_A]
      \efig
    \end{mathpar}    
  \end{itemize}
\end{definition}

\begin{definition}
  \label{def:SMCC}
  A \textbf{symmetric monoidal closed category (SMCC)} is a symmetric
  monoidal category, $(\cat{M},\top,\otimes)$, such that, for any object
  $B$ of $\cat{M}$, the functor $- \otimes B : \cat{M} \mto \cat{M}$
  has a specified right adjoint.  Hence, for any objects $A$ and $C$
  of $\cat{M}$ there is an object $B \limp C$ of $\cat{M}$ and a
  natural bijection:
  \[
  \Hom{\cat{M}}{A \otimes B}{C} \cong \Hom{\cat{M}}{A}{B \limp C}
  \]
  We call the functor $\limp : \cat{M} \times \cat{M} \mto \cat{M}$
  the internal hom of $\cat{M}$.
\end{definition}

\begin{definition}
  \label{def:MCFUN}
  Suppose we are given two monoidal categories
  $(\cat{M}_1,\top_1,\otimes_1,\alpha_1,\lambda_1,\rho_1,\beta_1)$ and
  $(\cat{M}_2,\top_2,\otimes_2,\alpha_2,\lambda_2,\rho_2,\beta_2)$.  Then a
  \textbf{monoidal functor} is a functor $F : \cat{M}_1 \mto
  \cat{M}_2$, a map $m_{\top_1} : \top_2 \mto F\top_1$ and a natural transformation
  $m_{A,B} : FA \otimes_2 FB \mto F(A \otimes_1 B)$ subject to the
  following coherence conditions:
  \begin{mathpar}
    \bfig
    \vSquares|ammmmma|/->`->`->``->`->`->/[
      (FA \otimes_2 FB) \otimes_2 FC`
      FA \otimes_2 (FB \otimes_2 FC)`
      F(A \otimes_1 B) \otimes_2 FC`
      FA \otimes_2 F(B \otimes_1 C)`
      F((A \otimes_1 B) \otimes_1 C)`
      F(A \otimes_1 (B \otimes_1 C));
      {\alpha_2}_{FA,FB,FC}`
      m_{A,B} \otimes \id_{FC}`
      \id_{FA} \otimes m_{B,C}``
      m_{A \otimes_1 B,C}`
      m_{A,B \otimes_1 C}`
      F{\alpha_1}_{A,B,C}]
    \efig
    \end{mathpar}
  \begin{mathpar}
    \bfig
    \square|amma|/->`->`<-`->/<1000,500>[
      \top_2 \otimes_2 FA`
      FA`
      F\top_1 \otimes_2 FA`
      F(\top_1 \otimes_1 A);
      {\lambda_2}_{FA}`
      m_{\top_1} \otimes \id_{FA}`
      F{\lambda_1}_{A}`
      m_{\top_1,A}]
    \efig
    \and
    \bfig
    \square|amma|/->`->`<-`->/<1000,500>[
      FA \otimes_2 \top_2`
      FA`
      FA \otimes_2 F\top_1`
      F(A \otimes_1 \top_1);
      {\rho_2}_{FA}`
      \id_{FA} \otimes m_{\top_1}`
      F{\rho_1}_{A}`
      m_{A,\top_1}]
    \efig
    \end{mathpar}
  Need to notice that the composition of monoidal functors is also monoidal,
  subject to the above coherence conditions.

\end{definition}

\begin{definition}
  \label{def:SMCFUN}
  Suppose we are given two symmetric monoidal closed categories\\
  $(\cat{M}_1,\top_1,\otimes_1,\alpha_1,\lambda_1,\rho_1,\beta_1)$ and
  $(\cat{M}_2,\top_2,\otimes_2,\alpha_2,\lambda_2,\rho_2,\beta_2)$.  Then a
  \textbf{symmetric monoidal functor} is a functor $F : \cat{M}_1 \mto
  \cat{M}_2$, a map $m_{\top_1} : \top_2 \mto F\top_1$ and a natural
  transformation $m_{A,B} : FA \otimes_2 FB \mto F(A \otimes_1 B)$ subject
  to the following coherence conditions:
  \begin{mathpar}
    \bfig
    \vSquares|ammmmma|/->`->`->``->`->`->/[
      (FA \otimes_2 FB) \otimes_2 FC`
      FA \otimes_2 (FB \otimes_2 FC)`
      F(A \otimes_1 B) \otimes_2 FC`
      FA \otimes_2 F(B \otimes_1 C)`
      F((A \otimes_1 B) \otimes_1 C)`
      F(A \otimes_1 (B \otimes_1 C));
      {\alpha_2}_{FA,FB,FC}`
      m_{A,B} \otimes \id_{FC}`
      \id_{FA} \otimes m_{B,C}``
      m_{A \otimes_1 B,C}`
      m_{A,B \otimes_1 C}`
      F{\alpha_1}_{A,B,C}]
    \efig
    \end{mathpar}
%    \and
\begin{mathpar}
    \bfig
    \square/->`->`<-`->/<1000,500>[
      \top_2 \otimes_2 FA`
      FA`
      F\top_1 \otimes_2 FA`
      F(\top_1 \otimes_1 A);
      {\lambda_2}_{FA}`
      m_{\top_1} \otimes \id_{FA}`
      F{\lambda_1}_{A}`
      m_{\top_1,A}]
    \efig
    \and
    \bfig
    \square/->`->`<-`->/<1000,500>[
      FA \otimes_2 \top_2`
      FA`
      FA \otimes_2 F\top_1`
      F(A \otimes_1 \top_1);
      {\rho_2}_{FA}`
      \id_{FA} \otimes m_{\top_1}`
      F{\rho_1}_{A}`
      m_{A,\top_1}]
    \efig
     \end{mathpar}
     
      \begin{mathpar}
    \bfig
    \square/->`->`->`->/<1000,500>[
      FA \otimes_2 FB`
      FB \otimes_2 FA`
      F(A \otimes_1 B)`
      F(B \otimes_1 A);
      {\beta_2}_{FA,FB}`
      m_{A,B}`
      m_{B,A}`
      F{\beta_1}_{A,B}]
    \efig
  \end{mathpar}
\end{definition}

\begin{definition}
  \label{def:MCNAT}
  Suppose $(\cat{M}_1,\top_1,\otimes_1)$ and $(\cat{M}_2,\top_2,\otimes_2)$
  are monoidal categories, and $(F,m)$ and $(G,n)$ are monoidal functors
  between $\cat{M}_1$ and $\cat{M}_2$.  Then a \textbf{
    monoidal natural transformation} is a natural transformation,
  $f : F \mto G$, subject to the following coherence diagrams:
  \begin{mathpar}
    \bfig
    \square<1000,500>[
      FA \otimes_2 FB`
      F(A \otimes_1 B)`
      GA \otimes_2 GB`
      G(A \otimes_1 B);
      m_{A,B}`
      f_A \otimes_2 f_B`
      f_{A \otimes_1 B}`
      n_{A,B}]
    \efig
    \and
    \bfig
    \Vtriangle/->`<-`<-/[
      F\top_1`
      G\top_1`
      \top_2;
      f_{\top_1}`
      m_{\top_1}`
      n_{\top_1}]
    \efig
  \end{mathpar}  
\end{definition}

\begin{definition}
  \label{def:SMCNAT}
  Suppose $(\cat{M}_1,\top_1,\otimes_1)$ and $(\cat{M}_2,\top_2,\otimes_2)$
  are SMCs, and $(F,m)$ and $(G,n)$ are symmetric monoidal functors
  between $\cat{M}_1$ and $\cat{M}_2$.  Then a \textbf{symmetric
    monoidal natural transformation} is a natural transformation,
  $f : F \mto G$, subject to the following coherence diagrams:
  \begin{mathpar}
    \bfig
    \square<1000,500>[
      FA \otimes_2 FB`
      F(A \otimes_1 B)`
      GA \otimes_2 GB`
      G(A \otimes_1 B);
      m_{A,B}`
      f_A \otimes_2 f_B`
      f_{A \otimes_1 B}`
      n_{A,B}]
    \efig
    \and
    \bfig
    \Vtriangle/->`<-`<-/[
      F\top_1`
      G\top_1`
      \top_2;
      f_{\top_1}`
      m_{\top_1}`
      n_{\top_1}]
    \efig
  \end{mathpar}  
\end{definition}

\begin{definition}
  \label{def:MCADJ}
  Suppose $(\cat{M}_1,\top_1,\otimes_1)$ and $(\cat{M}_2,\top_2,\otimes_2)$
  are monoidal categories, and $(F,m)$ is a monoidal functor between
  $\cat{M}_1$ and $\cat{M}_2$ and $(G,n)$ is a monoidal
  functor between $\cat{M}_2$ and $\cat{M}_1$.  Then a
  \textbf{monoidal adjunction} is an ordinary adjunction
  $\cat{M}_1 : F \dashv G : \cat{M}_2$ such that the unit,
  $\eta_A : A \to GFA$, and the counit, $\varepsilon_A : FGA \to A$, are
  monoidal natural transformations.  Thus, the following
  diagrams must commute:
  \begin{mathpar}
    \bfig
    \square/->`->`->`<-/<1000,500>[
      FGA \otimes_2 FGB`
      F(GA \otimes_1 GB)`
      A \otimes_2 B`
      FGA \otimes_2 FGB;
      m_{GA,GB}`
      \varepsilon_A \otimes_1 \varepsilon_B`
      Fn_{A,B}`
      \varepsilon_{A \otimes_1 B}]
    \efig
    \and
    \bfig
    %% \Vtriangle|amm|/->`<-`=/[
    %%   FG\top_1`
    %%   \top_1`
    %%   \top_1;
    %%   \varepsilon_{\top_1}`
    %%   \q{\top_1}`]
    \square/->`<-`->`=/<1000,500>[
      F\top_1`
      FG\top_2`
      \top_2`
      \top_2;
      Fn_{\top_2}`
      m_{\top_1}`
      \varepsilon_{\top_1}`]    
    \efig
    \and
    \bfig
    %% \dtriangle|mmb|<1000,500>[
    %%   A \otimes_2 B`
    %%   GFA \otimes_2 GFB`
    %%   GF(A \otimes_2 B);
    %%   \eta_A \otimes_2 \eta_B`
    %%   \eta_{A \otimes_2 B}`
    %%   \p{A,B}]
    \square/<-`->`->`->/<1000,500>[
      GFA \otimes_1 GFB`
      A \otimes_1 B`
      G(FA \otimes_2 FB)`
      GF(A \otimes_1 B);
      \eta_A \otimes_1 \eta_B`
      n_{FA,FB}`
      \eta_{A \otimes_1 B}`
      m_{A,B}]
    \efig
    \and
    \bfig
    %% \Vtriangle|amm|/->`=`<-/[
    %%   \top_1`
    %%   GF\top_1`
    %%   \top_1;
    %%   \eta_{\top_1}``
    %%   p_{\top_1}]
    \square/->`<-`<-`=/<1000,500>[
      G\top_2`
      GF\top_1`
      \top_1`
      \top_1;
      Gm_{\top_1}`
      n_{\top_2}`
      \eta_{\top_1}`]      
    \efig
  \end{mathpar} 
\end{definition}

\begin{definition}
  \label{def:SMCADJ}
  Suppose $(\cat{M}_1,\top_1,\otimes_1)$ and $(\cat{M}_2,\top_2,\otimes_2)$
  are SMCs, and $(F,m)$ is a symmetric monoidal functor between
  $\cat{M}_1$ and $\cat{M}_2$ and $(G,n)$ is a symmetric monoidal
  functor between $\cat{M}_2$ and $\cat{M}_1$.  Then a
  \textbf{symmetric monoidal adjunction} is an ordinary adjunction
  $\cat{M}_1 : F \dashv G : \cat{M}_2$ such that the unit,
  $\eta_A : A \to GFA$, and the counit, $\varepsilon_A : FGA \to A$, are
  symmetric monoidal natural transformations.  Thus, the following
  diagrams must commute:
  \begin{mathpar}
    \bfig
    \square/->`->`->`<-/<1000,500>[
      FGA \otimes_2 FGB`
      F(GA \otimes_1 GB)`
      A \otimes_2 B`
      FGA \otimes_2 FGB;
      m_{GA,GB}`
      \varepsilon_A \otimes_1 \varepsilon_B`
      Fn_{A,B}`
      \varepsilon_{A \otimes_1 B}]
    \efig
    \and
    \bfig
    %% \Vtriangle|amm|/->`<-`=/[
    %%   FG\top_1`
    %%   \top_1`
    %%   \top_1;
    %%   \varepsilon_{\top_1}`
    %%   \q{\top_1}`]
    \square/->`<-`->`=/<1000,500>[
      F\top_1`
      FG\top_2`
      \top_2`
      \top_2;
      Fn_{\top_2}`
      m_{\top_1}`
      \varepsilon_{\top_1}`]    
    \efig
    \and
    \bfig
    %% \dtriangle|mmb|<1000,500>[
    %%   A \otimes_2 B`
    %%   GFA \otimes_2 GFB`
    %%   GF(A \otimes_2 B);
    %%   \eta_A \otimes_2 \eta_B`
    %%   \eta_{A \otimes_2 B}`
    %%   \p{A,B}]
    \square/<-`->`->`->/<1000,500>[
      GFA \otimes_1 GFB`
      A \otimes_1 B`
      G(FA \otimes_2 FB)`
      GF(A \otimes_1 B);
      \eta_A \otimes_1 \eta_B`
      n_{FA,FB}`
      \eta_{A \otimes_1 B}`
      m_{A,B}]
    \efig
    \and
    \bfig
    %% \Vtriangle|amm|/->`=`<-/[
    %%   \top_1`
    %%   GF\top_1`
    %%   \top_1;
    %%   \eta_{\top_1}``
    %%   p_{\top_1}]
    \square/->`<-`<-`=/<1000,500>[
      G\top_2`
      GF\top_1`
      \top_1`
      \top_1;
      Gm_{\top_1}`
      n_{\top_2}`
      \eta_{\top_1}`]      
    \efig
  \end{mathpar} 
\end{definition}

\begin{definition}
  \label{def:monoidal-comonad}
  A \textbf{monoidal comonad} on a monoidal
  category $\cat{C}$ is a triple $(T,\varepsilon, \delta)$, where
  $(T,\m{})$ is a monoidal endofunctor on $\cat{C}$,
  $\varepsilon_A : TA \mto A$ and $\delta_A : TA \to T^2 A$ are
  monoidal natural transformations, which make the following
  diagrams commute:
  \begin{mathpar}
    \bfig
    \square<600,600>[
      TA`
      T^2A`
      T^2A`
      T^3A;
      \delta_A`
      \delta_A`
      T\delta_A`
      \delta_{TA}]
    \efig
    \and
    \bfig
    \Atrianglepair/=`->`=`<-`->/<600,600>[
      TA`
      TA`
      T^2 A`
      TA;`
      \delta_A``
      \varepsilon_{TA}`
      T\varepsilon_A]
    \efig
  \end{mathpar}
  The assumption that $\varepsilon$ and $\delta$ are 
  monoidal natural transformations amount to the following diagrams
  commuting:
  \begin{mathpar}
    \bfig
    \qtriangle/->`->`->/<1000,600>[
      TA \otimes TB`
      T(A \otimes B)`
      A \otimes B;
      \m{A,B}`
      \varepsilon_A \otimes \varepsilon_B`
    \varepsilon_{A \otimes B}]
    \efig
    \and
    \bfig
    \Vtriangle/<-`->`=/<600,600>[
      T\top`
      \top`
      \top;
      \m{\top}`
      \varepsilon_\top`]
    \efig    
  \end{mathpar}
  \begin{mathpar}
    \bfig
    \square|alab|/`->``->/<1050,600>[
      TA \otimes TB``
      T^2A \otimes T^2B`
      T(TA \otimes TB);`
      \delta_A \otimes \delta_B``
      \m{TA,TB}]
    \square(1050,0)|mmrb|/``->`->/<1050,600>[`
      T(A \otimes B)`
      T(TA \otimes TB)`
      T^2(A \otimes B);``
      \delta_{A \otimes B}`
      T\m{A,B}]
    \morphism(0,600)<2100,0>[TA \otimes TB`T(A \otimes B);\m{A,B}]
    \efig
    \and
    \bfig
    \square<600,600>[
      \top`
      T\top`
      T\top`
      T^2\top;
      \m{\top}`
      \m{\top}`
      \delta_\top`
      T\m{\top}]
    \efig
  \end{mathpar}
\end{definition}


\begin{definition}
  \label{def:symm-monoidal-comonad}
  A \textbf{symmetric monoidal comonad} on a symmetric monoidal
  category $\cat{C}$ is a triple $(T,\varepsilon, \delta)$, where
  $(T,\m{})$ is a symmetric monoidal endofunctor on $\cat{C}$,
  $\varepsilon_A : TA \mto A$ and $\delta_A : TA \to T^2 A$ are
  symmetric monoidal natural transformations, which make the following
  diagrams commute:
  \begin{mathpar}
    \bfig
    \square<600,600>[
      TA`
      T^2A`
      T^2A`
      T^3A;
      \delta_A`
      \delta_A`
      T\delta_A`
      \delta_{TA}]
    \efig
    \and
    \bfig
    \Atrianglepair/=`->`=`<-`->/<600,600>[
      TA`
      TA`
      T^2 A`
      TA;`
      \delta_A``
      \varepsilon_{TA}`
      T\varepsilon_A]
    \efig
  \end{mathpar}
  The assumption that $\varepsilon$ and $\delta$ are symmetric
  monoidal natural transformations amount to the following diagrams
  commuting:
  \begin{mathpar}
    \bfig
    \qtriangle/->`->`->/<1000,600>[
      TA \otimes TB`
      T(A \otimes B)`
      A \otimes B;
      \m{A,B}`
      \varepsilon_A \otimes \varepsilon_B`
    \varepsilon_{A \otimes B}]
    \efig
    \and
    \bfig
    \Vtriangle/<-`->`=/<600,600>[
      T\top`
      \top`
      \top;
      \m{\top}`
      \varepsilon_\top`]
    \efig    
  \end{mathpar}
  \begin{mathpar}
    \bfig
    \square|alab|/`->``->/<1050,600>[
      TA \otimes TB``
      T^2A \otimes T^2B`
      T(TA \otimes TB);`
      \delta_A \otimes \delta_B``
      \m{TA,TB}]
    \square(1050,0)|mmrb|/``->`->/<1050,600>[`
      T(A \otimes B)`
      T(TA \otimes TB)`
      T^2(A \otimes B);``
      \delta_{A \otimes B}`
      T\m{A,B}]
    \morphism(0,600)<2100,0>[TA \otimes TB`T(A \otimes B);\m{A,B}]
    \efig
    \and
    \bfig
    \square<600,600>[
      \top`
      T\top`
      T\top`
      T^2\top;
      \m{\top}`
      \m{\top}`
      \delta_\top`
      T\m{\top}]
    \efig
  \end{mathpar}
\end{definition}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Linear Category}

\begin{definition}
  \label{def:linear-category}
  A \textbf{linear category}, $(\cat{L},!,\w{},\c{})$, is specified by
  \begin{itemize}
  \item a symmetric monoidal closed category
  	$(\cat{L},I,\otimes,\limp)$,
  \item a symmetric monoidal comonad $(!,\varepsilon,\delta)$ on
    $\cat{L}$, with $\q{A,B}:!A\otimes !B\mto !(A\otimes B)$ and
    $\q{I}:I\mto !I$;
  \item monoidal natural transformations on $\cat{L}$ with components
    $\w{A}:!A\mto I$ and\\
    $\c{A}:!A\mto !A\otimes !A$, s.t.

    \begin{itemize}
    \item each $(!A,\w{A},\c{A})$ is a commutative comonoid, i.e.
      the following diagrams commute and $\beta\circ\c{A}=\c{A}$ where
      $\beta_{B,C}:B\otimes C\mto C\otimes B$ is the symmetry natural
      transformation of $\cat{L}$;
      \begin{mathpar}
        \bfig
	\square/->`->``/<1050,600>[
	  !A`
	  !A\otimes !A`
	  !A\otimes !A`;
	  \c{A}`
	  \c{A}``]
        \square(1050,0)/->``<-`/<1050,600>[
	  !A\otimes !A`
	  !A\otimes(!A\otimes !A)``
	  (!A\otimes !A)\otimes !A;
	  id_{!A}\otimes\c{A}``
	  \alpha_{!A,!A,!A}`]
          \morphism(0,0)|b|<2100,0>[
            !A\otimes !A`
            (!A\otimes !A)\otimes !A;
            \c{A}\otimes id_{!A}]
	\efig
      \end{mathpar}
      \begin{mathpar}
      \bfig
      \Atrianglepair/->`->`->`<-`->/<800,600>[
        !A`
	I\otimes !A`
	!A\otimes !A`
	!A\otimes I;
	\lambda^{-1}`
	\c{A}`
	\rho^{-1}`
	\w{A}\otimes id_{!A}`
	id_{!A}\otimes\w{A}]
      \efig
      \end{mathpar}

    \item $\w{A}$ and $\c{A}$ are coalgebra morphisms, i.e. the
      following diagrams commute;
      \begin{mathpar}
      \bfig
        \square/->`->`->`->/<1000,500>[
	!A`
	I`
	!!A`
	!I;
	\w{A}`
	\delta{A}`
	\q{I}`
	!\w{A}]
      \efig
      \end{mathpar}
      \begin{mathpar}
      \bfig
	\square/->`->``/<1050,600>[
	  !A`
	  !A\otimes !A`
	  !!A`;
	  \c{A}`
	  \delta_A``]
        \square(1050,0)/->``->`/<1050,600>[
	  !A\otimes !A`
	  !!A\otimes !!A``
	  !(!A\otimes !A);
	  \delta_A\otimes\delta_A``
	  \q{!A,!A}`]
          \morphism(0,0)|b|<2100,0>[!!A`!(!A\otimes !A);!\c{A}]
      \efig
      \end{mathpar}

    \item any coalgebra morphism $f:(!A,\delta_A)\mto (!B,\delta_B)$
      between free coalgebras preserve the comonoid structure given
      by $\w{}$ and $\c{}$, i.e. the following diagrams commute.
      \begin{mathpar}
      \bfig
        \Vtriangle/->`->`->/<600,500>[
          !A`
          !B`
          I;
	  f`
	  \w{A}`
	  \w{B}]
      \efig
      \and
      \bfig
        \square/->`->`->`->/<1000,500>[
	!A`
	!A\otimes !A`
	!B`
	!B\otimes !B;
	\c{A}`
	f`
	f\otimes f`
	\c{B}]
      \efig
      \end{mathpar}

    \end{itemize}
  \end{itemize}
\end{definition}



\begin{definition}
  \label{def:weakening}
  A \textbf{Lambek category with weakening}, $(\cat{L},w,\w{})$, is
  specified by
  \begin{itemize}
  \item a monoidal category $(\cat{L},I,\otimes)$,
  \item a monoidal comonad $(w,\varepsilon,\delta)$ on $\cat{L}$ with
    $\q{A,B}:wA\otimes wB\mto w(A\otimes B)$ and $\q{I}:I\mto wI$, and
  \item a monoidal natural transformation $\w{}$ on $\cat{L}$ with
    components $\w{A}:wA\mto I$ s.t. the following diagrams commutes:
  \end{itemize}
  \begin{mathpar}
    \bfig
    \square/->`->`->`->/<1000,500>[
      wA`
      I`
      wwA`
      wI;
      \w{A}`
      \delta{A}`
      \q{I}`
      w\w{A}]
    \efig
  \end{mathpar}
\end{definition}



\begin{definition}
  \label{def:contraction}
  A \textbf{Lambek category with contraction}, $(\cat{L},c,\cL{},\cR{})$,
  is specified by
  \begin{itemize}
  \item a monoidal category $(\cat{L},I,\otimes)$,
  \item a monoidal comonad $(c,\varepsilon,\delta)$ on $\cat{L}$ with
    $\q{A,B}:cA\otimes cB\mto c(A\otimes B)$ and \\
    $\q{I}:I\mto cI$, and
  \item monoidal natural transformations $\cL{}$ and $\cR{}$ on $\cat{L}$
    with components \\
    $\cL{A,B}:cA\otimes B\mto (cA\otimes B)\otimes cA$ and 
    $\cR{A,B}:B\otimes cA\mto cA\otimes (B\otimes cA)$, s.t. the following
    diagrams commutes:
    \begin{mathpar}
      \bfig
      \square/<-`->``/<1050,600>[
	cA\otimes I`
        cA`
        (cA\otimes I)\otimes cA`;
	\rho_{cA}^{-1}`
	\cL{A,I}``]
      \square(1050,0)/->``->`/<1050,600>[
        cA`
        I\otimes cA``
        cA\otimes(I\otimes cA);
        \lambda_{cA}^{-1}``
	\cR{A,I}`]
        \morphism(0,0)|b|<2100,0>[(cA\otimes I)\otimes cA`cA\otimes(I\otimes cA);\alpha_{cA,I,cA}]
      \efig
    \end{mathpar}
    \todo{The following two diagrams are added to prove $(cwA,\w{A},\c{A})$
          is a comonoid, corresponding to part of the first diagram in the
          definition of linear category.}
    \begin{mathpar}
    \bfig
      \square/->`->``->/<1300,800>[
        cA\otimes cA`
        cA\otimes(cA\otimes I)`
        (I\otimes cA)\otimes cA`
        (cA\otimes(I\otimes cA))\otimes cA;
        id_{cA}\otimes\rho_{cA}^{-1}`
        \lambda_{cA}^{-1}\otimes id_{cA}``
        \cR{A,I}\otimes id_{cA}]
      \qtriangle(1300,400)/->``->/<1300,400>[
        cA\otimes(cA\otimes I)`
        cA\otimes((cA\otimes I)\otimes cA)`
        cA\otimes(cA\otimes cA);
        id_{cA}\otimes\cL{A,I}``
        id_{cA}\otimes(\rho_{cA}\otimes id_{cA})]
      \dtriangle(1300,0)/`<-`->/<1300,400>[
        cA\otimes(cA\otimes cA)`
        (cA\otimes(I\otimes cA))\otimes cA`
        (cA\otimes cA)\otimes cA;
        `
        \alpha_{cA,cA,cA}`
        (id_{cA}\otimes\lambda_{cA})\otimes id_{cA}]
    \efig
    \end{mathpar}
    \begin{mathpar}
    \bfig
      \square/->`->``->/<1300,800>[
        cA\otimes cA`
        cA\otimes(I\otimes cA)`
        (cA\otimes I)\otimes cA`
        ((cA\otimes I)\otimes cA)\otimes cA;
        id_{cA}\otimes\lambda_{cA}^{-1}`
        \rho_{cA}^{-1}\otimes id_{cA}``
        \cL{A,I}\otimes id_{cA}]
      \qtriangle(1300,400)/->``->/<1300,400>[
        cA\otimes(I\otimes cA)`
        cA\otimes(cA\otimes(I\otimes cA))`
        cA\otimes(cA\otimes cA);
        id_{cA}\otimes\cR{A,I}``
        id_{cA}\otimes(id_{cA}\otimes\lambda_{cA})]
      \dtriangle(1300,0)/`<-`->/<1300,400>[
        cA\otimes(cA\otimes cA)`
        ((cA\otimes I)\otimes cA)\otimes cA`
        (cA\otimes cA)\otimes cA;
        `
        \alpha_{cA,cA,cA}`
        (\rho_{cA}\otimes id_{cA})\otimes id_{cA}]
    \efig
    \end{mathpar}


  \end{itemize}
\end{definition}



\begin{definition}
  \label{def:dist}
  Given two comonads $(c,\varepsilon^c,\delta^c)$ and
  $(w,\varepsilon^w,\delta^w)$ on a category $\cat{L}$, \textbf{the
  distributive law} of $c$ over $w$ is a natural transformation
  with components $dist_A:cwA\mto wcA$, subject to the following
  coherence diagrams:
  \begin{mathpar}
    \bfig
      \Vtriangle/<-`<-`->/<600,500>[
        wA`
        cwA`
        wcA;
        \varepsilon_{wA}^c`
        w\varepsilon_A^c`
        dist_A]
    \efig
    \and
    \bfig
      \Vtriangle/<-`<-`->/<600,500>[
        cA`
        cwA`
        wcA;
        c\varepsilon_A^w`
        \varepsilon_{cA}^w`
        dist_A]
    \efig
  \end{mathpar}
  \begin{mathpar}
    \bfig
      \Vtriangle/->`->`<-/<600,500>[
        cwcA`
        cwc^2A`
        c^2wcA;
        cw\delta_A^c`
        \delta_{wcA}^c`
        cdist_{cA}]
    \efig
    \and
    \bfig
      \Vtriangle/->`->`->/<600,500>[
        wcwA`
        wcw^2A`
        w^2cwA;
        wc\delta_A^w`
        \delta_{cwA}^w`
        wdist_{wA}]
    \efig
  \end{mathpar}
\end{definition}



\begin{lemma}
  \label{lem:compose-cw}
  Let $(c,\varepsilon^c,\delta^c)$ and $(w,\varepsilon^w,\delta^w)$ be
  two monoidal comonads on a Lambek category with weakening and contraction
  $(\cat{L},I,\otimes,w,\w{}^w,c,\cL{},\cR{})$. Then the
  composition of $c$ and $w$ using the distributive law
  $dist_A:cwA\mto wcA$ is a monoidal comonad $(cw,\varepsilon,\delta)$
  on $\cat{L}$.
\end{lemma}
\begin{proof}
  Suppose $(c,\varepsilon^c,\delta^c)$ and $(w,\varepsilon^w,\delta^w)$
  are monoidal comonads, and \\
  $(\cat{L},I,\otimes,w,\w{}^w,c,\cL{},\cR{})$ is a linear
  category with weakening and contraction. Since by definition
  $w,c :\cat{L} \mto \cat{L}$ are monoidal functors we know that their
  composition $wc : \cat{L} \mto \cat{L}$ is a monoidal functor:
  \begin{center}
  \begin{align*}
    \q{A,B} &: cwA\otimes cwB\mto cw(A\otimes B)   \\
    \q{A,B} &= c\q{A,B}^w\circ\q{wA,wB}^c        \\
    \q{I} &: I\mto cwI                             \\
    \q{I} &= c\q{I}^w\circ\q{I}^c
  \end{align*}
  \end{center}

  We must now define both $\varepsilon_A:cwA\mto A$ and
  $\delta_A:cwA\mto cwcwA$, and then show that they are monoidal
  natural transformations subject to the comonad laws. Since we are
  composing two comonads each of $\varepsilon$ and $\delta$ can be
  given two definitions, but they are equivalent:
  \begin{itemize}
    \item $\varepsilon_A:cwA\mto A$ is defined as in the diagram
      below, which commutes by the naturality of $\varepsilon^c$.
      \begin{mathpar}
      \bfig
      \square(1050,0)/->`->`->`->/<1050,600>[
      cwA`
      wA`
      cA`
      A;
      \varepsilon_{wA}^c`
      c\varepsilon_A^w`
      \varepsilon_A^w`
      \varepsilon_A^c]
      \efig
      \end{mathpar}

  \item $\delta_A:cwA\mto cwcwA$ is defined as in the diagram:
    \begin{mathpar}
    \bfig
      \square|almb|/->`->`->`->/<1050,600>[
      cwA`
      cw^2A`
      c^2wA`
      c^2w^2A;
      c\delta_A^w`
      \delta_{wA}^c`
      \delta_{w^2A}^c`
      c^2\delta_A^w]
    \square(1050,0)|amrb|/->``->`->/<1050,600>[
      cw^2A`
      c^2w^2A`
      c^2w^2A`
      cwcwA;
      \delta_{w^2A}^c``
      cdist_{wA}`
      cdist_{wA}]
    \efig
    \end{mathpar}
    The left part of the diagram commutes by the naturality
    of $\delta^c$ and the right part commutes trivially.
  \end{itemize}

  The remainder of the proof shows that the comonad laws hold.

  \begin{itemize}
    \item[] \textbf{Case 1:}
    \begin{mathpar}
    \bfig
      \square/->`->`->`->/<1050,600>[
        cwA`
        cwcwA`
        cwcwA`
        cwcwcwA;
        \delta_A`
        \delta_A`
        cw\delta_A`
        \delta_{cwA}]
    \efig
    \end{mathpar}

    The previous diagram commutes because the following one does.

    \begin{mathpar}
    \bfig
      \ptriangle/->`->`=/<700,400>[
        cwA`
        cwcwA`
        cwcwA;
        \delta_A`
        \delta_A`]
      \square(700,0)|amm|/->`->`->`/<900,400>[
        cwcwA`
        cwcw^2A`
        c^2wcwA`
        c^2wcw^2A;
        cwc\delta_A^w`
        \delta_{wcwA}^c`
        \delta_{wcw^2A}^c`]
      \ptriangle(1600,0)|amm|/->``<-/<1100,400>[
        cwcw^2A`
        cwc^2w^2A`
        c^2wcw^2A;
        cw\delta_{w^2A}^c`
        `
        cdist_{cw^2A}]
      \qtriangle(700,-600)|mmm|/->`->`->/<900,600>[
        c^2wcwA`
        c^2wcw^2A`
        c^2w^2cwA;
        c^2wc\delta_A^w`
        c^2\delta_{cwA}^w`
        c^2wdist_{wA}]
      \btriangle(0,-600)/->``->/<1600,600>[
        cwcwA`
        cw^2cwA`
        c^2w^2cwA;
        c\delta_{cwA}^w`
        `
        \delta_{w^2cwA}^c]
      \dtriangle(1600,-600)/`->`->/<1100,1000>[
        cwc^2w^2A`
        c^2w^2cwA`
        cwcwcwA;
        `
        cwcdist_{wA}`
        cdist_{wcwA}]
      % To show texts in each subdiagram:
      \ptriangle(200,-150)/``/<400,400>[(1)``;``]
      \ptriangle(1000,-200)/``/<400,400>[(2)``;``]
      \ptriangle(1300,-600)/``/<400,400>[(3)``;``]
      \ptriangle(500,-700)/``/<400,400>[(4)``;``]
      \ptriangle(1850,-150)/``/<400,400>[(5)``;``]
      \ptriangle(2100,-700)/``/<400,400>[(6)``;``]
    \efig
    \end{mathpar}

    (1) commutes by equality and we will not expand $\delta_A$ for
    simplicity. (2) and (4) commutes by the naturality of $\delta^c$. (3),
    (5) commutes by the conditions of $dist$. (6) commutes by the naturality of
    $dist$.

    \item[] \textbf{Case 2}:
      \begin{mathpar}
      \bfig
        \qtriangle/->`=`->/<600,600>[
          cwA`
          cwcwA`
          cwA;
          \delta_A``
          cw\varepsilon_A]
      \efig
      \end{mathpar}

      The triangle commutes because of the following diagram chasing.

      \begin{mathpar}
      \bfig
        \qtriangle|amm|/->`<-`=/<1200,600>[
          cwA`
          cw^2A`
          cw^2A;
          c\delta_A^w`
          c\varepsilon_{wA}^w`]
        \ptriangle(1200,0)|amm|/->``->/<600,600>[
          cw^2A`
          c^2w^2A`
          cw^2A;
          \delta_{w^2A}^c``
          c\varepsilon_{w^2A}^c]
        \btriangle(0,-1200)/=``<-/<1200,1800>[
          cwA`
          cwA`
          wcwA;
          ``\varepsilon_{cwA}^w]
        \btriangle(1200,-1200)|mmb|/`<-`<-/<600,1200>[
          cw^2A`
          wcwA`
          cwcwA;
          `
          cw\varepsilon_{wA}^c`
          \varepsilon_{wcwA}^c]
        \dtriangle(600,-600)|mmm|/`->`<-/<600,600>[
          cw^2A`
          wA`
          w^2A;
          `
          \varepsilon_{w^2A}^c`
          \varepsilon_{wA}^w]
        \morphism(0,600)|m|<600,-1200>[cwA`wA;\varepsilon_{wA}^c]
        \morphism(0,-1200)|m|<600,600>[cwA`wA;\varepsilon_{wA}^c]
        \morphism(1200,-1200)|m|<0,600>[wcwA`w^2A;w\varepsilon_{wA}^c]
        \morphism(1800,600)|r|<0,-1800>[c^2w^2A`cwcwA;cdist_{wA}]
        \ptriangle(800,300)/``/<100,100>[(1)``;``]
        \ptriangle(1350,300)/``/<100,100>[(2)``;``]
        \ptriangle(700,-300)/``/<100,100>[(3)``;``]
        \ptriangle(1600,-300)/``/<100,100>[(4)``;``]
        \ptriangle(300,-700)/``/<100,100>[(5)``;``]
        \ptriangle(700,-1000)/``/<100,100>[(6)``;``]
        \ptriangle(1450,-1000)/``/<100,100>[(7)``;``]
      \efig
      \end{mathpar}
      (1) commutes by the comonad law for $w$ with components $\delta_A^w$
      and $\varepsilon_{wA}^w$. (2) commutes by the comonad law for $c$ with
      components $\delta_{w^2A}^c$ and $\varepsilon_{w^2A}^c$. (3) and (7)
      commute by the naturality of $\varepsilon^c$. (4) commutes by the condition
      of $dist$. (5) commutes trivially. And (6) commutes by the naturality of
      $\varepsilon^w$.
      
    \item[] \textbf{Case 3}:
      \begin{mathpar}
      \bfig
        \btriangle/->`=`->/<600,600>[
          cwA`
          cwcwA`
          cwA;
          \delta_A``
          \varepsilon_{cwA}]
      \efig
      \end{mathpar}

    The previous triangle commutes because the following diagram chasing
    does.

    \begin{mathpar}
    \bfig
      \qtriangle|amm|/->`->`/<800,400>[
        cwA`
        cw^2A`
        c^2wA;
        c\delta_A^w`
        \delta_{wA}^c`]
      \morphism(0,400)|m|/<-/<800,-800>[cwA`c^2wA;c\varepsilon_{wA}^c]
      \ptriangle(800,0)|amm|/->``<-/<800,400>[
        cw^2A`
        c^2w^2A`
        c^2wA;
        \delta_{w^2A}^c``
        c^2\delta_A^w]
      \morphism(800,-400)|m|/<-/<800,800>[c^2wA`c^2w^2A;c^2w\varepsilon_A^w]
      \morphism(800,0)/=/<0,-400>[c^2wA`c^2wA;]
      \btriangle(0,-800)/=``<-/<800,1200>[
        cwA`
        cwA`
        cwcA;
        ``
        cw\varepsilon_A^c]
      \dtriangle(800,-800)/`->`<-/<800,1200>[
        c^2w^2A`
        cwcA`
        cwcwA;
        `
        cdist_{wA}`
        cwc\varepsilon_A^w]
      \morphism(800,-400)|m|/->/<0,-400>[c^2wA`cwcA;cdist_A]
      \ptriangle(800,100)/``/<100,100>[(1)``;``]
      \ptriangle(600,-100)/``/<100,100>[(2)``;``]
      \ptriangle(1000,-100)/``/<100,100>[(3)``;``]
      \ptriangle(400,-600)/``/<100,100>[(4)``;``]
      \ptriangle(1200,-600)/``/<100,100>[(5)``;``]
    \efig
    \end{mathpar}

    (1) commutes by the naturality of $\delta^c$. (2) is the comonad law
    for $c$ with components $\delta_{wA}^c$ and $\varepsilon_{wA}^c$. (3)
    is the comonad law for $w$ with components $\delta_A^w$ and
    $\varepsilon_A^w$. (4) commutes by the condition of $dist$. And (5)
    commute by the naturality of $dist$.

    \end{itemize}

  \end{proof}



\begin{lemma}
  \label{lem:composite-cw-2}
  Let $(c,\varepsilon^c,\delta^c)$ and $(w,\varepsilon^w,\delta^w)$ be
  two monoidal comonads on a Lambek category with weakening and
  contraction
  $(\cat{L},I,\otimes,w,\w{}^w,c,\cL{},\cR{})$, and
  $(cw,\varepsilon,\delta)$ be the monoidal comonad on $\cat{L}$ by
  composing $c$ and $w$ using the distributive law
  $dist_A:cwA\mto wcA$. The monoidal natural transformations
  $\w{}$ and $\c{}$ satisfy the following conditions:
  \begin{itemize}
    \item[1.] Each $(cwA,\w{A},\c{A})$ is a comonoid.
    \item[2.] $\w{A}$ and $\c{A}$ are coalgebra morphisms.
    \item[3.] Any coalgebra morphism $f:(cwA,\delta_A)\mto(cwB,\delta_B)$
      between free coalgebras preserves the comonoid structure given by
      $\w{}$ and $\c{}$.
  \end{itemize}
\end{lemma}

\begin{proof}
  We first define $\w{}$ and $\c{}$. Each of them can also be given two
  equivalent definitions:
  \begin{itemize}
    \item $\w{A}:cwA\mto I$ is defined as in the diagram below. The left
      triangle commutes by the definition of $dist$ and the right triangle
      commutes by the definition of $\w{}^w$.
      \begin{mathpar}
      \bfig
      \Atrianglepair/<-`->`->`->`->/<600,600>[
        wcA`
	cwA`
	wA`
	I;
        dist_A`
        w\varepsilon_A^c`
        \w{cA}^w`
        \varepsilon_{wA}^c`
        \w{A}^w]
      \efig
      \end{mathpar}

    \item $\c{A}:cwA\mto cwA\otimes cwA$ is defined as below. The left part
      of the diagram commutes by the definitions of
      $\cL{}$ and of $\cR{}$, and the right part commutes because
      $\cat{L}$ is monoidal.
      \begin{mathpar}
        \bfig
        \square/->`->``->/<1050,600>[
          cwA`
          cwA\otimes I`
          I\otimes cwA`
          cwA\otimes(I\otimes cwA);
          \rho_{cwA}^{-1}`
          \lambda_{cwA}^{-1}``
          \cR{wA,I}]
        \ptriangle(1050,0)/->``/<1050,600>[
          cwA\otimes I`
          (cwA\otimes I)\otimes cwA`
          cwA\otimes(I\otimes cwA);
          \cL{wA,I}``]
        \dtriangle(1050,0)|mrb|/->`->`->/<1050,600>[
          (cwA\otimes I)\otimes cwA`
          cwA\otimes(I\otimes cwA)`
          cwA\otimes cwA;
          \alpha_{cwA,I,cwA}`
          \rho_{cwA}\otimes id_{cwA}`
          id_{cwA}\otimes\lambda_{cwA}]
        \efig
      \end{mathpar}
  \end{itemize}

  Then we show each condition is satisfied.
  % Conditions for each cwA being a comonoid
  \begin{itemize}
    % Condition 1
    \item[1.] Each $(cwA,\w{A},\c{A})$ is a comonoid.
      \begin{itemize}
      \item[] \textbf{Case 1:}
        \begin{mathpar}
          \bfig
          \square/->`->``/<1050,600>[
            cwA`
            cwA\otimes cwA`
            cwA\otimes cwA`;
            \c{A}`
            \c{A}``]
          \square(1050,0)/->``<-`/<1150,600>[
            cwA\otimes cwA`
            cwA\otimes(cwA\otimes cwA)``
            (cwA\otimes cwA)\otimes cwA;
            id_{cwA}\otimes\c{A}``
            \alpha_{cwA,cwA,cwA}`]
            \morphism(0,0)|b|<2200,0>[
              cwA\otimes cwA`
              (cwA\otimes cwA)\otimes cwA;
              \c{A}\otimes id_{cwA}]
          \efig
        \end{mathpar}

        \newpage

%%% The proof below for Diagram~\ref{fig:commute-comonoid-1} uses beta
\iffalse
      Diagram~\ref{fig:commute-comonoid-1} commutes by the following
      diagram chasing. (1) and (3) commute because
      $(\cat{L},c,\cL{},\cR{})$ is a Lambek category with
      contranction. (2), (4), and (7) commute by the naturality of $\beta$.
      (5) and (6) commute by the coherence conditions of monoidal category.
      % The proof should not use beta, but I haven't figured out to do it
      % yet.

      \begin{mathpar}
%      \rotatebox{90}{$
      \bfig
        \qtriangle|amm|/->`->`/<1100,400>[
          cwA\otimes cwA`
          cwA\otimes (cwA\otimes I)`
          cwA\otimes (I\otimes cwA);
          id_{cwA}\otimes\rho_{cwA}^{-1}`
          id_{cwA}\otimes\lambda_{cwA}^{-1}`]
        \morphism(2700,0)|m|/<-/<1500,400>[
          cwA\otimes(cwA\otimes(I\otimes cwA))`
          cwA\otimes((cwA\otimes I)\otimes cwA);
          id_{cwA}\otimes\alpha_{cwA,I,cwA}]
        \morphism(1100,400)|a|<3100,0>[
          cwA\otimes (cwA\otimes I)`
          cwA\otimes((cwA\otimes I)\otimes cwA);
          id_{cwA}\otimes\cL{wA,I}]
        \morphism(1100,0)|m|<1600,0>[
          cwA\otimes (I\otimes cwA)`
          cwA\otimes(cwA\otimes(I\otimes cwA));
          id_{cwA}\otimes\cR{wA,I}]
        \morphism(0,400)|l|<0,-800>[
          cwA\otimes cwA`
          (cwA\otimes I)\otimes cwA;
          \rho_{cwA}^{-1}\otimes id_{cwA}]
        \square(1100,-600)|mmmm|/`<-`<-`->/<1600,600>[
          cwA\otimes (I\otimes cwA)`
          cwA\otimes(cwA\otimes (I\otimes cwA))`
          (I\otimes cwA)\otimes cwA`
          (cwA\otimes(I\otimes cwA))\otimes cwA;
          `
          \beta_{I\otimes cwA,cwA}`
          \beta_{cwA\otimes(I\otimes cwA),cwA}`
          \cR{wA,I}\otimes id_{cwA}]
        \square(0,-1400)|aamb|/`->`->`->/<2700,800>[
          (cwA\otimes I)\otimes cwA`
          (cwA\otimes(I\otimes cwA))\otimes cwA`
          ((cwA\otimes I)\otimes cwA)\otimes cwA`
          (cwA\otimes cwA)\otimes cwA;
          `
          \cL{wA,I}\otimes id_{cwA}`
          (id_{cwA}\otimes\lambda_{cwA})\otimes id_{cwA}`
          (\rho_{cwA,I}\otimes id_{cwA})\otimes id_{cwA}]
        \morphism(0,-1400)|m|<2700,800>[
          ((cwA\otimes I)\otimes cwA)\otimes cwA`
          (cwA\otimes(I\otimes cwA))\otimes cwA;
          \alpha_{cwA,I,cwA}\otimes id_{cwA}]
        \square(2700,-1400)/``->`->/<1500,1800>[
          `
          cwA\otimes((cwA\otimes I)\otimes cwA)`
          (cwA\otimes cwA)\otimes cwA`
          cwA\otimes(cwA\otimes cwA);
          ``
          id_{cwA}\otimes(\rho_{cwA}\otimes id_{cwA})`
          \alpha_{cwA,cwA,cwA}]
        \morphism(0,400)|m|<1100,-1000>[
          cwA\otimes cwA`
          (I\otimes cwA)\otimes cwA;
          \lambda_{cwA}^{-1}\otimes id_{cwA}]
        \morphism(2700,0)|m|<1500,-1400>[
          cwA\otimes(cwA\otimes(I\otimes cwA))`
          cwA\otimes(cwA\otimes cwA);
          id_{cwA}\otimes(id_{cwA}\otimes\lambda_{cwA})]
        \ptriangle(1800,100)/``/<100,100>[(1)``;``]
        \ptriangle(550,-50)/``/<100,100>[(2)``;``]
        \ptriangle(550,-800)/``/<100,100>[(3)``;``]
        \ptriangle(1800,-400)/``/<100,100>[(4)``;``]
        \ptriangle(3500,-400)/``/<100,100>[(5)``;``]
        \ptriangle(1800,-1300)/``/<100,100>[(6)``;``]
        \ptriangle(3300,-1200)/``/<100,100>[(7)``;``]
      \efig
%      $}
      \end{mathpar}
\fi

        The previous diagram commutes by the following diagram chasing.

        \begin{mathpar}
        \bfig
          \ptriangle/->`->`=/<1100,400>[
            cwA`
            cwA\otimes cwA`
            cwA\otimes cwA;
            \c{A}`
            \c{A}`]
          \qtriangle(1100,0)/->``->/<1700,400>[
            cwA\otimes cwA`
            cwA\otimes(cwA\otimes I)`
            cwA\otimes((cwA\otimes I)\otimes cwA);
            id_{cwA}\otimes\rho_{cwA}^{-1}``
            id_{cwA}\otimes\cL{wA,I}]
          \square(0,-400)|mlmm|/->`->`->`/<1100,400>[
            cwA\otimes cwA`
            cwA\otimes(I\otimes cwA)`
            (cwA\otimes I)\otimes cwA`
            cwA\otimes(cwA\otimes(I\otimes cwA));
            id_{cwA}\otimes\lambda_{cwA}^{-1}`
            \rho_{cwA}^{-1}\otimes id_{cwA}`
            id_{cwA}\otimes\cR{wA,I}`]
          \dtriangle(1100,-400)|mrm|/<-`->`->/<1700,400>[
            cwA\otimes((cwA\otimes I)\otimes cwA)`
            cwA\otimes(cwA\otimes(I\otimes cwA))`
            cwA\otimes(cwA\otimes cwA);
            id_{cwA}\otimes\alpha_{cwA,I,cwA}`
            id_{cwA}\otimes(\rho_{cwA}\otimes id_{cwA})`
            id_{cwA}\otimes(id_{cwA}\otimes\lambda_{cwA})]
          \square(0,-800)/`->`<-`->/<2800,400>[
            (cwA\otimes I)\otimes cwA`
            cwA\otimes(cwA\otimes cwA)`
            ((cwA\otimes I)\otimes cwA)\otimes cwA`
            (cwA\otimes cwA)\otimes cwA;
            `
            \cL{wA,I}\otimes id_{cwA}`
            \alpha_{cwA,cwA,cwA}`
            (\rho_{cwA}\otimes id_{cwA})\otimes id_{cwA}]
          \ptriangle(300,150)/``/<100,100>[(1)``;``]
          \ptriangle(1950,0)/``/<100,100>[(2)``;``]
          \ptriangle(2400,-350)/``/<100,100>[(3)``;``]
          \ptriangle(1400,-750)/``/<100,100>[(4)``;``]
        \efig
        \end{mathpar}

        (1) commutes trivially and we would not
        expand $\c{}$ for simplicity. (2) and (4) commute because
        $(\cat{L},c,\cL{},\cR{})$ is a Lambek category with contraction.
        (3) commutes because $\cat{L}$ is monoidal.

      \item[] \textbf{Case 2:}
        \todo{I think we may need some extra conditions to prove this, but
        don't know which to add.}
        \begin{mathpar}
        \bfig
        \Atrianglepair/->`->`->`<-`->/<1000,800>[
          cwA`
          I\otimes cwA`
          cwA\otimes cwA`
          cwA\otimes I;
          \lambda^{-1}`
          \c{A}`
          \rho^{-1}`
          \w{A}\otimes id_{cwA}`
          id_{cwA}\otimes\w{A}]
        \efig
        \end{mathpar}

      \end{itemize}
    
    % Condition 2
    \item $\w{}$ and $\c{}$ are coalgebra morphisms.
      \begin{itemize}
      \item[] \textbf{Case 1:}
        \begin{mathpar}
        \bfig
          \square/->`->`->`->/<1000,500>[
          cwA`
          I`
          cwcwA`
          cwI;
          \w{A}`
          \delta{A}`
          \q{I}`
          cw\w{A}]
        \efig
        \end{mathpar}

        The previous diagram commutes by the diagram below. (1) commutes by
        the naturality of $\delta^c$. (2) commutes by the condition of
        $dist_{wA}$. (3), (5) and (6) commute because $c$ is a monoidal
        comonad. (4) commutes because $(\cat{L},w,\w{}^w)$ is a Lambek
        category with weakening. (7) commutes because $c$ and $w$ are
        monoidal comonads.
        \begin{mathpar}
        \bfig
          \square/->`->``/<800,400>[
            cwA`
            cI`
            c^2wA`;
            c\w{A}^w`
            \delta_{wA}^c``]
          \morphism<0,-400>[c^2wA`c^2w^2A;c^2\delta_A^w]
          \morphism(0,400)|m|<800,-800>[cwA`cw^2A;c\delta_A^w]
          \square(0,-800)|almb|/<-`->`=`->/<800,400>[
            c^2w^2A`
            cw^2A`
            cwcwA`
            cw^2A;
            \delta_{w^2A}^c`
            cdist_{wA}``
            cw\varepsilon_{wA}^c]
          \morphism(0,-400)|m|<800,-400>[
            c^2w^2A`cw^2A;c\varepsilon_{w^A}^c]
          \Vtriangle(800,0)|amm|/->`<-`=/<400,400>[
            cI`
            I`
            I;
            \epsilon_I^c`
            \q{I}^c`]
          \Ctriangle(1200,-400)|arm|/`->`<-/<400,400>[
            I`I`cI;
            `
            \q{I}^c`
            \varepsilon_I^c]
          \morphism(1600,-400)|r|<0,-400>[cI`cwI;c\q{I}^w]
          \btriangle(800,-800)|amb|/`->`<-/<800,1200>[
            cI`
            cw^2A`
            cwI;
            `
            c\q{I}^w`
            cw\w{A}^w]
          \ptriangle(300,-250)/``/<100,100>[(1)``;``]
          \ptriangle(150,-750)/``/<100,100>[(2)``;``]
          \ptriangle(500,-600)/``/<100,100>[(3)``;``]
          \ptriangle(800,-200)/``/<100,100>[(4)``;``]
          \ptriangle(1200,100)/``/<100,100>[(5)``;``]
          \ptriangle(1450,-100)/``/<100,100>[(6)``;``]
          \ptriangle(1450,-500)/``/<100,100>[(7)``;``]
        \efig
        \end{mathpar}
      
      \item[] \textbf{Case 2:}
        \begin{mathpar}
        \bfig
          \square/->`->``/<1050,600>[
            cwA`
            cwA\otimes cwA`
            cwcwA`;
            \c{A}`
            \delta_A``]
          \square(1050,0)|ammb|/->``->`/<1050,600>[
            cwA\otimes cwA`
            cwcwA\otimes cwcwA``
            cw(cwA\otimes cwA);
            \delta_A\otimes\delta_A``
            \q{cwA,cwA}`]
            \morphism(0,0)|b|<2100,0>[cwcwA`cw(cwA\otimes cwA);cw\c{A}]
        \efig
        \end{mathpar}

        To prove the previous diagram commute, we first expand it, Then we
        divide it into five parts as shown belovee, and prove each part commutes.

        \begin{mathpar}
        \bfig
          \square|almm|/->`->`<-`/<600,400>[
            cwA`
            cwA\otimes I`
            cw^2A`
            w(cwA\otimes I);
            \rho_{cwA}^{-1}`
            c\delta_A^w`
            \varepsilon_{cwA\otimes I}^w`]
          \qtriangle(600,0)/->``->/<2000,400>[
            cwA\otimes I`
            (cwA\otimes I)\otimes cwA`
            cwA\otimes cwA;
            \cL{wA,I}``
            \rho_{cwA}\otimes id_{cwA}]
          \morphism<0,-400>[cw^2A`c^2w^2A;\delta_{w^2A}^c]
          \morphism(0,-400)<0,-400>[c^2w^2A`cwcwA;cdist_{wA}]
          \morphism(0,-800)<0,-400>[cwcwA`cw(cwA\otimes I);cw\rho_{cwA}]
          \btriangle(0,-1600)/->``->/<1300,400>[
            cw(cwA\otimes I)`
            cw((cwA\otimes I)\otimes cwA)`
            cw(cwA\otimes cwA);
            cw\cL{wA,I}``
            cw(\rho_{cwA}\otimes id_{cwA})]
          \morphism(0,-1200)|m|<600,1200>[
            cw(cwA\otimes I)`w(cwA\otimes I);
            \varepsilon_{w(cwA\otimes I)}^c]
          \square(1300,-1600)|mmmb|/->`<-``<-/<1300,1600>[
            w(cwA\otimes cwA)`
            cwA\otimes cwA`
            cw(cwA\otimes cwA)`
            c(wcwA\otimes wcwA);
            \varepsilon_{cwA\otimes cwA}^w`
            c\varepsilon_{cwA\otimes cwA}^w`
            `
            c\q{cwA\otimes cwA}^w]
          \Ctrianglepair(2600,-800)|mrmmr|/<-`->`=`<-`->/<900,400>[
            cwA\otimes cwA`
            cw^2A\otimes cw^2A`
            cw^2A\otimes cw^2A`
            c^2w^2A\otimes c^2w^2A;
            c\varepsilon_{wA}^c\otimes c\varepsilon_{wA}^c`
            c\delta_A^w\otimes c\delta_A^w``
            \varepsilon_{cw^2A}^c\otimes\varepsilon_{cw^2A}^c`
            \delta_{w^2A}^c\otimes\delta_{w^2A}^c]
          \morphism(2600,-800)|m|<0,-400>[
            c^2w^2A\otimes c^2w^2A`
            cwcwA\otimes cwcwA;
            cdist_{wA}\otimes cdist_{wA}]
          \morphism(2600,-1200)|m|<0,-400>[
            cwcwA\otimes cwcwA`
            c(wcwA\otimes wcwA);
            \q{wcwA\otimes wcwA}^c]
          \ptriangle(2400,-350)/``/<100,100>[(a)``;``]
          \ptriangle(2400,-650)/``/<100,100>[(b)``;``]
          \ptriangle(300,100)/``/<100,100>[(c)``;``]
          \ptriangle(650,-1000)/``/<100,100>[(d)``;``]
          \ptriangle(1800,-1100)/``/<100,100>[(e)``;``]
        \efig
        \end{mathpar}

        Part (a) and (b) are comonad laws.
        
        Part (c) commutes by the following diagram chase. (1) is equality.
        (2) is the comonad law for $w$. (3) is the comonad law for $c$.
        (4) commutes by the naturality of $\varepsilon^c$. (5) is one of
        the conditions for $dist_{wA}$. (6) commutes by the naturality of
        $\varepsilon^w$. And (7) commutes by the naturality of
        $\varepsilon^c$.
        \begin{mathpar}
        \bfig
          \btriangle|lmm|/->`->`=/<600,600>[
            cwA`
            cw^2A`
            cw^2A;
            c\delta_A^w`
            c\delta_A^w`]
          \morphism(0,600)|m|/=/<1200,-600>[cwA`cwA;]
          \ptriangle(0,-600)|mlm|/`->`<-/<600,600>[
            cw^2A`
            cw^2A`
            c^2w^2A;
            `
            \delta_{w^2A}^c`
            \varepsilon_{cw^2A}^c]
          \ptriangle(600,-600)|mmm|/->`->`<-/<600,600>[
            cw^2A`
            cwA`
            wcwA;
            c\varepsilon_{wA}^w`
            dist_{wA}`
            \varepsilon_{cwA}^w]
          \ptriangle(0,-1000)|mlm|/`->`<-/<600,400>[
            c^2w^2A`
            wcwA`
            cwcwA;
            `
            cdist_{wA}`
            \varepsilon_{wcwA}^c]
          \square(0,-600)/->``<-`/<1800,1200>[
            cwA`
            cwA\otimes I``
            w(cwA\otimes I);
            \rho_{cwA}^{-1}``
            \varepsilon_{cwA\otimes I}^w`]
          \square(600,-1000)|mmrm|/->``<-`/<1200,400>[
            wcwA`
            w(cwA\otimes I)``
            cw(cwA\otimes I);
            w\rho_{cwA}^{-1}``
            \varepsilon_{w(cwA\otimes I)}^c`]
          \morphism(0,-1000)|b|<1800,0>[
            cwcwA`
            cw(cwA\otimes I);
            cw\rho_{cwA}^{-1}]
          \ptriangle(200,100)/``/<100,100>[(1)``;``]
          \ptriangle(650,50)/``/<100,100>[(2)``;``]
          \ptriangle(200,-300)/``/<100,100>[(3)``;``]
          \ptriangle(350,-650)/``/<100,100>[(4)``;``]
          \ptriangle(800,-300)/``/<100,100>[(5)``;``]
          \ptriangle(1500,-100)/``/<100,100>[(6)``;``]
          \ptriangle(1100,-900)/``/<100,100>[(7)``;``]
        \efig
        \end{mathpar}

        Part (d) commutes by the following diagram chase. The upper two
        squares both commute by the naturality of $\varepsilon^w$, and the
        lower two squares commute by the naturality of $\varepsilon^c$.
        \begin{mathpar}
        \bfig
          \square|almm|/->`<-`<-`->/<1200,400>[
            cwA\otimes I`
            (cwA\otimes I)\otimes cwA`
            w(cwA\otimes I)`
            w((cwA\otimes I)\otimes cwA);
            \cL{wA,I}`
            \varepsilon_{cwA\otimes I}^w`
            \varepsilon_{(cwA\otimes I)\otimes cwA}^w`
            w\cL{wA,I}]
          \square(0,-400)|mlmb|/`<-`<-`->/<1200,400>[
            w(cwA\otimes I)`
            w((cwA\otimes I)\otimes cwA)`
            cw(cwA\otimes I)`
            cw((cwA\otimes I)\otimes cwA);
            `
            \varepsilon_{w(cwA\otimes I)}^c`
            \varepsilon_{w((cwA\otimes I)\otimes A)}^c`
            cw\cL{wA,I}]
          \square(1200,0)|ammm|/->``<-`->/<1350,400>[
            (cwA\otimes I)\otimes cwA`
            cwA\otimes cwA`
            w((cwA\otimes I)\otimes cwA)`
            w(cwA\otimes cwA);
            \rho_{cwA}\otimes id_{cwA}``
            \varepsilon_{cwA\otimes cwA}^w`
            w(\rho_{cwA}\otimes id_{cwA})]
          \square(1200,-400)|mmrb|/``<-`->/<1350,400>[
            w((cwA\otimes I)\otimes cwA)`
            w(cwA\otimes cwA)`
            cw((cwA\otimes I)\otimes cwA)`
            cw(cwA\otimes cwA);
            ``
            \varepsilon_{w(cwA\otimes cwA)}^c`
            cw(\rho_{cwA}\otimes id_{cwA})]
        \efig
        \end{mathpar}

        Part (e) commutes by the following diagram. (1) commutes by the
        condition of $dist_{wA}$. (2) and (4) commute by the naturality of
        $\varepsilon^c$. (3) and (5) commute because $w$ and $c$ are
        monoidal comonads.
        \begin{mathpar}
        \bfig
          \qtriangle|amm|/<-`<-`->/<1200,400>[
            cwA\otimes cwA`
            cw^2A\otimes cw^2A`
            wcwA\otimes wcwA;
            c\varepsilon_{wA}^w\otimes c\varepsilon_{wA}^w`
            \varepsilon_{cwA}^w\otimes\varepsilon_{cwA}^w`
            dist_{wA}\otimes dist_{wA}]
          \square(1200,0)|amrm|/<-``->`<-/<1200,400>[
            cw^2A\otimes cw^2A`
            c^2w^2A\otimes c^2w^2A`
            wcwA\otimes wcwA`
            cwcwA\otimes cwcwA;
            \varepsilon_{cw^2A}^c\otimes\varepsilon_{cw^2A}^c``
            cdist_{wA}\otimes cdist_{wA}`
            \varepsilon_{wcwA}^c\otimes\varepsilon_{wcwA}^c]
          \morphism(0,-400)|l|<0,800>[
            w(cwA\otimes cwA)`
            cwA\otimes cwA;
            \varepsilon_{cwA\otimes cwA}^w]
          \Atriangle(0,-400)|mmm|/->`<-`/<1200,400>[
            wcwA\otimes wcwA`
            w(cwA\otimes cwA)`
            c(wcwA\otimes wcwA);
            \q{cwA,cwA}^w`
            \varepsilon_{wcwA\otimes wcwA}^c`]
          \dtriangle(1200,-400)/`->`<-/<1200,400>[
            cwcwA\otimes cwcwA`
            cw(cwA\otimes cwA)`
            c(wcwA\otimes wcwA);
            `
            \q{wcwA\otimes wcwA}^c`
            c\q{cwA\otimes cwA}]
          \morphism(0,-400)|b|/<-/<1200,0>[
            w(cwA\otimes cwA)`
            cw(cwA\otimes cwA);
            \varepsilon_{w(cwA\otimes cwA)}^c]
          \ptriangle(900,150)/``/<100,100>[(1)``;``]
          \ptriangle(1800,100)/``/<100,100>[(2)``;``]
          \ptriangle(500,-100)/``/<100,100>[(3)``;``]
          \ptriangle(1200,-300)/``/<100,100>[(4)``;``]
          \ptriangle(2150,-250)/``/<100,100>[(5)``;``]
        \efig
        \end{mathpar}
      \end{itemize}
    
    % Condition 3
    \item Any coalgebra morphism $f:(cwA,\delta_A)\mto (cwB,\delta_B)$
      between free coalgebras preserve the comonoid structure given
      by $\w{}$ and $\c{}$.

      \begin{itemize}
      \item[] \textbf{Case 1:}
        \todo{Could not figure out how to prove this. I ended using the
        diagram itself in the proof.}
        \begin{mathpar}
        \bfig
          \Vtriangle/->`->`->/<600,500>[
            cwA`
            cwB`
            I;
            f`
            \w{A}`
            \w{B}]
        \efig
        \end{mathpar}

      \item[] \textbf{Case 2:}
        \begin{mathpar}
        \bfig
          \square/->`->`->`->/<1000,500>[
          cwA`
          cwA\otimes cwA`
          cwB`
          cwB\otimes cwB;
          \c{A}`
          f`
          f\otimes f`
          \c{B}]
        \efig
        \end{mathpar}

        The square commutes by the diagram chasing below, which commutes by
        the naturality of $\rho$ and $\cL{}$.

        \begin{mathpar}
        \bfig
          \square|almb|/->`->`->`->/<600,500>[
            cwA`
            cwA\otimes I`
            cwB`
            cwB\otimes I;
            \rho_{cwA}^{-1}`
            cwf`
            cwf\otimes id_I`
            \rho_{cwB}^{-1}]
          \square(600,0)|ammb|/->``->`->/<1000,500>[
            cwA\otimes I`
            (cwA\otimes I)\otimes cwA`
            cwB\otimes I`
            (cwB\otimes I)\otimes cwB;
            \cL{wA,I}``
            (cwf\otimes id_I)\otimes cwf`
            \cL{wB,I}]
          \square(1600,0)|amrb|/->``->`->/<1000,500>[
            (cwA\otimes I)\otimes cwA`
            cwA\otimes cwA`
            (cwB\otimes I)\otimes cwB`
            cwB\otimes cwB;
            \rho_{cwA}\otimes id_{cwA}``
            cwf\otimes cwf`
            \rho_{cwB}\otimes id_{cwB}]
        \efig
        \end{mathpar}
      \end{itemize}
  \end{itemize}
\end{proof}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Related Work}
\label{sec:related_work}
TODO
% section related_work (end)


\section{Conclusion}
\label{sec:conclusion}
TODO
% section conclusion (end)

\bibliographystyle{plainurl} \bibliography{ref}

\appendix
\input{appendix}
\end{document}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 

